Three-dimensional multispecies nonlinear tumor growth–I. Model and numerical method This is the first paper in a two-part series in which we develop, analyze and simulate a diffuse interface continuum model of multispecies tumor growth and tumor-induced angiogenesis in two and three dimensions. Three dimensional simulations of nonlinear tumor growth and neovascularization using this diffuse interface model were recently presented in Frieboes et al. (2007) , but that paper did not describe the details of the model or the numerical algorithm. This is done here. In this diffuse interface approach, sharp interfaces are replaced by narrow transition layers that arise due to differential adhesive forces among the cell-species. Accordingly, a continuum model of adhesion is introduced. The model is thermodynamically consistent, is related to recently developed mixture models, and thus is capable of providing a detailed description of tumor progression. The model is well-posed and consists of fourth-order nonlinear advection-reaction-diffusion equations (of Cahn-Hilliard-type) for the cell-species coupled with reaction-diffusion equations for the substrate components. We demonstrate analytically and numerically that when the diffuse interface thickness tends to zero, the system reduces to a classical sharp interface model. Using a new fully adaptive, nonlinear multigrid/finite difference method the system is simulated efficiently. In this first paper, we present simulations of unstable avascular tumor growth in two and three dimensions and demonstrate that our techniques now make large-scale three dimensional simulations of tumors with complex morphologies computationally feasible. In Part II of this study, we will investigate multispecies tumor invasion, tumor-induced angiogenesis and focus on the morphological instabilities that may underlie invasive phenotypes.  1 Introduction The morphological evolution of a growing solid tumor is the result of many factors, including cell-cell and cell-matrix adhesion, mechanical stress, cell motility, and the degree of heterogeneity of cell proliferation just to name a few ( Alberts et al., 2002 ). According to recent experimental and theoretical work ( Cristini et al., 2005 ; Anderson et al., 2006 ; Macklin and Lowengrub, 2006 ; Frieboes et al., 2007 ; Gatenby et al., 2007 ), understanding the morphological stability of a cancerous tumor may be important for controlling its spread to surrounding tissue. In addition, the spatial and temporal distribution of oxygen and vital nutrients, the genetic predisposition to apoptosis, necrosis and cell-to-cell survival signaling, and the cell population genetic diversity all have an important effect. For instance, if cell-cell adhesion is uniformly high, it is expected that the resulting morphology would be compact. It is well known that a compact solid tumor will grow to a diffusion-limited size, after which it will have to co-opt existing vasculature, or acquire a new one through angiogenesis in order to grow further. On the other hand, morphological instability driven by substrate gradients, inhomogeneous cell-proliferation and necrosis, allows the tumor to overcome diffusional limitations on growth by increasing the surface area of the tumor/host interface thereby allowing interior tumor cells greater access to vital nutrients and growth factors. This is the first paper in a two-part series in which we develop, analyze and simulate a diffuse interface continuum model of multispecies tumor growth and tumor-induced angiogenesis in two and three dimensions. Three dimensional simulations of nonlinear tumor growth and neovascularization using this diffuse interface model were presented in ( Frieboes et al., 2007 ) but that paper did not describe the details of the model or the numerical algorithm. This is done here. In this diffuse approach, sharp interfaces are replaced by narrow transition layers that arise due to differential adhesive forces among the cell-species. Accordingly, a continuum model of adhesion is introduced. This model is capable of describing the dependence of cell-cell and cell-matrix adhesion on cell phenotype and genotype (e.g. expression of e-cadherins and integrins) as well as on the local microenvironmental conditions such as oxygen levels. The model is thermodynamically consistent and is capable of providing a detailed description of tumor progression. The model is well-posed and consists of fourth-order nonlinear advection-reaction-diffusion equations of Cahn-Hilliard-type ( Cahn and Hilliard, 1958 ) for the cell-species volume fractions coupled with reaction-diffusion equations for the substrate components. This approach eliminates the need to enforce complicated boundary conditions across the tumor/host (and other species/species interfaces) that would have to be satisfied if the interfaces were assumed sharp. The diffuse interface methodology also has the advantage that there is no need to explicitly track the interface as is required in the sharp interface framework. The diffuse interface model is related to recently developed multicomponent mixture models, e.g. , ( Ambrosi and Preziosi, 2002 ; Breward et al., 2002 , 2003 ; Byrne et al., 2003 ; Byrne and King, 2003 ; Byrne and Preziosi, 2003 ; Franks et al., 2003a , b ; Franks and King, 2003 ; Araujo and McElwain, 2005a ; Chaplain et al., 2006 ), that were introduced to study the dynamics of multispecies tumor growth. In this approach, mass, momentum and energy balances are introduced for each species and as such provide the potential for significantly greater modeling detail than in single phase tumor models like those considered earlier by Greenspan (1976) ; Byrne and Chaplain (1995 , 1996a) ; Chaplain (1996) ; Friedman and Reitich (1999) ; Breward et al. (2002 , 2003) ; Byrne and King (2003) ; Cristini et al. (2003) ; Zheng et al. (2005) ; Hogea et al. (2006) ; Macklin and Lowengrub (2006) to list a few. Please find more complete references in the excellent recent reviews of tumor growth modeling by Araujo and McElwain (2004) ; Hatzikirou et al. (2005) ; Quaranta et al. (2005) ; Byrne et al. (2006) ; Graziano and Preziosi (2007) ; Roose et al. (2007) . Describing the dynamics of multiple cell species is crucial since the tumor micro-environment ( e.g. , hypoxia) and impaired cell genetic mechanisms can create multiple cell genotypes (and phenotypes) and select for cells that survive under abnormal conditions ( Graeber et al., 1996 ). Also, the micro-environment of invasive tumors may be characterized by non-sharp boundaries between tumor and host tissues, and between multiple species within the tumor ( Liotta and Kohn, 2001 ; Lamszus et al., 2003 ; Kunkel et al., 2001 ). The study of how an invading tumor tissue affects the host at the cellular scale, for example, would be challenging with a sharp interface, single-phase based model. There are a variety of numerical methods now available for performing simulations of nonlinear solid tumor growth. These include cellular automaton and agent based models ( e.g. , see the works of Alarcon et al. (2003) ; Jiang et al. (2005) ; Anderson (2005) ; Abbott et al. (2006) ; Anderson et al. (2006) ; Lee and Rieger (2006) ; Bauer et al. (2007) ; Gerlee and Anderson (2007b , a) ; Bartha and Rieger (2007) ), single-phase continuum tumor growth models ( e.g. , see the works of Cristini et al. (2003) ; Zheng et al. (2005) ; Sinek et al. (2004) ; Hogea et al. (2006) ; Macklin and Lowengrub (2006 , 2007) ; Macklin et al. (2007) ; Li et al. (2007) ) and continuum multiphase mixture models ( e.g. , see the work of Preziosi and Tosin (2007) and the mixture model references listed above). For a more complete set of references, please see the review papers listed previously. While discrete models may translate biological processes into model rules more easily than continuum approaches, discrete models can be difficult to study analytically and the associated computational cost rapidly increases with the number of cells modeled which makes it difficult to simulate millimeter or greater sized tumors. In larger-scale systems (millimeter to centimeter scale), continuum methods provide a good modeling alternative and mixture models provide the capability of simulating in detail the interactions among multiple cell species. Hybrid continuum-discrete models ( e.g. , ( Kim et al., 2007 )) are very promising and have the potential to combine the best features of both approaches although more work is necessary to make these models competitive with the continuum approach at large scales. Until recently ( Frieboes et al., 2007 ; Cristini et al., 2008 ; Preziosi and Tosin, 2007 ), numerical simulations of mixture models have been limited to either one-dimensional or symmetric tumor configurations. This is due in part to the complicated nature of the governing partial differential equations. In addition, some of the mixture models that account for adhesive forces do so through unregularized backwards diffusion, which may in general lead to ill-posedness. This can be dealt with easily in one dimension but is problematic in higher dimensions where spurious instabilities can be more easily triggered by spatial discretization. In this paper, we develop a general approach based on energy variation to derive the diffuse interface equations. The system energy accounts for all the processes to be modeled. Here, we focus on adhesion which we introduce through an interaction energy that leads to well-posed fourth-order equations. We note that a related nonlocal continuum model of adhesion was recently developed by Armstrong et al. (2006) . The diffuse interface model accounts for hydrostatic pressure and the cell-velocity is found through a generalized Darcy’s law. The modeling framework is sufficiently general to account for elastic, poroelastic and viscoelastic effects ( Jones et al., 2000 ; Ambrosi and Mollica, 2002 ; Lubarda and Hoger, 2002 ; Araujo and McElwain, 2004 ; Ben-Amar and Gorielly, 2005 ; Fung, 1990 ; Humphrey, 2003 ; Roose et al., 2003 ; McArthur and Please, 2004 ) by incorporating the relevant energies in the system energy and performing an energy variation guided by the mixture formulation developed by Araujo and McElwain (2005a , b) . These more complicated effects will be considered in the future. Because the diffuse interface model involves high-order equations and the solutions are characterized by having narrow transition layers, it is challenging to develop accurate and efficient numerical methods. For example, explicit methods would result in severe time step restrictions while the presence of transition layers requires the resolution of multiple spatial scales. To solve the diffuse interface system numerically, we develop a new and very efficient, fully adaptive, nonlinear multigrid/finite difference method. The algorithm is fully implicit in time and the nonlinear equations at the implicit time step are solved using a nonlinear multigrid finite difference method with nearly optimal complexity. Typically, the computational cost of the algorithm is proportional to the total number of mesh points. To efficiently resolve the multiple spatial scales, an adaptive block-structured Cartesian mesh is used. Locally refined block-structured Cartesian meshes strike a balance between grid structure and efficiency and are very natural to use together with multilevel, multigrid methods. Here, we follow the methodology we recently developed in Wise et al. (2007) . In this first paper, we present simulations of unstable avascular tumor growth in two and three dimensions and demonstrate that our techniques now make large-scale three dimensional simulations of tumors with complex morphologies computationally feasible. We focus on tumors consisting of viable and necrotic cells and we make several simplifying assumptions regarding the interaction of the cell and host species. In Part II of this study, we will investigate multispecies tumor invasion and tumor-induced angiogenesis. We will examine the effect of variable cell-cell adhesion due to changes in cell phenotype and microenvironmental conditions (e.g. oxygen levels). We will focus on the morphological instabilities that may underlie invasive phenotypes. The paper is organized as follows. In Sec. 2, a general, multi-species, diffuse interface model is presented. In Sec. 3 we specialize our model to the case of two tumor cell species, nondimensionalize the model, and show it to be convergent to a classical sharp interface model of tumor growth using an asymptotic analysis. In Sec. 4, the numerical method is briefly described and in Sec. 5 the numerical results are presented. In Sec. 6 the paper is summarized and future work is described. In Appendix A , the detailed constitutive relations for the cell-velocity and adhesion fluxes are derived via energy variation. In Appendix B , we provide a brief sketch of the matched asymptotic expansions that demonstrate the convergence of the new diffuse-interface model to a classical sharp-interface model.  2 A general diffuse-interface tumor model 2.1 Mass conservation laws We begin by formulating a general multi-species tumor model that accounts for mechanical interactions among the different species. Here, we focus on cell-cell adhesion. Later, in Sec. 3 we consider a specific case involving viable and necrotic tumor cells and host cells. In part II of this work, we will consider multiple viable tumor cell species. The primary dependent variables in the ( N + 1)-species model are the volume fractions of the water, tumor and host cell species, ?0, …, ? N , the densities of the components ?0, …, ? N , the extra-cellular fluid pressure q , the cell-to-cell (solid) pressure p , and the component velocities u 0, …, u N . We assume that there are no voids ( i.e. , the mixture is saturated) and thus ? i = 0 N ? i = 1 . Further, we assume that the densities are constant, i.e. , independent of temperature, pressure, etc. Without loss of generality, we may identify i = 0 as the water component. The volume fractions of the components are assumed to be continuous in a domain ?, which contains both the tumor and host domains. The volume fractions obey the mass conservation (advection-reaction-diffusion) equations (1) ? i ( ? ? i ? t + ? · ( u i ? i ) ) = ? ? · J i + S i , where J i are fluxes that account for the mechanical interactions among the cell species. The source terms S i account for inter-component mass exchange as well as gains due to proliferation of cells and loss due to cell-death. The density of the mixture is defined as ? = ? i = 0 N ? i ? i . The mass averaged velocity of the mixture is then defined as u = 1 / ? ? i = 0 N ? i ? i u i . Summing Eq. (1) we find that mass of the mixture is conserved only if 3 (2) ? i = 0 N J i = ? i = 0 N S i = 0 . We therefore pose these conditions as consistency constraints for the fluxes and sources We next motivate the constitutive choices for the fluxes J i . The sources S i will be chosen to reflect the appropriate biophysical processes and will be discussed in detail in Sec. 3. 2.2 Adhesion energy To motivate the constitutive laws for the fluxes J i and the velocities u i , we introduce an energy of each component E i that includes all the effects to be considered. In this work, we focus on adhesion. Elastic and viscoelastic effects will be considered in the future. To describe the energy associated with the interactions among the different components, we follow an approach from continuum thermodynamics ( e.g. , see Rowlinson and Widom (1982) ; Landau (1984) ) and introduce the Helmholtz free energy of component interactions (e.g. adhesion) via: (3) E i = U mix , i ? ? s mix , i , where U mix, i is the energy that results from adhesive forces between component i and the other components, s mix, i is the entropy of mixing and ? is the temperature which is assumed to be constant. (The analysis may also be extended to the non-isothermal case.) Introducing the interaction potential U ij between species i and j , we may write (4) U mix , i = 1 2 ? j ? i ? ? U ij ( x ? x ? ) ? i ( x ) ? j ( x ? )    d x d x ? . The entropy of mixing may be written as (5) s mix , i = R ? ? i  log  ( 1 / ? i )    d x , where R is the “gas” constant ( Rowlinson and Widom, 1982 ). To fix ideas, consider a two-component system with volume fractions ?0 and ?1 and assume that U 01 = U 10 for simplicity. Then, the total free energy of adhesion E = E 0 + E 1 is given by (6) E = ? ? U 01 ( x ? x ? ) ? 0 ( x ) ? 1 ( x ? )    d x d x ? + R ? ? ( ? 0  log  ? 0 + ? 1  log  ? 1 )    d x . Let us next suppose that the potential U 01 is localized, i.e. , U 01( x ) = ?? d U (| x |/?), where ? is a small (unit-less) parameter and d is the spatial dimension. We may perform an expansion in ? to get (7) E = ? ( R ? ( ? 0  log  ? 0 + ? 1  log  ? 1 ) + U 0 ? 0 ? 1 ? ? 2 U 2 2 ? ? 0 · ? ? 1 )    d x + O ( ? 4 ) , where U 0 = ? U (| x |) d x and U 2 = ? U (| x |)| x |2 d x are the mean and second moment of the potential, respectively. Rescaling the energy ? = E/R ? and using that ?0 = 1 ? ?1, we get (8) ? = ? ( ( ? 1  log  ? 1 + ( 1 ? ? 1 )  log ( 1 ? ? 1 ) ) + ? 0 ? 1 ( 1 ? ? 1 ) + ?? 2 2 | ? ? 1 | 2 )    d x + O ( ?? 4 ) , where ? 0 = U 0/ R ? and ??2 = ?2 U 2/ R ?. Note that the non-gradient (local) interaction term in the integrand of Eq. (8) takes the form f (?1) = f c (?1) ? ? 0 f e (?1), where f c = ?1 log ?1 + (1 ? ?1) log(1 ? ?1) and f e = ?1(?1 ? 1) are convex functions. The first term, f c , represents the repulsive energy among like components, while the second term, ? ? 0 f e , represents the adhesion energy among like components. Performing a similar expansion for the general multispecies energy in Eq. (3) and dropping the O (??4) terms, we obtain the following weakly nonlocal model of the Helmholtz free energy of the i th component: (9) E i = ? ( F i ( ? 0 , … ? N ) + ? j = 0 N ?? ij 2 2 | ? ? j | 2 )    d x , where the first term models the bulk energy of the components due to local interactions while the second (gradient energy) term models longer range interactions among the components. Here ?? ij are positive constants, such that ?? ij 2 has units of energy per unit length. 2.3 Constitutive laws for the fluxes and velocities Next, thermodynamic constitutive laws for J i and u i are posed in order to be consistent with the decrease of the total free energy E = ? i = 0 N E i . For constant temperature systems, as considered here, this is equivalent to entropy increase ( Rowlinson and Widom, 1982 ). We make the following zeroth-order simplifying approximations: (i) the densities of the components ? i = ? are matched; and (ii) that the water volume fraction is constant in time and space, i.e. , ?0 = ??W constant. Accordingly, the volume fraction of the solid components ? i = 1 N ? i = ?? S is also constant with ??S = 1 ? ??W. We further assume that there is no adhesive (mechanical) flux of water, i.e. , J 0 = 0. Correspondingly, the sum of the solid fraction fluxes ? i = 1 N J i = 0 . This is consistent with the no-void assumption mentioned earlier. Together, these assumptions allow only limited coupling between the solid and water phases. In particular, the water will primarily move freely through the system such that Eq. (1) is satisfied for the water component. More extensive coupling of between the water transport and the solid phases is considered in the single-tumor-species, multiphase models of Breward et al. (2002 , 2003) , Byrne and King (2003) , and Byrne and Preziosi (2003) . Each of the assumptions we made above may be relaxed (see App. A for a more general derivation) and we will consider more extensive coupling between the solid and liquid components in a future work, building on the more general framework in App. A . As derived in App. A , thermodynamically consistent fluxes may be taken to be the generalized Fick’s law: (10) J i = ? M? i ? ( ? E ? ? i ? ? E ? ? N ) ,     1 ? i < N ? 1 , and J N = ? ? i = 1 N ? 1 J i , where M? i > 0 is a mobility, ? E ? ? i are variational derivatives of the total energy E and are given by (11) ? E ? ? i = ? j = 0 N ( ? F j ? ? i ? ? · ( ?? ji 2 ? ? i ) ) ,     1 ? i < N . The velocities of the components may be also determined in a thermodynamically and mechanically consistent way. This can be done either by posing momentum equations for each component together with momentum exchange terms which are determined in a thermodynamically consistent way from the energy variation or by posing a generalized Darcy-type constitutive law for the velocity directly from the energy variation. The former approach is more general although the two approaches are consistent for specific modeling choices of the component stress tensors ( e.g. , see Ambrosi and Preziosi (2002) ; Byrne and Preziosi (2003) ; Chaplain et al. (2006) ). In a forthcoming work Cristini et al. (2008) , we will consider the more general momentum exchange approach. Here, we follow the latter, direct approach which is similar in spirit to the model proposed in ( Ambrosi and Preziosi, 2002 ). This approach also treats the tumors as viscous, inertialess fluids. As above, we present only the results here. The details may be found in App. A . The resulting generalized Darcy laws for the velocities of the components are given by (12) u 0 = ? k? 0 ? ( ? E ? ? 0 + q ) , (13) u j = ? k? ( ? p ? ? i = 1 N ? E ? ? i ? ? i ) ? k? j ? ( ? E ? ? j ? 1 ?? S ? i = 1 N ? i ? E ? ? i + p ?? S ) , j ? 1 , where q is the water pressure, p is the solid pressure, and k? 0, k? , k? j are positive definite motility matrices. The constitutive laws (10) , (12) , and (13) guarantee that in the absence of mass sources, the adhesion energy is non-increasing in time as the fields evolve. Note that with these choices of flux and velocity, the tumor growth equations (1) are fourth-order, nonlinear advection-reaction-diffusion equations of Cahn-Hilliard type ( Cahn and Hilliard, 1958 ).  2.1 Mass conservation laws We begin by formulating a general multi-species tumor model that accounts for mechanical interactions among the different species. Here, we focus on cell-cell adhesion. Later, in Sec. 3 we consider a specific case involving viable and necrotic tumor cells and host cells. In part II of this work, we will consider multiple viable tumor cell species. The primary dependent variables in the ( N + 1)-species model are the volume fractions of the water, tumor and host cell species, ?0, …, ? N , the densities of the components ?0, …, ? N , the extra-cellular fluid pressure q , the cell-to-cell (solid) pressure p , and the component velocities u 0, …, u N . We assume that there are no voids ( i.e. , the mixture is saturated) and thus ? i = 0 N ? i = 1 . Further, we assume that the densities are constant, i.e. , independent of temperature, pressure, etc. Without loss of generality, we may identify i = 0 as the water component. The volume fractions of the components are assumed to be continuous in a domain ?, which contains both the tumor and host domains. The volume fractions obey the mass conservation (advection-reaction-diffusion) equations (1) ? i ( ? ? i ? t + ? · ( u i ? i ) ) = ? ? · J i + S i , where J i are fluxes that account for the mechanical interactions among the cell species. The source terms S i account for inter-component mass exchange as well as gains due to proliferation of cells and loss due to cell-death. The density of the mixture is defined as ? = ? i = 0 N ? i ? i . The mass averaged velocity of the mixture is then defined as u = 1 / ? ? i = 0 N ? i ? i u i . Summing Eq. (1) we find that mass of the mixture is conserved only if 3 (2) ? i = 0 N J i = ? i = 0 N S i = 0 . We therefore pose these conditions as consistency constraints for the fluxes and sources We next motivate the constitutive choices for the fluxes J i . The sources S i will be chosen to reflect the appropriate biophysical processes and will be discussed in detail in Sec. 3.  2.2 Adhesion energy To motivate the constitutive laws for the fluxes J i and the velocities u i , we introduce an energy of each component E i that includes all the effects to be considered. In this work, we focus on adhesion. Elastic and viscoelastic effects will be considered in the future. To describe the energy associated with the interactions among the different components, we follow an approach from continuum thermodynamics ( e.g. , see Rowlinson and Widom (1982) ; Landau (1984) ) and introduce the Helmholtz free energy of component interactions (e.g. adhesion) via: (3) E i = U mix , i ? ? s mix , i , where U mix, i is the energy that results from adhesive forces between component i and the other components, s mix, i is the entropy of mixing and ? is the temperature which is assumed to be constant. (The analysis may also be extended to the non-isothermal case.) Introducing the interaction potential U ij between species i and j , we may write (4) U mix , i = 1 2 ? j ? i ? ? U ij ( x ? x ? ) ? i ( x ) ? j ( x ? )    d x d x ? . The entropy of mixing may be written as (5) s mix , i = R ? ? i  log  ( 1 / ? i )    d x , where R is the “gas” constant ( Rowlinson and Widom, 1982 ). To fix ideas, consider a two-component system with volume fractions ?0 and ?1 and assume that U 01 = U 10 for simplicity. Then, the total free energy of adhesion E = E 0 + E 1 is given by (6) E = ? ? U 01 ( x ? x ? ) ? 0 ( x ) ? 1 ( x ? )    d x d x ? + R ? ? ( ? 0  log  ? 0 + ? 1  log  ? 1 )    d x . Let us next suppose that the potential U 01 is localized, i.e. , U 01( x ) = ?? d U (| x |/?), where ? is a small (unit-less) parameter and d is the spatial dimension. We may perform an expansion in ? to get (7) E = ? ( R ? ( ? 0  log  ? 0 + ? 1  log  ? 1 ) + U 0 ? 0 ? 1 ? ? 2 U 2 2 ? ? 0 · ? ? 1 )    d x + O ( ? 4 ) , where U 0 = ? U (| x |) d x and U 2 = ? U (| x |)| x |2 d x are the mean and second moment of the potential, respectively. Rescaling the energy ? = E/R ? and using that ?0 = 1 ? ?1, we get (8) ? = ? ( ( ? 1  log  ? 1 + ( 1 ? ? 1 )  log ( 1 ? ? 1 ) ) + ? 0 ? 1 ( 1 ? ? 1 ) + ?? 2 2 | ? ? 1 | 2 )    d x + O ( ?? 4 ) , where ? 0 = U 0/ R ? and ??2 = ?2 U 2/ R ?. Note that the non-gradient (local) interaction term in the integrand of Eq. (8) takes the form f (?1) = f c (?1) ? ? 0 f e (?1), where f c = ?1 log ?1 + (1 ? ?1) log(1 ? ?1) and f e = ?1(?1 ? 1) are convex functions. The first term, f c , represents the repulsive energy among like components, while the second term, ? ? 0 f e , represents the adhesion energy among like components. Performing a similar expansion for the general multispecies energy in Eq. (3) and dropping the O (??4) terms, we obtain the following weakly nonlocal model of the Helmholtz free energy of the i th component: (9) E i = ? ( F i ( ? 0 , … ? N ) + ? j = 0 N ?? ij 2 2 | ? ? j | 2 )    d x , where the first term models the bulk energy of the components due to local interactions while the second (gradient energy) term models longer range interactions among the components. Here ?? ij are positive constants, such that ?? ij 2 has units of energy per unit length.  2.3 Constitutive laws for the fluxes and velocities Next, thermodynamic constitutive laws for J i and u i are posed in order to be consistent with the decrease of the total free energy E = ? i = 0 N E i . For constant temperature systems, as considered here, this is equivalent to entropy increase ( Rowlinson and Widom, 1982 ). We make the following zeroth-order simplifying approximations: (i) the densities of the components ? i = ? are matched; and (ii) that the water volume fraction is constant in time and space, i.e. , ?0 = ??W constant. Accordingly, the volume fraction of the solid components ? i = 1 N ? i = ?? S is also constant with ??S = 1 ? ??W. We further assume that there is no adhesive (mechanical) flux of water, i.e. , J 0 = 0. Correspondingly, the sum of the solid fraction fluxes ? i = 1 N J i = 0 . This is consistent with the no-void assumption mentioned earlier. Together, these assumptions allow only limited coupling between the solid and water phases. In particular, the water will primarily move freely through the system such that Eq. (1) is satisfied for the water component. More extensive coupling of between the water transport and the solid phases is considered in the single-tumor-species, multiphase models of Breward et al. (2002 , 2003) , Byrne and King (2003) , and Byrne and Preziosi (2003) . Each of the assumptions we made above may be relaxed (see App. A for a more general derivation) and we will consider more extensive coupling between the solid and liquid components in a future work, building on the more general framework in App. A . As derived in App. A , thermodynamically consistent fluxes may be taken to be the generalized Fick’s law: (10) J i = ? M? i ? ( ? E ? ? i ? ? E ? ? N ) ,     1 ? i < N ? 1 , and J N = ? ? i = 1 N ? 1 J i , where M? i > 0 is a mobility, ? E ? ? i are variational derivatives of the total energy E and are given by (11) ? E ? ? i = ? j = 0 N ( ? F j ? ? i ? ? · ( ?? ji 2 ? ? i ) ) ,     1 ? i < N . The velocities of the components may be also determined in a thermodynamically and mechanically consistent way. This can be done either by posing momentum equations for each component together with momentum exchange terms which are determined in a thermodynamically consistent way from the energy variation or by posing a generalized Darcy-type constitutive law for the velocity directly from the energy variation. The former approach is more general although the two approaches are consistent for specific modeling choices of the component stress tensors ( e.g. , see Ambrosi and Preziosi (2002) ; Byrne and Preziosi (2003) ; Chaplain et al. (2006) ). In a forthcoming work Cristini et al. (2008) , we will consider the more general momentum exchange approach. Here, we follow the latter, direct approach which is similar in spirit to the model proposed in ( Ambrosi and Preziosi, 2002 ). This approach also treats the tumors as viscous, inertialess fluids. As above, we present only the results here. The details may be found in App. A . The resulting generalized Darcy laws for the velocities of the components are given by (12) u 0 = ? k? 0 ? ( ? E ? ? 0 + q ) , (13) u j = ? k? ( ? p ? ? i = 1 N ? E ? ? i ? ? i ) ? k? j ? ( ? E ? ? j ? 1 ?? S ? i = 1 N ? i ? E ? ? i + p ?? S ) , j ? 1 , where q is the water pressure, p is the solid pressure, and k? 0, k? , k? j are positive definite motility matrices. The constitutive laws (10) , (12) , and (13) guarantee that in the absence of mass sources, the adhesion energy is non-increasing in time as the fields evolve. Note that with these choices of flux and velocity, the tumor growth equations (1) are fourth-order, nonlinear advection-reaction-diffusion equations of Cahn-Hilliard type ( Cahn and Hilliard, 1958 ).  3 Two-tumor species model of tumor growth 3.1 Basic model assumptions Here we present a two-tumor species, diffuse-interface model of tumor growth. While the following model is formulated specifically for a tumor comprised of dead (D) and viable (V) tumor cells, it will be clear that the model describing a tumor comprised of multiple tumor cell species can be formulated analogously and will be treated in Part II of this work. Also, as a first approximation we formulate the model around a single vital nutrient ( e.g. , oxygen). The transport of multiple nutrient species may be added in a straightforward way. We assume that the density of the extracellular matrix (ECM) remains constant in time and space. In particular, as a first approximation we suppose that the ECM does not significantly degrade or remodel as the tumor mass grows. The effects of matrix degrading enzymes and matrix remodeling can easily be incorporated and will be considered in future work. We make the following identifications: 0 represents the water phase: e.g. , ?0 = ??W, 1 represents the viable tumor cell phase, e.g. , ?1 = ?V, 2 represents the dead tumor cell phase, e.g. , ?2 = ?D, 3 represents the host tissue phase, e.g. , ?3 = ?H. We define the total tumor cell volume fraction ?T and the total volume fraction of the solid component ?S to be (14) ? T = ? V + ? D , (15) ? S = ? T + ? H = ?? S = 1 ? ?? W . In words, the tumor contains both viable and dead cells. In the diffuse interface context, the tumor cell volume fraction ?T is large in the tumor interior and tends rapidly, but smoothly, to zero in the tumor exterior. See Fig. D.1 (top). Between the tumor and host regions, there is a boundary layer (see Fig. D.1 ). The dividing surface ?T, i.e. , the tumor/host interface, can be arbitrarily assigned in the diffuse boundary layer. Since the maximum packing volume fraction of cells is ??S > 0 then the tumor volume fraction ?T/??S lies between 0 and 1, as depicted in the figure, and the most common and convenient choice of the inteface ?T is ?T = { x | ?T( x )/??S = 1/2}. Following this definition, we may precisely define the tumor and host domains by ?T = { x | ?T( x )/??S > 1/2} and ?H = { x | ?T( x )/??S < 1/2} respectively. From the continuum advection-reaction-diffusion equations (1) , the volume fractions of the tissue components obey (16) ? ? V ? t + ? · ( u V ? V ) = ? ? · J V + S V (17) ? ? D ? t + ? · ( u D ? D ) = ? ? · J D + S D , (18) ? ? H ? t + ? · ( u H ? H ) = ? ? · J H + S H , (19) ? ? W ? t + ? · ( u W ? W ) = ? · ( J V + J D + J H ) + S W , where J V, J D and J H are adhesion fluxes from Eq. (10) and will be specified precisely below. The quantities S V, S D, S H and S W are the net mass exchange/source/sink terms. Note that because the densities of the components are constant, we absorbed them into the fluxes and source terms. 3.2 Adhesion energy, fluxes and cell-velocities Define the total adhesion energy to be E = E W + E V + E D + E H . We suppose that tumor cells prefer to adhere to one another rather than to the host. Indeed, cell separation and sorting due to an imbalance in adhesive forces has been observed in a variety of different cell combinations. See, for example, Armstrong (1971) for a classic study and Armstrong et al. (2006) for a recent computational study using a nonlocal model of adhesion. As a simplifying assumption, we do not distinguish between the adhesive properties of the viable and dead cells. Accordingly, in Eq. (9) , we take F i (?0, …, ? N ) = ? i f (? T ) and ? ij = 0 for i, j < 3, and ?33 = ??. We therefore obtain the total adhesion energy: (20) E = ? i = 0 N E i = ? ? ( f ( ? T ) + ?? 2 2 | ? ? T | 2 )    d x , where f is a double-well bulk energy, with minima at ?T = ??S and ? T = 0, giving rise to a well-delineated phase separation of the tumor (?T ? ??S) and the host tissues (?T ? 0). This form of the energy arises also in the classic theory of phase transitions ( e.g. , Cahn and Hilliard (1958) ). Rather than using a function containing logarithmic terms as in Eq. (8) , here we use the polynomial approximation of the local interaction energy: (21) f ( ? T ) = ? 4 · ( ? T / ?? S ) 2 ( 1 ? ? T / ?? S ) 2 , where ? > 0 is an energy scale. Note that f may be written as the difference of the two convex functions (22) f ( ? T ) = f c ( ? T / ?? S ) ? f e ( ? T / ?? S ) , where (23) f c ( ? ) = ? 4 ( ( ? ? 1 / 2 ) 4 + 1 )   and  f e ( ? ) = ? 8 ( ? ? 1 / 2 ) 2 . Since ?T is continuous, it is necessary that 0 < ?T/??S < 1 in the interfacial region dividing the tumor and host domains. On the other hand, the states ?T > ??S or ?T < 0 are not physical, and the interaction energy tends to prevent their formation by increasing the energy of those states. Note that taking an interaction energy with logarithmic terms would explicitly prevent their formation ( Elliot and Luckhaus, 1991 ). In Part II of this work, we will generalize the polynomial free energy in Eq. (21) to account for multiple cell species and the effects of cell phenotype and the microenvironment on adhesion. The thickness of the diffuse interface between the tumor and host tissue depends on the relative sizes of ?? and ? . Specifically, for fixed ? the smaller the constant ?? is, the less diffuse the interfacial region is, as indicated in Fig. D.1 (top). We note that this approach has been used successfully in many problems in the physical sciences. See for example ( Anderson and McFadden, 1998 ; Lowengrub and Truskinovsky, 1998 ; Kim et al., 2003 ; Badalessi et al., 2003 ; Yue et al., 2005 ) among many others for applications to multiphase flows. We further remark that if the tumor contains different species that have different adhesion properties, the energy (20) can be modified to account for the different cell-cell interactions following the more general approach described in Sec. 2.2. Examples of energies that account for different interactions among multiple components can be found in the context of multiphase flows ( e.g. , see the treatment of three-phase flows in ( Kim and Lowengrub, 2005 )). From the flux constitutive Eq. (10) and the adhesion energy (20) , we may determine the adhesion fluxes. Recalling that the densities of the components are matched, and taking the mobilities M? V = M? ?V and M? D = M? ?D, where M? is a positive constant, we obtain the fluxes: (24) J V = ? M? ? V ? ? E ? ? V , J D = ? M? ? D ? ? E ? ? D , J H = ? ( J V + J D ) , where we have used that the energy does not depend explicitly on ?H. The terms ? E ? ? V , and ? E ? ? D are the variational derivatives of the energy with respect to ?V and ?D respectively and are given by (25) ? E ? ? V = ? E ? ? D = ? E ? ? T = f ? ( ? T ) ? ?? 2 ? 2 ? T , where we have also used that ?T = ?V + ?D. From the velocity constitutive equation (13) and the adhesion energy (20) , we obtain the following expression for the component velocities: (26) u W = ? k? W ? q , (27) u V = ? ( k? + k? V ?? V ) ( ? p ? ? E ? ? T ? ? T ) ? k? V ? H ?? S ? ? E ? ? T , (28) u D = ? ( k? + k? D ?? V ) ( ? p ? ? E ? ? T ? ? T ) ? k? D ? H ?? S ? ? E ? ? T , (29) (30) u H = ? ( k? + k? H ?? V ) ( ? p ? ? E ? ? T ? ? T ) + k? H ? T ?? S ? ? E ? ? T , where we have used that the energy does not explicitly depend on ?0 and ?H. In these equations, the terms dependent on ? E /??T represent the excess force due to adhesion and arise from cell-cell interactions. The coefficients k? W, k? , k? V, k? D, and k? H are motilities that reflect the response of the water and cells, respectively, to pressure gradients. The cell motilities contain the combined effects of cell-cell and cell-matrix adhesion. As a further simplifying assumption, we take k? V = k? D = k? H = 0 which is consistent with assuming the cells are tightly packed and that they march together (we will consider more general velocity choices in a future work). Consequently, defining the velocity of the solid components to be (31) u S = ? k? ( ? p ? ? E ? ? T ? ? T ) , we obtain u V = u D = u H = u S. Note that the motility k? > 0 may be a function of ?V, ?D and other variables. In particular, if k? = k? (?V, ?D), the individual components may respond to the pressure and adhesive forces differently, but mixtures of components tend to move together. The response of different components to the forces will be explored further in part II of our work. The constitutive choices (24) , (31) and (26) guarantee that in the absence of mass sources ( S V = S D = 0), the adhesion energy is non-increasing as the fields evolve, while the total tumor mass is conserved. We note that Cohen and Murray (1981) and Murray (2002) used a diffuse-interface model to study non-Fickian dynamics in single-species populations. As pointed by Cohen and Murray (1981) , such a model is physically and biologically consistent when Fickian diffusion is dominated by higher-order effects that tend to “maintain a spatial pattern even in a single diffusing species.” In our case this pattern is the one imposed by the interface structure that arises from the phase-separation of tumor and host cells due to differential adhesion. Purely Fickian diffusion of viable tumor cells, is recovered if E = ?? f e (?V) d 3 x , where f e is a convex function. This would tend to lessen gradients of the volume fractions and would not be appropriate for maintaining a well-delineated tumor-host interface. 3.3 Mass exchange terms As a first approximation, we assume that viable tumor cells necrose based only on the level of the local nutrient concentration n , i.e. , when the nutrient falls below the cell viability limit n? N.We assume that cells are comprised entirely of water. In terms of volume fraction, this is a reasonable first approximation.We assume that cell mitosis is proportional to the amount of nutrient present and as mitosis occurs, an appropriate amount of water is converted into cell mass. Conversely, the lysing of cells represents a mass sink as cellular membranes are degraded and the mass converts completely into water. We neglect mitosis in the host domain as the proliferation rate for tumor cells is much larger. Accordingly, we take (32) S V = ?? M n n? ? ? V ? ?? A ? V ? ?? N ? ( n? N ? n ) ? V , (33) S D = ?? A ? V + ?? N ? ( n? N ? n ) ? V ? ?? L ? D , (34) S H = 0 , (35) S W = ? ( S V + S D + S H ) = ? ?? M n n ? ? V + ?? L ? D , where ??M, ??A, ??N, and ??L are the rates of volume gain or loss due to cellular mitosis, apoptosis, necrosis, and lysing, respectively, and where n? ? is the far-field nutrient level. Finally, ? is the Heaviside function. Note that our model neglects the effects of a properly working immune system (where leukocytes phagocytose apoptotic cells) by degrading both necrotic and apoptotic tumor cells the same way. The effect of the immune system could be easily described, for example by removing the apoptotic source term in Eq. (33) . Using (15) we may now eliminate Eq. (18) . Summing Eqs. (16) – (18) , we have (36) ? · u S = 1 ?? S ( S V + S D + S H ) , and likewise (37) ? · u W = ? 1 ?? W ( S V + S D + S H ) . Finally, we present some remarks. The energy E has a central, two-fold role in our model and numerical implementation. First, from the physical and biological perspective, the energy provides a route for the modeling of multiple co-existing cell species through a description of cell adhesion that controls the spatial extent by which tumor and host cells species intermix. As mentioned above Cohen and Murray (1981) and Murray (2002) have pointed out the biological and physical significance of the diffuse interface approach in population dynamics. Second, from the computational perspective, this energy is a mathematical formalism for maintaining the structure of the diffuse interface and for keeping the cell volume fractions physically realistic. As the diffuse interface thickness goes to zero the solutions to the equations converge to solutions to a sharp interface model, in a specific sense (see Sec. 3.6). In addition, the diffuse interface model provides a convenient method for capturing the tumor evolution. While neither of the inequalities 0 ? ?T/??S ? 1 and 0 ? ?D ? ?T that are required for physically realistic solutions are strictly enforced, the energy tends to maintain these inequalities and our numerical experimentation indicates that they hold to within acceptable tolerances. The effects of adhesion appear both in the adhesion fluxes J V and J D ( e.g. , see also ( Pego, 1989 ) in the context of the Cahn-Hilliard equation) as well as in the cell-velocity u S. In the sharp interface setting ( e.g. , Cristini et al. (2003) ), the adhesion only appears in u S. The complex interplay between the two sources of adhesion is the focus of ongoing work. We have tacitly assumed that the mechanical interaction between tumor and host tissue cells and the capillaries may be neglected. This is a reasonable approximation since the ratio of endothelial to tissue cells is of the order 1/50 or 1/100 ( Bussolino et al., 2003 ). 3.4 Nutrient diffusion The nutrient diffuses through interstitial fluid to reach the cells. As a first approximation, we model the host tissue at equilibrium, where the net nutrient uptake therein is negligible compared to the uptake by tumor cells. In particular, we assume that whatever nutrient is uptaken by the host tissue is replaced by supply from the normal vasculature. This may not be the case in the tumor, where not only the uptake in general greatly exceeds the supply, but also can be much higher than that of the host tissue ( Ramanathan et al., 2005 ; Esteban and Maxwell, 2005 ). Therefore we neglect nutrient uptake by host cells and pose the following diffusion equation for the nutrient concentration n : (38) ? n ? t + ? · ( u W n ) = ? · ( D? ( ? T ) ? n ) + T? C ? ?? U n ? V / ?? S , where D? is the diffusion coefficient, and ??U is the nutrient uptake rate by the viable tumor cells. The nutrient diffusion coefficients in the tumor ( D T) and host ( D H) domains may be different and so we take (39) D? ( ? T ) = D? H ( 1 ? Q ( ? T ) ) + D? T Q ( ? T ) , where Q (?T) is an interpolation function such that Q (0) = 0 and Q (??S) = 1. Here, we will use Q (?T) = 3 (?T/??S)2 ?2 (?T/??S)3, which satisfies Q (1) = 1, Q (0) = 0, Q (1/2) = 1/2 and that Q ?(0) = Q ?(1) = 0, a useful fact for asymptotic analyses ( Jou et al., 1998 ) An additional source term, T? C, due to the presence of a capillary network in the tumor and host tissues has been incorporated, as in ( Cristini et al., 2003 ; Zheng et al., 2005 ; Frieboes et al., 2007 ; Macklin et al., 2007 ). T? C is the capillary-to-tissue nutrient transfer function and may vary depending on the differences in nutrient and pressure levels between the capillaries and the surrounding tissue. This will be explored more extensively in part II of our work where we will consider the coupling between tumor growth and the tumor-induced angiogenic response in the host and the development of a neovasculature network in 3D. For the capillary-to-tissue nutrient transfer we use the simple model (40) T? C = ?? P ( ? T ) ( n? C ? n ) + T? C ang , where ?? P ( ? T ) = ?? P H ( 1 ? Q ( ? T ) ) + ?? P T Q ( ? T )   and   ?? P T   and   ?? P H are the nutrient transfer (source) rates for preexisting capillaries in the host and tumor domains, n? C is the nutrient concentration in the capillaries and T? C ang is the nutrient transfer from the neovasculature. We defer further discussion of T? C ang until Part II of our work. 3.5 Nondimensional equations We nondimensionalize space and time using the diffusion length and mitosis time scales (41) ? = ( D? T / ?? U ) 1 2     and     ?? = ?? M ? 1 , and we introduce the characteristic tumor pressure (42) p? T = ? 2 ?? M k? , where k? is a characteristic value of the motility k? . The field variables are made dimensionless by the replacements indicated in Tab. C.1 . In particular, the solid volume fractions are now bounded above by 1. See Tab. C.2 for definitions of the nondimensional parameters. Because of Eqs. (14) and (15) , it is sufficient to solve for the volume fractions of the total tumor ?T and necrotic ?D cell species since the host and viable cell species may be recovered by ?H = 1 ? ?T and ?V = ?T ? ?D, respectively. The nondimensional equations are given as follows: (43) ? ? T ? t = M ? ( ? T ? ? ) + S T ? ? · ( u S ? T ) , (44) ? = f ? ( ? T ) ? ? 2 ? 2 ? T , (45) S T = n ( ? T ? ? D ) ? ? L ? D , where we have introduced the notation ? = ? E /??T, for the cell-chemical potential, and S T = S V + S H. The nondimensional equation for the volume fraction of necrotic cells is (46) ? ? D ? t = M ? · ( ? D ? ? ) + S D ? ? · ( u S ? D ) , (47) S D = ( ? A + ? N ? ( n N ? n ) ) ( ? T ? ? D ) ? ? L ? D . The nondimensional cell-velocity is (48) u S = ? k ( ? T , ? D ) ( ? p ? ?? ? ? ? ? T ) , where ?? is a nondimensional measure of the adhesion force (see Tab. C.2 ). The velocity is constrained to satisfy (49) ? · u S = S T . Together, Eqs. (48) and (49) constitute a Poisson equation for the pressure p : (50) ? ? · ( k ( ? T , ? D ) ? p ) = S T ? ? · ( k ( ? T , ? D ) ?? ? ? ? ? T ) . Knowing the pressure p we back calculate u S using Eq. (48) . The nondimensional nutrient equation is (51) 0 = ? · ( D ( ? T ) ? n ) + T C ( ? T , n ) ? n ? V , where we have used that nutrient diffusion occurs on much shorter time scales ( e.g. , minutes) than cell-proliferation ( e.g. , day or more) to drop the convection terms in Eq. (38) . The diffusion coefficient and angiogenesis source are (52) D ( ? T ) = D H ( 1 ? Q ( ? T ) ) + Q ( ? T ) , (53) T C ( ? T , n ) = ( ? P H ( 1 ? Q ( ? T ) ) + ? P T Q ( ? T ) ) ( n C ? n ) + T C ang . The interpolated diffusivity in Eq. (52) is appropriate when D H is comparable to 1. If on the other hand D H ? 1 or D H ? 1, then it may be necessary to use another interpolation, as we point out later. Equations (43) – (53) are valid throughout ? and not just on the tumor volume ?T. Note now that no boundary conditions are required for ?T or ?D at the tumor boundary ?T. For outer-boundary conditions, we choose (54) ? = 0 ,     n = 1 ,     ? ? · ? ? T = ? ? · ? ? D = ? ? · ? p = 0    on    ? ? , where ? ? is the outward-pointing unit normal on the outer boundary ?? = ??. The condition ? = 0 allows for the free flow of cells across the outer boundary. 3.6 Convergence to classical models The method of matched asymptotic expansions can be used to show the formal convergence of solutions of the diffuse interface model (43) – (53) , in the limit as ? ? 0, to those of a classical sharp interface model given below (see Appendix B for details): (55) ? ? D ? t + ? · ( u S ? D ) = ? A ? V + ? N ? ( n N ? n ) ? V ? ? L ? D    in    ? T , (56) ? V = 1 ? ? D    in    ? T , (57) ? D = ? V = 0    in    ? H , and in ?T and ?H: (58) u S = ? k ( ? V , ? D ) ? p , (59) ? · u S = ( n ? V ? ? L ? D ) ? ? T , where ??T is the characteristic function of the tumor domain ?T. Across ?T, the jump conditions hold: (60) [ p ] = ? ? ,      [ u S · ? ] = 0 , where ? is the mean curvature, ? is the normal vector to ?T and ? and ?? are related by ? = ?? ? 0 1 2 f ( ? )    d ? = ?? / ( 6 2 ) for the quartic local interaction energy in Eq. (21) . The nutrient satisfies (61) 0 = ? · ( D ? n ) + T C ? n ? V ? ? T , where the functions D and T C may be discontinuous across the tumor interface, satisfying (62) D = D H ? ? H + ? ? T (63) T C = ( ? P H ? ? H + ? P T ? ? T ) ( n C ? n ) , and ??H is the characteristic function of the host domain ?H. Across ?T, the nutrient satisfies the jump conditions (64) [ n ] = [ D ? · ? n ] = 0    on    ? T . At the far-field boundary ??, the boundary conditions are: (65) n = 1 , ? p · ? = 0    on    ? ? . This sharp interface system is a generalization of classical models, e.g. see ( Greenspan, 1976 ; Byrne and Chaplain, 1995 , 1996a ; Chaplain, 1996 ; Friedman and Reitich, 1999 ; Pettet et al., 2001 ; Breward et al., 2002 , 2003 ; Byrne and King, 2003 ; Cristini et al., 2003 ; Zheng et al., 2005 ; Macklin and Lowengrub, 2006 , 2007 ). The well-posedness of a such a model was recently established by Chen and Friedman (2003) . Finally, the method of matched asymptotic expansions can be used to show that the interaction force tends, in the sense of distributions, to (66) ?? ? ? ? ? T ? ? ? ? ? T ? , where ??T is the surface delta function which may be written as ? ? T = ? 6 2 | ? ? T | 2 , ? = ? · ? and ? = ???T/|??T| are again the mean curvature and the outward normal vector respectively. The form on the right-hand-side of (66) was introduced by Kim (2005) .  3.1 Basic model assumptions Here we present a two-tumor species, diffuse-interface model of tumor growth. While the following model is formulated specifically for a tumor comprised of dead (D) and viable (V) tumor cells, it will be clear that the model describing a tumor comprised of multiple tumor cell species can be formulated analogously and will be treated in Part II of this work. Also, as a first approximation we formulate the model around a single vital nutrient ( e.g. , oxygen). The transport of multiple nutrient species may be added in a straightforward way. We assume that the density of the extracellular matrix (ECM) remains constant in time and space. In particular, as a first approximation we suppose that the ECM does not significantly degrade or remodel as the tumor mass grows. The effects of matrix degrading enzymes and matrix remodeling can easily be incorporated and will be considered in future work. We make the following identifications: 0 represents the water phase: e.g. , ?0 = ??W, 1 represents the viable tumor cell phase, e.g. , ?1 = ?V, 2 represents the dead tumor cell phase, e.g. , ?2 = ?D, 3 represents the host tissue phase, e.g. , ?3 = ?H. We define the total tumor cell volume fraction ?T and the total volume fraction of the solid component ?S to be (14) ? T = ? V + ? D , (15) ? S = ? T + ? H = ?? S = 1 ? ?? W . In words, the tumor contains both viable and dead cells. In the diffuse interface context, the tumor cell volume fraction ?T is large in the tumor interior and tends rapidly, but smoothly, to zero in the tumor exterior. See Fig. D.1 (top). Between the tumor and host regions, there is a boundary layer (see Fig. D.1 ). The dividing surface ?T, i.e. , the tumor/host interface, can be arbitrarily assigned in the diffuse boundary layer. Since the maximum packing volume fraction of cells is ??S > 0 then the tumor volume fraction ?T/??S lies between 0 and 1, as depicted in the figure, and the most common and convenient choice of the inteface ?T is ?T = { x | ?T( x )/??S = 1/2}. Following this definition, we may precisely define the tumor and host domains by ?T = { x | ?T( x )/??S > 1/2} and ?H = { x | ?T( x )/??S < 1/2} respectively. From the continuum advection-reaction-diffusion equations (1) , the volume fractions of the tissue components obey (16) ? ? V ? t + ? · ( u V ? V ) = ? ? · J V + S V (17) ? ? D ? t + ? · ( u D ? D ) = ? ? · J D + S D , (18) ? ? H ? t + ? · ( u H ? H ) = ? ? · J H + S H , (19) ? ? W ? t + ? · ( u W ? W ) = ? · ( J V + J D + J H ) + S W , where J V, J D and J H are adhesion fluxes from Eq. (10) and will be specified precisely below. The quantities S V, S D, S H and S W are the net mass exchange/source/sink terms. Note that because the densities of the components are constant, we absorbed them into the fluxes and source terms.  3.2 Adhesion energy, fluxes and cell-velocities Define the total adhesion energy to be E = E W + E V + E D + E H . We suppose that tumor cells prefer to adhere to one another rather than to the host. Indeed, cell separation and sorting due to an imbalance in adhesive forces has been observed in a variety of different cell combinations. See, for example, Armstrong (1971) for a classic study and Armstrong et al. (2006) for a recent computational study using a nonlocal model of adhesion. As a simplifying assumption, we do not distinguish between the adhesive properties of the viable and dead cells. Accordingly, in Eq. (9) , we take F i (?0, …, ? N ) = ? i f (? T ) and ? ij = 0 for i, j < 3, and ?33 = ??. We therefore obtain the total adhesion energy: (20) E = ? i = 0 N E i = ? ? ( f ( ? T ) + ?? 2 2 | ? ? T | 2 )    d x , where f is a double-well bulk energy, with minima at ?T = ??S and ? T = 0, giving rise to a well-delineated phase separation of the tumor (?T ? ??S) and the host tissues (?T ? 0). This form of the energy arises also in the classic theory of phase transitions ( e.g. , Cahn and Hilliard (1958) ). Rather than using a function containing logarithmic terms as in Eq. (8) , here we use the polynomial approximation of the local interaction energy: (21) f ( ? T ) = ? 4 · ( ? T / ?? S ) 2 ( 1 ? ? T / ?? S ) 2 , where ? > 0 is an energy scale. Note that f may be written as the difference of the two convex functions (22) f ( ? T ) = f c ( ? T / ?? S ) ? f e ( ? T / ?? S ) , where (23) f c ( ? ) = ? 4 ( ( ? ? 1 / 2 ) 4 + 1 )   and  f e ( ? ) = ? 8 ( ? ? 1 / 2 ) 2 . Since ?T is continuous, it is necessary that 0 < ?T/??S < 1 in the interfacial region dividing the tumor and host domains. On the other hand, the states ?T > ??S or ?T < 0 are not physical, and the interaction energy tends to prevent their formation by increasing the energy of those states. Note that taking an interaction energy with logarithmic terms would explicitly prevent their formation ( Elliot and Luckhaus, 1991 ). In Part II of this work, we will generalize the polynomial free energy in Eq. (21) to account for multiple cell species and the effects of cell phenotype and the microenvironment on adhesion. The thickness of the diffuse interface between the tumor and host tissue depends on the relative sizes of ?? and ? . Specifically, for fixed ? the smaller the constant ?? is, the less diffuse the interfacial region is, as indicated in Fig. D.1 (top). We note that this approach has been used successfully in many problems in the physical sciences. See for example ( Anderson and McFadden, 1998 ; Lowengrub and Truskinovsky, 1998 ; Kim et al., 2003 ; Badalessi et al., 2003 ; Yue et al., 2005 ) among many others for applications to multiphase flows. We further remark that if the tumor contains different species that have different adhesion properties, the energy (20) can be modified to account for the different cell-cell interactions following the more general approach described in Sec. 2.2. Examples of energies that account for different interactions among multiple components can be found in the context of multiphase flows ( e.g. , see the treatment of three-phase flows in ( Kim and Lowengrub, 2005 )). From the flux constitutive Eq. (10) and the adhesion energy (20) , we may determine the adhesion fluxes. Recalling that the densities of the components are matched, and taking the mobilities M? V = M? ?V and M? D = M? ?D, where M? is a positive constant, we obtain the fluxes: (24) J V = ? M? ? V ? ? E ? ? V , J D = ? M? ? D ? ? E ? ? D , J H = ? ( J V + J D ) , where we have used that the energy does not depend explicitly on ?H. The terms ? E ? ? V , and ? E ? ? D are the variational derivatives of the energy with respect to ?V and ?D respectively and are given by (25) ? E ? ? V = ? E ? ? D = ? E ? ? T = f ? ( ? T ) ? ?? 2 ? 2 ? T , where we have also used that ?T = ?V + ?D. From the velocity constitutive equation (13) and the adhesion energy (20) , we obtain the following expression for the component velocities: (26) u W = ? k? W ? q , (27) u V = ? ( k? + k? V ?? V ) ( ? p ? ? E ? ? T ? ? T ) ? k? V ? H ?? S ? ? E ? ? T , (28) u D = ? ( k? + k? D ?? V ) ( ? p ? ? E ? ? T ? ? T ) ? k? D ? H ?? S ? ? E ? ? T , (29) (30) u H = ? ( k? + k? H ?? V ) ( ? p ? ? E ? ? T ? ? T ) + k? H ? T ?? S ? ? E ? ? T , where we have used that the energy does not explicitly depend on ?0 and ?H. In these equations, the terms dependent on ? E /??T represent the excess force due to adhesion and arise from cell-cell interactions. The coefficients k? W, k? , k? V, k? D, and k? H are motilities that reflect the response of the water and cells, respectively, to pressure gradients. The cell motilities contain the combined effects of cell-cell and cell-matrix adhesion. As a further simplifying assumption, we take k? V = k? D = k? H = 0 which is consistent with assuming the cells are tightly packed and that they march together (we will consider more general velocity choices in a future work). Consequently, defining the velocity of the solid components to be (31) u S = ? k? ( ? p ? ? E ? ? T ? ? T ) , we obtain u V = u D = u H = u S. Note that the motility k? > 0 may be a function of ?V, ?D and other variables. In particular, if k? = k? (?V, ?D), the individual components may respond to the pressure and adhesive forces differently, but mixtures of components tend to move together. The response of different components to the forces will be explored further in part II of our work. The constitutive choices (24) , (31) and (26) guarantee that in the absence of mass sources ( S V = S D = 0), the adhesion energy is non-increasing as the fields evolve, while the total tumor mass is conserved. We note that Cohen and Murray (1981) and Murray (2002) used a diffuse-interface model to study non-Fickian dynamics in single-species populations. As pointed by Cohen and Murray (1981) , such a model is physically and biologically consistent when Fickian diffusion is dominated by higher-order effects that tend to “maintain a spatial pattern even in a single diffusing species.” In our case this pattern is the one imposed by the interface structure that arises from the phase-separation of tumor and host cells due to differential adhesion. Purely Fickian diffusion of viable tumor cells, is recovered if E = ?? f e (?V) d 3 x , where f e is a convex function. This would tend to lessen gradients of the volume fractions and would not be appropriate for maintaining a well-delineated tumor-host interface.  3.3 Mass exchange terms As a first approximation, we assume that viable tumor cells necrose based only on the level of the local nutrient concentration n , i.e. , when the nutrient falls below the cell viability limit n? N.We assume that cells are comprised entirely of water. In terms of volume fraction, this is a reasonable first approximation.We assume that cell mitosis is proportional to the amount of nutrient present and as mitosis occurs, an appropriate amount of water is converted into cell mass. Conversely, the lysing of cells represents a mass sink as cellular membranes are degraded and the mass converts completely into water. We neglect mitosis in the host domain as the proliferation rate for tumor cells is much larger. Accordingly, we take (32) S V = ?? M n n? ? ? V ? ?? A ? V ? ?? N ? ( n? N ? n ) ? V , (33) S D = ?? A ? V + ?? N ? ( n? N ? n ) ? V ? ?? L ? D , (34) S H = 0 , (35) S W = ? ( S V + S D + S H ) = ? ?? M n n ? ? V + ?? L ? D , where ??M, ??A, ??N, and ??L are the rates of volume gain or loss due to cellular mitosis, apoptosis, necrosis, and lysing, respectively, and where n? ? is the far-field nutrient level. Finally, ? is the Heaviside function. Note that our model neglects the effects of a properly working immune system (where leukocytes phagocytose apoptotic cells) by degrading both necrotic and apoptotic tumor cells the same way. The effect of the immune system could be easily described, for example by removing the apoptotic source term in Eq. (33) . Using (15) we may now eliminate Eq. (18) . Summing Eqs. (16) – (18) , we have (36) ? · u S = 1 ?? S ( S V + S D + S H ) , and likewise (37) ? · u W = ? 1 ?? W ( S V + S D + S H ) . Finally, we present some remarks. The energy E has a central, two-fold role in our model and numerical implementation. First, from the physical and biological perspective, the energy provides a route for the modeling of multiple co-existing cell species through a description of cell adhesion that controls the spatial extent by which tumor and host cells species intermix. As mentioned above Cohen and Murray (1981) and Murray (2002) have pointed out the biological and physical significance of the diffuse interface approach in population dynamics. Second, from the computational perspective, this energy is a mathematical formalism for maintaining the structure of the diffuse interface and for keeping the cell volume fractions physically realistic. As the diffuse interface thickness goes to zero the solutions to the equations converge to solutions to a sharp interface model, in a specific sense (see Sec. 3.6). In addition, the diffuse interface model provides a convenient method for capturing the tumor evolution. While neither of the inequalities 0 ? ?T/??S ? 1 and 0 ? ?D ? ?T that are required for physically realistic solutions are strictly enforced, the energy tends to maintain these inequalities and our numerical experimentation indicates that they hold to within acceptable tolerances. The effects of adhesion appear both in the adhesion fluxes J V and J D ( e.g. , see also ( Pego, 1989 ) in the context of the Cahn-Hilliard equation) as well as in the cell-velocity u S. In the sharp interface setting ( e.g. , Cristini et al. (2003) ), the adhesion only appears in u S. The complex interplay between the two sources of adhesion is the focus of ongoing work. We have tacitly assumed that the mechanical interaction between tumor and host tissue cells and the capillaries may be neglected. This is a reasonable approximation since the ratio of endothelial to tissue cells is of the order 1/50 or 1/100 ( Bussolino et al., 2003 ).  3.4 Nutrient diffusion The nutrient diffuses through interstitial fluid to reach the cells. As a first approximation, we model the host tissue at equilibrium, where the net nutrient uptake therein is negligible compared to the uptake by tumor cells. In particular, we assume that whatever nutrient is uptaken by the host tissue is replaced by supply from the normal vasculature. This may not be the case in the tumor, where not only the uptake in general greatly exceeds the supply, but also can be much higher than that of the host tissue ( Ramanathan et al., 2005 ; Esteban and Maxwell, 2005 ). Therefore we neglect nutrient uptake by host cells and pose the following diffusion equation for the nutrient concentration n : (38) ? n ? t + ? · ( u W n ) = ? · ( D? ( ? T ) ? n ) + T? C ? ?? U n ? V / ?? S , where D? is the diffusion coefficient, and ??U is the nutrient uptake rate by the viable tumor cells. The nutrient diffusion coefficients in the tumor ( D T) and host ( D H) domains may be different and so we take (39) D? ( ? T ) = D? H ( 1 ? Q ( ? T ) ) + D? T Q ( ? T ) , where Q (?T) is an interpolation function such that Q (0) = 0 and Q (??S) = 1. Here, we will use Q (?T) = 3 (?T/??S)2 ?2 (?T/??S)3, which satisfies Q (1) = 1, Q (0) = 0, Q (1/2) = 1/2 and that Q ?(0) = Q ?(1) = 0, a useful fact for asymptotic analyses ( Jou et al., 1998 ) An additional source term, T? C, due to the presence of a capillary network in the tumor and host tissues has been incorporated, as in ( Cristini et al., 2003 ; Zheng et al., 2005 ; Frieboes et al., 2007 ; Macklin et al., 2007 ). T? C is the capillary-to-tissue nutrient transfer function and may vary depending on the differences in nutrient and pressure levels between the capillaries and the surrounding tissue. This will be explored more extensively in part II of our work where we will consider the coupling between tumor growth and the tumor-induced angiogenic response in the host and the development of a neovasculature network in 3D. For the capillary-to-tissue nutrient transfer we use the simple model (40) T? C = ?? P ( ? T ) ( n? C ? n ) + T? C ang , where ?? P ( ? T ) = ?? P H ( 1 ? Q ( ? T ) ) + ?? P T Q ( ? T )   and   ?? P T   and   ?? P H are the nutrient transfer (source) rates for preexisting capillaries in the host and tumor domains, n? C is the nutrient concentration in the capillaries and T? C ang is the nutrient transfer from the neovasculature. We defer further discussion of T? C ang until Part II of our work.  3.5 Nondimensional equations We nondimensionalize space and time using the diffusion length and mitosis time scales (41) ? = ( D? T / ?? U ) 1 2     and     ?? = ?? M ? 1 , and we introduce the characteristic tumor pressure (42) p? T = ? 2 ?? M k? , where k? is a characteristic value of the motility k? . The field variables are made dimensionless by the replacements indicated in Tab. C.1 . In particular, the solid volume fractions are now bounded above by 1. See Tab. C.2 for definitions of the nondimensional parameters. Because of Eqs. (14) and (15) , it is sufficient to solve for the volume fractions of the total tumor ?T and necrotic ?D cell species since the host and viable cell species may be recovered by ?H = 1 ? ?T and ?V = ?T ? ?D, respectively. The nondimensional equations are given as follows: (43) ? ? T ? t = M ? ( ? T ? ? ) + S T ? ? · ( u S ? T ) , (44) ? = f ? ( ? T ) ? ? 2 ? 2 ? T , (45) S T = n ( ? T ? ? D ) ? ? L ? D , where we have introduced the notation ? = ? E /??T, for the cell-chemical potential, and S T = S V + S H. The nondimensional equation for the volume fraction of necrotic cells is (46) ? ? D ? t = M ? · ( ? D ? ? ) + S D ? ? · ( u S ? D ) , (47) S D = ( ? A + ? N ? ( n N ? n ) ) ( ? T ? ? D ) ? ? L ? D . The nondimensional cell-velocity is (48) u S = ? k ( ? T , ? D ) ( ? p ? ?? ? ? ? ? T ) , where ?? is a nondimensional measure of the adhesion force (see Tab. C.2 ). The velocity is constrained to satisfy (49) ? · u S = S T . Together, Eqs. (48) and (49) constitute a Poisson equation for the pressure p : (50) ? ? · ( k ( ? T , ? D ) ? p ) = S T ? ? · ( k ( ? T , ? D ) ?? ? ? ? ? T ) . Knowing the pressure p we back calculate u S using Eq. (48) . The nondimensional nutrient equation is (51) 0 = ? · ( D ( ? T ) ? n ) + T C ( ? T , n ) ? n ? V , where we have used that nutrient diffusion occurs on much shorter time scales ( e.g. , minutes) than cell-proliferation ( e.g. , day or more) to drop the convection terms in Eq. (38) . The diffusion coefficient and angiogenesis source are (52) D ( ? T ) = D H ( 1 ? Q ( ? T ) ) + Q ( ? T ) , (53) T C ( ? T , n ) = ( ? P H ( 1 ? Q ( ? T ) ) + ? P T Q ( ? T ) ) ( n C ? n ) + T C ang . The interpolated diffusivity in Eq. (52) is appropriate when D H is comparable to 1. If on the other hand D H ? 1 or D H ? 1, then it may be necessary to use another interpolation, as we point out later. Equations (43) – (53) are valid throughout ? and not just on the tumor volume ?T. Note now that no boundary conditions are required for ?T or ?D at the tumor boundary ?T. For outer-boundary conditions, we choose (54) ? = 0 ,     n = 1 ,     ? ? · ? ? T = ? ? · ? ? D = ? ? · ? p = 0    on    ? ? , where ? ? is the outward-pointing unit normal on the outer boundary ?? = ??. The condition ? = 0 allows for the free flow of cells across the outer boundary.  3.6 Convergence to classical models The method of matched asymptotic expansions can be used to show the formal convergence of solutions of the diffuse interface model (43) – (53) , in the limit as ? ? 0, to those of a classical sharp interface model given below (see Appendix B for details): (55) ? ? D ? t + ? · ( u S ? D ) = ? A ? V + ? N ? ( n N ? n ) ? V ? ? L ? D    in    ? T , (56) ? V = 1 ? ? D    in    ? T , (57) ? D = ? V = 0    in    ? H , and in ?T and ?H: (58) u S = ? k ( ? V , ? D ) ? p , (59) ? · u S = ( n ? V ? ? L ? D ) ? ? T , where ??T is the characteristic function of the tumor domain ?T. Across ?T, the jump conditions hold: (60) [ p ] = ? ? ,      [ u S · ? ] = 0 , where ? is the mean curvature, ? is the normal vector to ?T and ? and ?? are related by ? = ?? ? 0 1 2 f ( ? )    d ? = ?? / ( 6 2 ) for the quartic local interaction energy in Eq. (21) . The nutrient satisfies (61) 0 = ? · ( D ? n ) + T C ? n ? V ? ? T , where the functions D and T C may be discontinuous across the tumor interface, satisfying (62) D = D H ? ? H + ? ? T (63) T C = ( ? P H ? ? H + ? P T ? ? T ) ( n C ? n ) , and ??H is the characteristic function of the host domain ?H. Across ?T, the nutrient satisfies the jump conditions (64) [ n ] = [ D ? · ? n ] = 0    on    ? T . At the far-field boundary ??, the boundary conditions are: (65) n = 1 , ? p · ? = 0    on    ? ? . This sharp interface system is a generalization of classical models, e.g. see ( Greenspan, 1976 ; Byrne and Chaplain, 1995 , 1996a ; Chaplain, 1996 ; Friedman and Reitich, 1999 ; Pettet et al., 2001 ; Breward et al., 2002 , 2003 ; Byrne and King, 2003 ; Cristini et al., 2003 ; Zheng et al., 2005 ; Macklin and Lowengrub, 2006 , 2007 ). The well-posedness of a such a model was recently established by Chen and Friedman (2003) . Finally, the method of matched asymptotic expansions can be used to show that the interaction force tends, in the sense of distributions, to (66) ?? ? ? ? ? T ? ? ? ? ? T ? , where ??T is the surface delta function which may be written as ? ? T = ? 6 2 | ? ? T | 2 , ? = ? · ? and ? = ???T/|??T| are again the mean curvature and the outward normal vector respectively. The form on the right-hand-side of (66) was introduced by Kim (2005) .  4 Numerical method The governing equations (43) – (51) are complex high-order nonlinear partial differential equations, and require sophisticated numerical methods to avoid severe time-step restrictions for numerical stability, to accurately resolve phenomena on various spatial scales, and to solve the equations efficiently. With these considerations in mind, we build upon our previous work ( Wise et al., 2007 ) and develop a new nonlinear, multilevel multigrid method combined with adaptive, block-structured Cartesian mesh refinement to solve the governing equations. This algorithm allows for a very fine resolution of the tumor interface without expending computational resources where fine resolution may be unnecessary. In short, the numerical degrees of freedom can be very nearly minimized. Since the solver is based on the multigrid algorithm, the resulting discrete equations can be solved with nearly optimal complexity ( Trottenberg et al., 2005 ). Here, we very briefly describe the algorithm for a two-dimensional computational domain. The details of the discretization are deferred to a forthcoming work Wise et al. (2008) . We use the second-order accurate Crank-Nicholson algorithm to solve the equations at the implicit time level ( Morton and Mayers, 2005 ). The equations are discretized in space using (at least) second-order accurate finite differences. Except for the advection terms, center-differences are used to replace the derivatives. The advection terms are treated using an upwinding WENO scheme ( Jiang and Shu, 1996 ). The governing equations are discretized on a block-structured Cartesian mesh, examples of which are seen in Fig. D.5a . The composite mesh consists of a hierarchy of levels. The coarsest level, that with the largest mesh-spacing, is called the root level, or the level-0 mesh. The root-level consists of a single rectangular, uniform grid of mesh spacing h 0. The next level, the level-1 mesh, consists of a union of rectangular grid patches. The uniform spacing of cells in the level 1 mesh, h 1, is half of h 0. The next level of refinement is called level 2, and again consists of a union of uniform rectangular grids, with mesh spacing h 2 = h 1/2, etc. Each new “child” level mesh lives on top of the coarser “parent” level mesh ( Wise et al., 2007 ). In Fig. D.5a each mesh (the mesh changes every time step) has a root level grid of size 64 × 64, and there are 3 levels of refinement. The mesh-spacings are h 0 = 40/64, h 1 = 40/128, h 2 = 40/256, and h 3 = 40/512. We say that each composite mesh in Fig D.5a has an effective resolution of 512 × 512, meaning that to obtain the equivalent resolution using a uniform grid the grid would have size 512 × 512. However, it is clear that each mesh has significantly fewer cells than 5122, especially at early times. Where the child level mesh is added in the parent depends upon certain refinement criteria. Here we have used a single, very simple refine criterion. We refine the mesh in areas where the volume fractions have a steep gradient. In particular, the volume fraction of tumor cells has a steep gradient at the tumor/host interface. The refinement in Fig. D.5a is such that there are approximately 8 mesh cells in the finest level between the level curves ?T = 0.1 and ?T = 0.9. We also refine the mesh so as to have sufficient resolution of the necrotic interface, i.e. , the region between the level curves ?D = 0.1 and ?D ? 0.9. The refinement criterion can be modified to account for other physical processes. For example, as explored in Part II of this work, refinement may be initiated around the growing blood vessels in addition to the tumor/host or species/species interfaces in the system ( Frieboes et al., 2007 ). (A similar refinement scheme was adopted by Zheng et al. (2005) for coupled growth and neovascularization in 2D.) Once a new, locally-refined, block-structured Cartesian mesh is constructed data are copied and or interpolated into the new composite mesh, the governing equations are discretized on the composite mesh, and the resulting nonlinear system of equations is solved according to the nonlinear FAS multigrid method. The basic methodology of refining, interpolating, and solving is detailed by Wise et al. (2007) . Finally, by h min we denote the smallest mesh-spacing in the composite mesh. In other words, h min = h k max, where k max is the number of levels or refinement. By s we denote the fixed time-step size for the simulation.  5 Numerical results We begin this section by considering spherically symmetric, avascular tumor growth in 5.1. In Secs. 5.2 and 5.3 we examine nonsymmetric tumor growth in two and three dimensions, respectively. For simplicity, we will assume here that the cell-motility k = 1. In Part II, we will explore the effect of variable cell-motility. See also Macklin and Lowengrub (2006) for simulations where k is nonuniform. 5.1 Spherically symmetric solutions In Fig. D.2 a typical evolution to steady state is shown for a spherically symmetric tumor. This simulation is performed by solving the system of equations (43) – (51) in spherical coordinates. The nondimensional parameters for the simulations are given in Tab. C.3 . Note that the nutrient diffusion coefficients inside and outside of the tumor are matched. The computational domain is [0, 10] and the spatial and temporal grid sizes are h min = 10/128 and s = 5.0 × 10?3. Because the solution is one dimensional and thus resolution is not an issue, we use a uniform mesh. At time t = 0, there are no dead cells. As the evolution proceeds, cells undergo necrosis near the tumor center as the nutrient drops below the level needed for viability. A necrotic core then develops. As the necrotic (dead) cells are lysed, water is released and is uptaken by the proliferating cells near the tumor/host interface. This creates a flux of water outward from the center of the tumor spheroid (e.g. positive water velocity u W). As cellular mass is lost due to lysing, viable cells in the proliferating rim are fluxed towards the tumor spheroid center (e.g. negative cell velocity u S). The tumor grows to a diffusion-limited steady-state size with a final radius r T ? 4.35, where r T is defined by ?T( r T) = 0.5. At steady state, observe that the velocity u S at the tumor interface r T is nearly zero. u S need not be precisely zero at the interface at steady-state, since there is an effective diffusion velocity associated with adhesion that acts against it. Inside the tumor the cellular velocity is negative and the water velocity is positive. There is still proliferation of viable cells, mainly near the tumor boundary, but only enough to exactly balance the loss due to lysing and degradation. These results are consistent with the predictions of previous models of solid tumor growth ( e.g. , see the reviews ( Chaplain, 1996 ; Bellomo et al., 2003 ; Araujo and McElwain, 2004 ; Byrne et al., 2006 )). The interface between the necrotic core (where ?D ? 1) and the proliferating rim (where ?D ? 0) is well-delineated for this set of parameters. However, because viable cells do not become necrose instantly, but at a certain rate (controlled by ?N = 3.0), the necrotic interface is not sharp. In fact there are some viable cells in the hypoxic region where n < n N. Recall from Tab. C.3 that n N = 0.11. This is consistent with experimental observations where perinecrotic regions can be seen. In the limit as ?N ? ? the necrotic interface becomes sharp, and the nutrient concentration in the necrotic core approaches the value n N. At steady-state, the tumor cell density outside the bulk of the tumor ( e.g. , for r > r T ? 4.35) is very small but non-zero. This reflects the fact that the adhesive force is not strong enough to hold all the proliferating tumor cells together and instead a very small fraction of cells escape into the host domain. We note that such behavior is consistent with steady, spherical solutions of the pure Cahn-Hilliard equation ( e.g. , Eq. (43) where the cell-velocity u S and source term S T are neglected, see for example Lowengrub and Truskinovsky (1998) ). The amount of shedding can be controlled through the interface thickness parameter ? (which is 0.1 in Fig. D.2 ). This is seen in Fig. D.3 where the steady-states are shown corresponding to interface thicknesses ? = 0.1 in (a), 0.05 in (b), 0.025 in (c), and 0.0125 in (d). The density of tumor cells in the host domain tends to zero as ? ? 0 as the interface between the tumor and host domains sharpens. Because there is a finite necrosis rate ?N, the necrotic interface remains non-sharp as ? decreases. Further, when ? = 0.0125, the pressure jump across the tumor/host interface is [ p ] ? 0.4552 which is very close to the sharp interface value of 0.4591. Finally, we note that, consistent with other tumor growth models, the celladhesion parameter ? (recall ? = ?? / ( 6 2 ) ) has no effect on the steady-state radius of the spherically symmetric tumor but does affect the pressure and cell-velocity inside the tumor. As we will see later, the cell-adhesion can have a profound effect on the morphology of non-symmetric tumors. 5.2 Two dimensional tumor growth We next present fully two-dimensional simulations of tumor growth using the parameters given in Tab. C.4 . A radially symmetric tumor with the parameters for Fig. D.4a would reach a steady size with radius r T ? 3.75. Because the diffusivity of the nutrient in the host medium is 1000 times larger than that in the tumor interstitium, we do not use Eq. (52) to interpolate the diffusivity but rather instead we use (67) D ( ? T ) = 1 + ( D H ? 1 ) ( 1 ? ? T ) 8 . This interpolation function sets the diffusivity at the interface (?T = 0.5) to be D (0.5) ? 4.9. If Eq. (52) , which is appropriate for a ratio of the diffusion coefficients less than 10, were used the model greatly over-predicts the diffusivity of nutrient in the proliferating rim. Since the cell-motilities are matched inside and outside the tumor ( k = 1), the host medium is able to sustain pressure gradients. The host medium could represent a gel or porous scaffold, interpenetrated by a nutrient-rich fluid or could also represent a well-perfused host tissue. The effect, and interpretation, of inhomogeneous cell motilities on the growth of solid tumors was recently discussed in Macklin and Lowengrub (2006) . The evolution of the tumor is shown in Fig. D.4a . More specifically, the level curves ?V = 0.5 are plotted. The initial condition is a slightly elliptical tumor, with its major axis along the x -direction: ?T = {( x, y )| x 2/1.1 + y 2 = 22}. The computational domain is ? = [0, 20] × [0, 20], the time step is s = 1.0 × 10?2. In this simulation, a uniform mesh is used with mesh size h min = 20/256. While the adhesion parameter ? = 0 here, the adhesion energy gives rise to a relatively small body force (via the cell-chemical potential ? in Eq. (43) ) which tends to hold the tumor together. Initially, there are no dead cells in the tumor, but they quickly begin to accrue since the nutrient concentration falls below level needed for viability ( n N = 0.6) in the center of the tumor from the initial time. The viable region of cells is located primarily between the inner and outer 0.5 contours of ?V and the dead cells primarily lie in the region bounded by the inner 0.5 contour. At time t = 5, the tumor has a fully developed necrotic core, and the perturbed radius of the tumor boundary is about 3.5. Rather than tending toward a steady solution as it would if the tumor was radially symmetric, instead the perturbation grows. One can observe a slight bulge oriented along the x -direction. At later times, the (diffusional) instability becomes more pronounced and the tumor develops buds that elongate into protruding fingers. The instability enables the tumor to increase its exposure to nutrient as its surface area increases relative to its volume. This allows the tumor to overcome the diffusional limitations to growth. The tumor will grow indefinitely as the instability repeats itself on the buds and protruding fingers. This is shown more clearly in the next figure ( Fig. D.5a ). At t = 45, the numerical solutions at two resolutions are compared where the dashed curve corresponds to a more refined mesh: h min = 20.0/512, s = 5.0 × 10?3. There is good agreement between the two simulations indicating that adequate resolution is achieved using h min = 20/256 for the interface thickness parameter ? = 0.1. This degree of resolution puts approximately 8 mesh cells across the tumor/host diffuse interface region during the calculation. Smaller values of ? lead to thinner diffuse interface thicknesses, and would require more resolution to accurately track the tumor evolution. Figure D.4b shows some further details of the simulation in Fig. D.4a . In Fig. D.4b (left) a close-up of the pressure field is shown at t = 45 with the ?V = 0.5 contours and the cell velocity field u S. One can see by the cell velocity that the tumor is pinching in the middle, and growing at its buds. In particular around the points (11, 12) and (16, 10) the velocity at the tumor boundary points inward towards the center of the tumor, where the pressure is lowest due to the lysing of dead cells. On the other hand, around the point (11, 16), at the tip of the bulb where there is considerably more proliferation, the velocity field points outward from the tumor. This phenomenon bears a striking similarity to, and a quantitative explanation for, the swirling arrangement of glioma cells as seen in our previous in vitro experiments of tumor growth. In particular, see Fig. D.4c which is taken from Frieboes et al. (2006) . In Fig. D.4b (right) the nutrient and pressure fields are shown at the slightly later time t = 47.5. Four buds are now clearly visible. The tumor has evolved into a complicated structure in order to maximize its surface area relative to its sustainable volume. Notice that the shape of the tumor has nearly perfect reflectional symmetry relative to the axes x = 10 and y = 10, forming from an initially perturbed shape having the same symmetries. Note that in the invaginations where access to nutrient is limited, the nutrient concentration is considerably less than 1 ( e.g. , near the points (10, 7) and (10, 13)). In Fig. D.5a we consider a growing tumor in a much larger domain (twice the size in each coordinate direction); the initial tumor shape is as in Fig. D.4a . The parameters are given in Tab. C.4 . Nutrient is supplied in the host through an assumed pre-existing vasculature with n C = 1. To solve the system of equations efficiently, the adaptive mesh algorithm is used with three levels of refinement. Each level of refinement has half the mesh spacing of the one on the level below. The coarsest level, level 0, consists of a grid of size 64 × 64. The finest level, level 3, has the equivalent resolution of a 512 × 512 uniform grid. The time step is s = 1 × 10?2, and the space step is h min = 40/512. In Fig. D.5a , the ?V = 0.5 contours are shown together with the adaptive mesh. The bottom right image shows the full viable cell region (white) at t = 200. As in Fig. D.4a , the regions surrounded by the inner ?V = 0.5 contour contain primarily dead cells while the region exterior to the outer ?V = 0.5 contour is the host tissue. The simulation shows that the tumor evolves nonlinearly into a complex, branched shape that invades the host tissue. The complex structure arises from diffusional instability which leads to the creation of buds which then elongate and become unstable themselves. As in the previous figure, the tumor will grow indefinitely via this mechanism. The results obtained here are consistent with the predictions of linear stability theory for an analogous sharp interface model ( Byrne and Chaplain, 1995 , 1996b ; Cristini et al., 2003 ; Li et al., 2007 ), and previous nonlinear simulations of unstable tumor growth ( Macklin and Lowengrub, 2005 ; Zheng et al., 2005 ; Macklin and Lowengrub, 2006 , 2007 ). Figure D.5b shows (a) the water pressure, with the water velocity field superimposed, and (b) the cell pressure and velocity of the growing symmetric tumor at time t = 125 from the simulation in Fig. D.5a . The water is fluxed out from the center of the tumor where dead cells are lysing and converting their mass back to water. On the other hand, the cell pressure is lowest in the interior of the tumor, and tumor cells tend to flow toward the necrotic region. This is seen in the radially symmetric case in Figs D.2 and D.3 as well although there are two-dimensional features seen here. Observe that there is the circulation present in the cell velocity which is largely absent in the water velocity. There is still growth of the tumor in this case, but mainly near the tumor/host interface. The involution of the tumor can be clearly seen in Fig. D.5b(b) , as the tumor increases its surface area to expose more interior cells to nutrients. 5.3 Three dimensional tumor growth We next consider asymmetric growth in three dimensions. The nondimensional parameters for the simulations are given in Tab. C.3 . In Fig. D.6 the isosurfaces corresponding to ?V = 0.5 are shown throughout the evolution (the inner surface bounds the necrotic core). In Fig. D.6(a) the cell adhesion parameter ? = 0; in Fig. D.6(b) ? = 0.1; and in Fig. D.6(c) the parameter ? is ten times larger: ? = 1.0. The initial tumor shape is the same for all three simulations, and is comprised of two dominant spherical harmonic modes, a two mode and a four mode. The computational domain is ? = [0, 20] × [0, 20] × [0, 20], and the numerical resolution is h min = 20.0/128, s = 2.0 × 10?2. For the smaller cell adhesion cases (? = 0 and 0.1, Figs. D.6(a) and D.6(b) ), both the two and the four modes are unstable during growth. When ? = 0, the tumor breaks apart in the middle by time t = 30 as the upper and lower lobes grow towards the nutrient-rich boundary. When ? = 0.1, the break-up occurs somewhat later. The precise distribution of nutrients outside the tumor also plays a critical role in the morphological evolution of the tumor boundary. When the surface tension is 10 times larger (? = 1.0, Fig D.6(c) ), the tumor grows with a more compact shape, and only the two-mode is unstable. The tumor elongates only in the z -direction, as the top and bottom buds grow to the nutrient rich outer boundary. This behavior is consistent with linear stability analyses, and recent studies, e.g. , ( Byrne and Chaplain, 1996b ; Cristini et al., 2003 ; Anderson, 2005 ; Zheng et al., 2005 ; Frieboes et al., 2006 ; Cristini et al., 2005 ; Macklin and Lowengrub, 2006 ; Li et al., 2007 ; Gerlee and Anderson, 2007b , a ), which predict that cell adhesion stabilizes tumor morphologies from high wavenumber instabilities and that increasing the cell adhesion increases the range of stable wavenumbers. The corresponding adaptive computational mesh for the simulation in Fig. D.6(a) is shown in Fig. D.7 . The finest mesh (red) is clustered around the tumor boundary to resolve the diffuse interface, as well as the necrotic interface where ?D ? 0.5. The coarsest grid (not shown), which covers the entire computational domain, has size 323 and mesh spacing h 0 = 20.0/32. There are two levels of refinement in the composite mesh, with respective mesh spacings of h 1 = 20.0/64 (mesh spacing in the blue boxes) and h 2 = h min = 20.0/128 (mesh spacing in the red boxes). This simulation, which took less than 24 hours on a 3.2GHz pc, demonstrates the capability of feasibly simulating complex tumor progression in three dimensions.  5.1 Spherically symmetric solutions In Fig. D.2 a typical evolution to steady state is shown for a spherically symmetric tumor. This simulation is performed by solving the system of equations (43) – (51) in spherical coordinates. The nondimensional parameters for the simulations are given in Tab. C.3 . Note that the nutrient diffusion coefficients inside and outside of the tumor are matched. The computational domain is [0, 10] and the spatial and temporal grid sizes are h min = 10/128 and s = 5.0 × 10?3. Because the solution is one dimensional and thus resolution is not an issue, we use a uniform mesh. At time t = 0, there are no dead cells. As the evolution proceeds, cells undergo necrosis near the tumor center as the nutrient drops below the level needed for viability. A necrotic core then develops. As the necrotic (dead) cells are lysed, water is released and is uptaken by the proliferating cells near the tumor/host interface. This creates a flux of water outward from the center of the tumor spheroid (e.g. positive water velocity u W). As cellular mass is lost due to lysing, viable cells in the proliferating rim are fluxed towards the tumor spheroid center (e.g. negative cell velocity u S). The tumor grows to a diffusion-limited steady-state size with a final radius r T ? 4.35, where r T is defined by ?T( r T) = 0.5. At steady state, observe that the velocity u S at the tumor interface r T is nearly zero. u S need not be precisely zero at the interface at steady-state, since there is an effective diffusion velocity associated with adhesion that acts against it. Inside the tumor the cellular velocity is negative and the water velocity is positive. There is still proliferation of viable cells, mainly near the tumor boundary, but only enough to exactly balance the loss due to lysing and degradation. These results are consistent with the predictions of previous models of solid tumor growth ( e.g. , see the reviews ( Chaplain, 1996 ; Bellomo et al., 2003 ; Araujo and McElwain, 2004 ; Byrne et al., 2006 )). The interface between the necrotic core (where ?D ? 1) and the proliferating rim (where ?D ? 0) is well-delineated for this set of parameters. However, because viable cells do not become necrose instantly, but at a certain rate (controlled by ?N = 3.0), the necrotic interface is not sharp. In fact there are some viable cells in the hypoxic region where n < n N. Recall from Tab. C.3 that n N = 0.11. This is consistent with experimental observations where perinecrotic regions can be seen. In the limit as ?N ? ? the necrotic interface becomes sharp, and the nutrient concentration in the necrotic core approaches the value n N. At steady-state, the tumor cell density outside the bulk of the tumor ( e.g. , for r > r T ? 4.35) is very small but non-zero. This reflects the fact that the adhesive force is not strong enough to hold all the proliferating tumor cells together and instead a very small fraction of cells escape into the host domain. We note that such behavior is consistent with steady, spherical solutions of the pure Cahn-Hilliard equation ( e.g. , Eq. (43) where the cell-velocity u S and source term S T are neglected, see for example Lowengrub and Truskinovsky (1998) ). The amount of shedding can be controlled through the interface thickness parameter ? (which is 0.1 in Fig. D.2 ). This is seen in Fig. D.3 where the steady-states are shown corresponding to interface thicknesses ? = 0.1 in (a), 0.05 in (b), 0.025 in (c), and 0.0125 in (d). The density of tumor cells in the host domain tends to zero as ? ? 0 as the interface between the tumor and host domains sharpens. Because there is a finite necrosis rate ?N, the necrotic interface remains non-sharp as ? decreases. Further, when ? = 0.0125, the pressure jump across the tumor/host interface is [ p ] ? 0.4552 which is very close to the sharp interface value of 0.4591. Finally, we note that, consistent with other tumor growth models, the celladhesion parameter ? (recall ? = ?? / ( 6 2 ) ) has no effect on the steady-state radius of the spherically symmetric tumor but does affect the pressure and cell-velocity inside the tumor. As we will see later, the cell-adhesion can have a profound effect on the morphology of non-symmetric tumors.  5.2 Two dimensional tumor growth We next present fully two-dimensional simulations of tumor growth using the parameters given in Tab. C.4 . A radially symmetric tumor with the parameters for Fig. D.4a would reach a steady size with radius r T ? 3.75. Because the diffusivity of the nutrient in the host medium is 1000 times larger than that in the tumor interstitium, we do not use Eq. (52) to interpolate the diffusivity but rather instead we use (67) D ( ? T ) = 1 + ( D H ? 1 ) ( 1 ? ? T ) 8 . This interpolation function sets the diffusivity at the interface (?T = 0.5) to be D (0.5) ? 4.9. If Eq. (52) , which is appropriate for a ratio of the diffusion coefficients less than 10, were used the model greatly over-predicts the diffusivity of nutrient in the proliferating rim. Since the cell-motilities are matched inside and outside the tumor ( k = 1), the host medium is able to sustain pressure gradients. The host medium could represent a gel or porous scaffold, interpenetrated by a nutrient-rich fluid or could also represent a well-perfused host tissue. The effect, and interpretation, of inhomogeneous cell motilities on the growth of solid tumors was recently discussed in Macklin and Lowengrub (2006) . The evolution of the tumor is shown in Fig. D.4a . More specifically, the level curves ?V = 0.5 are plotted. The initial condition is a slightly elliptical tumor, with its major axis along the x -direction: ?T = {( x, y )| x 2/1.1 + y 2 = 22}. The computational domain is ? = [0, 20] × [0, 20], the time step is s = 1.0 × 10?2. In this simulation, a uniform mesh is used with mesh size h min = 20/256. While the adhesion parameter ? = 0 here, the adhesion energy gives rise to a relatively small body force (via the cell-chemical potential ? in Eq. (43) ) which tends to hold the tumor together. Initially, there are no dead cells in the tumor, but they quickly begin to accrue since the nutrient concentration falls below level needed for viability ( n N = 0.6) in the center of the tumor from the initial time. The viable region of cells is located primarily between the inner and outer 0.5 contours of ?V and the dead cells primarily lie in the region bounded by the inner 0.5 contour. At time t = 5, the tumor has a fully developed necrotic core, and the perturbed radius of the tumor boundary is about 3.5. Rather than tending toward a steady solution as it would if the tumor was radially symmetric, instead the perturbation grows. One can observe a slight bulge oriented along the x -direction. At later times, the (diffusional) instability becomes more pronounced and the tumor develops buds that elongate into protruding fingers. The instability enables the tumor to increase its exposure to nutrient as its surface area increases relative to its volume. This allows the tumor to overcome the diffusional limitations to growth. The tumor will grow indefinitely as the instability repeats itself on the buds and protruding fingers. This is shown more clearly in the next figure ( Fig. D.5a ). At t = 45, the numerical solutions at two resolutions are compared where the dashed curve corresponds to a more refined mesh: h min = 20.0/512, s = 5.0 × 10?3. There is good agreement between the two simulations indicating that adequate resolution is achieved using h min = 20/256 for the interface thickness parameter ? = 0.1. This degree of resolution puts approximately 8 mesh cells across the tumor/host diffuse interface region during the calculation. Smaller values of ? lead to thinner diffuse interface thicknesses, and would require more resolution to accurately track the tumor evolution. Figure D.4b shows some further details of the simulation in Fig. D.4a . In Fig. D.4b (left) a close-up of the pressure field is shown at t = 45 with the ?V = 0.5 contours and the cell velocity field u S. One can see by the cell velocity that the tumor is pinching in the middle, and growing at its buds. In particular around the points (11, 12) and (16, 10) the velocity at the tumor boundary points inward towards the center of the tumor, where the pressure is lowest due to the lysing of dead cells. On the other hand, around the point (11, 16), at the tip of the bulb where there is considerably more proliferation, the velocity field points outward from the tumor. This phenomenon bears a striking similarity to, and a quantitative explanation for, the swirling arrangement of glioma cells as seen in our previous in vitro experiments of tumor growth. In particular, see Fig. D.4c which is taken from Frieboes et al. (2006) . In Fig. D.4b (right) the nutrient and pressure fields are shown at the slightly later time t = 47.5. Four buds are now clearly visible. The tumor has evolved into a complicated structure in order to maximize its surface area relative to its sustainable volume. Notice that the shape of the tumor has nearly perfect reflectional symmetry relative to the axes x = 10 and y = 10, forming from an initially perturbed shape having the same symmetries. Note that in the invaginations where access to nutrient is limited, the nutrient concentration is considerably less than 1 ( e.g. , near the points (10, 7) and (10, 13)). In Fig. D.5a we consider a growing tumor in a much larger domain (twice the size in each coordinate direction); the initial tumor shape is as in Fig. D.4a . The parameters are given in Tab. C.4 . Nutrient is supplied in the host through an assumed pre-existing vasculature with n C = 1. To solve the system of equations efficiently, the adaptive mesh algorithm is used with three levels of refinement. Each level of refinement has half the mesh spacing of the one on the level below. The coarsest level, level 0, consists of a grid of size 64 × 64. The finest level, level 3, has the equivalent resolution of a 512 × 512 uniform grid. The time step is s = 1 × 10?2, and the space step is h min = 40/512. In Fig. D.5a , the ?V = 0.5 contours are shown together with the adaptive mesh. The bottom right image shows the full viable cell region (white) at t = 200. As in Fig. D.4a , the regions surrounded by the inner ?V = 0.5 contour contain primarily dead cells while the region exterior to the outer ?V = 0.5 contour is the host tissue. The simulation shows that the tumor evolves nonlinearly into a complex, branched shape that invades the host tissue. The complex structure arises from diffusional instability which leads to the creation of buds which then elongate and become unstable themselves. As in the previous figure, the tumor will grow indefinitely via this mechanism. The results obtained here are consistent with the predictions of linear stability theory for an analogous sharp interface model ( Byrne and Chaplain, 1995 , 1996b ; Cristini et al., 2003 ; Li et al., 2007 ), and previous nonlinear simulations of unstable tumor growth ( Macklin and Lowengrub, 2005 ; Zheng et al., 2005 ; Macklin and Lowengrub, 2006 , 2007 ). Figure D.5b shows (a) the water pressure, with the water velocity field superimposed, and (b) the cell pressure and velocity of the growing symmetric tumor at time t = 125 from the simulation in Fig. D.5a . The water is fluxed out from the center of the tumor where dead cells are lysing and converting their mass back to water. On the other hand, the cell pressure is lowest in the interior of the tumor, and tumor cells tend to flow toward the necrotic region. This is seen in the radially symmetric case in Figs D.2 and D.3 as well although there are two-dimensional features seen here. Observe that there is the circulation present in the cell velocity which is largely absent in the water velocity. There is still growth of the tumor in this case, but mainly near the tumor/host interface. The involution of the tumor can be clearly seen in Fig. D.5b(b) , as the tumor increases its surface area to expose more interior cells to nutrients.  5.3 Three dimensional tumor growth We next consider asymmetric growth in three dimensions. The nondimensional parameters for the simulations are given in Tab. C.3 . In Fig. D.6 the isosurfaces corresponding to ?V = 0.5 are shown throughout the evolution (the inner surface bounds the necrotic core). In Fig. D.6(a) the cell adhesion parameter ? = 0; in Fig. D.6(b) ? = 0.1; and in Fig. D.6(c) the parameter ? is ten times larger: ? = 1.0. The initial tumor shape is the same for all three simulations, and is comprised of two dominant spherical harmonic modes, a two mode and a four mode. The computational domain is ? = [0, 20] × [0, 20] × [0, 20], and the numerical resolution is h min = 20.0/128, s = 2.0 × 10?2. For the smaller cell adhesion cases (? = 0 and 0.1, Figs. D.6(a) and D.6(b) ), both the two and the four modes are unstable during growth. When ? = 0, the tumor breaks apart in the middle by time t = 30 as the upper and lower lobes grow towards the nutrient-rich boundary. When ? = 0.1, the break-up occurs somewhat later. The precise distribution of nutrients outside the tumor also plays a critical role in the morphological evolution of the tumor boundary. When the surface tension is 10 times larger (? = 1.0, Fig D.6(c) ), the tumor grows with a more compact shape, and only the two-mode is unstable. The tumor elongates only in the z -direction, as the top and bottom buds grow to the nutrient rich outer boundary. This behavior is consistent with linear stability analyses, and recent studies, e.g. , ( Byrne and Chaplain, 1996b ; Cristini et al., 2003 ; Anderson, 2005 ; Zheng et al., 2005 ; Frieboes et al., 2006 ; Cristini et al., 2005 ; Macklin and Lowengrub, 2006 ; Li et al., 2007 ; Gerlee and Anderson, 2007b , a ), which predict that cell adhesion stabilizes tumor morphologies from high wavenumber instabilities and that increasing the cell adhesion increases the range of stable wavenumbers. The corresponding adaptive computational mesh for the simulation in Fig. D.6(a) is shown in Fig. D.7 . The finest mesh (red) is clustered around the tumor boundary to resolve the diffuse interface, as well as the necrotic interface where ?D ? 0.5. The coarsest grid (not shown), which covers the entire computational domain, has size 323 and mesh spacing h 0 = 20.0/32. There are two levels of refinement in the composite mesh, with respective mesh spacings of h 1 = 20.0/64 (mesh spacing in the blue boxes) and h 2 = h min = 20.0/128 (mesh spacing in the red boxes). This simulation, which took less than 24 hours on a 3.2GHz pc, demonstrates the capability of feasibly simulating complex tumor progression in three dimensions.  6 Summary and Future Work In this paper, which is the first in a two-part series, we developed, analyzed and simulated a thermodynamically consistent diffuse interface continuum model of multispecies tumor growth. Sharp interfaces were replaced by narrow transition layers that arose as a result of differential adhesive forces among the cell-species. Accordingly, a continuum model of adhesion was introduced. The model, which consists of fourth-order nonlinear advection-reaction-diffusion equations (of Cahn-Hilliard-type) for the cell-species coupled with reaction-diffusion equations for the substrate components is well-posed and is related to previously developed mixture models for solid tumor growth. We demonstrated analytically and numerically that when the diffuse interface thickness tends to zero, the system reduces to a classical sharp interface model. To solve the equations numerically, we developed a new highly efficient adaptive, nonlinear multigrid/finite difference method. We presented simulations of unstable avascular tumor growth in two and three dimensions and demonstrated that our techniques now make large-scale three dimensional simulations of tumors with complex morphologies computationally feasible. In Part II of this study, we will investigate multispecies tumor invasion, tumor-induced angiogenesis and focus on the morphological instabilities that may underlie invasive phenotypes. In the simulated model, we made several simplifications including the assumption that the tumor and host cells were closely packed and moved with the mass averaged velocity field. We also assumed that viable and tumor cells were indistinguishable from one another from the perspective of cell-cell adhesion and that the adhesion energy depended solely on total tumor volume fraction ?T rather than the individual components directly. We further postulated that the interstitial liquid could be decoupled from the solid cell evolution and that the cells moved with the mass-averaged velocity arising from a generalized Darcy’s law. In the future these assumptions will be relaxed and additional biological aspects will be added. For example, the adhesion energy may not simply depend on ?T but instead on the different tumor species directly. In addition, interstitial fluid transport should be coupled with the motion of cells in a more physical way, as is done in the mixture models by Breward et al. (2003) ; Byrne and King (2003) ; Byrne and Preziosi (2003) ; Araujo and McElwain (2005a) . Additionally, for some cases the treatment of cells as a fluid may be unreasonable, and more realistic models of soft tissue mechanics may be employed. These include elastic, poroelastic and viscoelastic models, e.g. , ( Jones et al., 2000 ; Ambrosi and Mollica, 2002 ; Lubarda and Hoger, 2002 ; Araujo and McElwain, 2004 ; Ben-Amar and Gorielly, 2005 ; Fung, 1990 ; Humphrey, 2003 ; Roose et al., 2003 ; and Please, 2004). These effects may be included in our model by incorporating the relevant energy in the system energy and following the mixture model development by Araujo and McElwain (2005a , b) . The model and numerical methods presented here are capable of describing the effects of biological events such as mutations that select for more malignant cell species, progression of necrosis, tumor response to therapy and tumor-induced angiogenesis in a complex three dimensional environment. It represents a computational tool to study tumor morphological evolution observed experimentally in vitro and in vivo and will enable the modeling of the complex interaction between diffusional instability, invasion of host tissue, vascular development, and drug therapy through all stages of tumor progression in three dimensions.  A Details of thermodynamic consistency of the multi-species mixture model To obtain the constitutive relations for the fluxes J i and the cell-velocities u i , we use an energetic variational approach so that the resulting system (1) is consistent with the second law of thermodynamics. To satisfy the second law of thermodynamics in isothermal systems, it is sufficient to obtain a non-increasing free energy functional since this is equivalent to a non-decreasing entropy. In particular, the Helmholtz free energy E = U ? ? s where U is the internal energy, ? is the temperature and s is the entropy ( e.g. , see ( Rowlinson and Widom, 1982 ; Landau, 1984 )). As in Sec. 2.2, we take the Helmholtz free energy of the system to be of the form E = ? i = 1 N E i , where (A.1) E i = ? ( F i ( ? 0 , … ? N ) + ? j = 0 N ?? ij 2 2 | ? ? j | 2 )    d x . Next, we take the time derivative of E . This is equivalent to varying the functions ? i simultaneously and independently. Using Eq. (1) , assuming the mass-exchange terms S i = 0 and integrating by parts, gives (A.2) dE dt = ? j = 0 N ? { ? j ? ( ? E ? ? j + p? ) · u j + ? ( 1 ? j ? E ? ? j ? 1 ? 0 ? E ? ? 0 + ( 1 ? j ? 1 ? 0 ) p? ) · J j }    d x + boundary terms , where ? E ? ? j = ? i = 0 N ? E i ? ? j , and p? is a Lagrange multiplier (the pressure) that may be introduced since ? j = 0 N ? j = 1 . Further, ? E i ? ? j = ? F i ? ? j ? ? · ( ?? ij 2 ? ? j ) . The boundary terms arise from integrating by parts and using the divergence theorm (for brevity, we do not present them here). Assuming natural boundary conditions, these terms vanish. Next, write (A.3) u j = u + w j ,     p = p? + ? j = 0 N ? j ? E ? ? j , where u is the mass averaged velocity and w j is the deviation from the mass averaged velocity ( i.e. , diffusion velocity). Plugging these into Eq. (A.2) and performing algebraic manipulations, we get (A.4) dE dt = ? ( ? p ? ? j = 0 N ? E ? ? j ? ? j ) · u d x + ? j = 0 N ? ? j ? ( ? E ? ? j ? ? i = 0 N ? i ? E ? ? i + p ) · w j d x + ? j = 0 N ? ? ( 1 ? j ? E ? ? j ? 1 ? 0 ? E ? ? 0 + ( 1 ? j ? 1 ? 0 ) ( p ? ? i = 0 N ? i ? E ? ? i ) ) · J j d x + boundary terms . Assuming now that each term separately is dissipative yields a generalized Fick’s law for the flux (A.5) J i = ? M? i ? ( 1 ? i ? E ? ? i ? 1 ? 0 ? E ? ? 0 + ( 1 / ? i ? 1 / ? 0 ) ( p ? ? j = 0 N ? j ? E ? ? j ) ) , i ? 1 , where M? i is a positive-definite matrix representing the diffusive mobility of the i th component, and velocity (A.6) u i = ? ( k? + k? i ) ? p + k? ? j = 0 N ? E ? ? j ? ? j ? k? i ? ( ? E ? ? i ? ? j = 0 N ? j ? E ? ? j ) , i ? 0 , where k? , k? i are non-negative cell motilities that reflect the response of the average and individual motions of cells to pressure and adhesive forces. Recall that J 0 = ? ? i = 1 N J i from Eq. (2) . The accompanying energy dissipation is (A.7) d dt E = ? ? 1 k? | u | 2 + ? j = 0 N ( ? j k? j | w j | 2 + 1 M? j | J j | 2 )   dx + boundary terms , where u = ? k? ( ? p ? ? j = 0 N ? E ? ? j ? ? j )   and   w j = ? k? j ? ( ? E ? ? j ? ? i = 0 N ? i ? E ? ? i + p ) . To accomodate a scenario in which the water volume fraction is constant and hence the total solid volume fraction is constant, the previous analysis and constitutive relations presented requires modification. We assume ?0 = ??W constant and ? j = 1 N ? j = ?? S = 1 ? ?? W . We may rewrite the time derivative of the energy in Eq. (A.2) as (A.8) dE dt = ? ? 0 ? ( ? E ? ? 0 + q ) · u 0 d x + ? j = 1 N ? { ? j ? ( ? E ? ? j + p? ) · u j + ? ( 1 ? j ? E ? ? j ? 1 ? 0 ? E ? ? 0 + p? ? j ? q ? 0 ) · J j }    d x + boundary terms , where q and p? are Lagrange multipliers, the liquid and solid pressure respectively, that enforce the two constraints on the volume fractions. We then write (A.9) u j = u S + w j ,    for  j ? 1 ,     p = ?? S p? + ? j = 1 N ? j ? E ? ? j , where u S is the mass averaged velocity of the solid fractions, i.e. , (A.10) u S = ? i = 1 N ? i ? i u i ? i = 1 N ? i ? i , and w j is the deviation from the solid fraction mass averaged velocity. Plugging these into Eq. (A.8) and performing algebraic manipulations, we get (A.11) dE dt = ? ? 0 ? ( ? E ? ? 0 + q ) · u 0 d x + ? ( ? p ? ? j = 1 N ? E ? ? j ? ? j ) · u S d x + ? j = 1 N ? ? j ? ( ? E ? ? j ? 1 ?? S ? i = 1 N ? i ? E ? ? i + p ?? S ) · w j d x + ? j = 1 N ? ? ( 1 ? j ? E ? ? j ? 1 ? 0 ? E ? ? 0 + 1 ?? S ? j ( p ? ? i = 1 N ? i ? E ? ? i ) ? q ? 0 ) · J j d x + boundary terms . Assuming now that each term separately is dissipative yields the following thermodynamically consistent constitutive relations: (A.12) u 0 = ? k? 0 ? ( ? E ? ? 0 + q ) , (A.13) u S = ? k? ( ? p ? ? j = 1 N ? E ? ? j ? ? j ) , (A.14) w j = ? k? j ? ( ? E ? ? j ? 1 ?? S ? i = 1 N ? i ? E ? ? i + p ?? S ) , j ? 1 , (A.15) J j = ? M? j ? ( 1 ? j ? E ? ? j ? 1 ? 0 ? E ? ? 0 + 1 ?? S ? j ( p ? ? i = 1 N ? i ? E ? ? i ) ? q ? 0 ) , j ? 1 , where k? 0, k? , k? j and M? j are positive definite matrices and J 0 = ? ? j = 1 N J j . Note that both the solid and water pressures appear in the mechanical fluxes J j and thus the solid and water phases couple. The energy dissipation here is analogous to that in Eq. (A.7) . We can further simplify the problem if we assume that there is no mechanical flux of the water, i.e. , J 0 = 0, and thus ? j = 1 N J j = 0 . In this case, arguing similarly as above, we obtain the constitutive relation for the mechanical fluxes: (A.16) J j = ? M? j ? ( 1 ? j ? E ? ? j ? 1 ? N ? E ? ? N + 1 ?? S ( p ? ? i = 1 N ? i ? E ? ? i ) ( 1 ? j ? 1 ? N ) ) , for 1 ? j ? N ? 1 and J N = ? ? j = 1 N ? 1 J j . Taking ? j = ? and absorbing ? in into M? j yields the results in Sec. 2.3.  B Details of the sharp-interface matched asymptotic expansions The method of matched asymptotic expansions can be used to show the formal convergence of solutions of the diffuse interface model (43) – (53) , in the limit as ? ? 0, to those of the classical sharp interface model given in Sec. 3.6. Briefly, the method is as follows ( e.g. , see ( Pego, 1989 ; Lee et al., 2002 ) for details). Assume that at time t = 0, there is a smooth transition layer of width ? separating the tumor and host domains. In ?T, ?T ? 1 and in ?H, ?T ? 0, which are the wells of the nondimensional local interaction energy. Let ?T be a curve centered in the transition layer. The idea is to expand ?T, u S, p and n in powers of ? both away from the transition layer (outer expansion), i.e. , (B.1) ? T ( x , y , z , t ) = ? T ( 0 ) ( x , y , z , t ) + ? ? T ( 1 ) ( x , y , z , t ) + ? 2 ? T ( 2 ) ( x , y , z , t ) + ? , (B.2) u S ( x , y , z , t ) = u S ( 0 ) ( x , y , z , t ) + ? u S ( 1 ) ( x , y , z , t ) + ? 2 u S ( 2 ) ( x , y , z , t ) + ? , (B.3) p ( x , y , z , t ) = 1 ? p ( ? 1 ) ( x , y , z , t ) + p ( 0 ) ( x , y , z , t ) + ? p ( 1 ) ( x , y , z , t ) + ? , (B.4) n ( x , y , z , t ) = n ( 0 ) ( x , y , z , t ) + ? n ( 1 ) ( x , y , z , t ) + ? , and inside the transition region (inner expansion). In the inner expansion, a stretched local coordinate system (with respect to ?T) is used. Let the interface be represented by ?T( t ) = {?( x, y, z, t ) = 0}, where ?( x, y, z, t ) is a signed distance function which measures the distance to the interface (? < 0 denotes the ?T region). Introduce the stretched local coordinates ( x?, ?, ? ) where ( x?, ? ) denote tangential coordinates in ?T and ? = ?/?. We assume u S = ??1 t 1 + ??2 t 2 + ? ? where ??1, ??2 and ? are the components of the cell-velocity in the tangential and normal directions to the interface. We then take the inner expansions: (B.5) ?? 1 , 2 ( x? , ? , ? , t ) = ?? 1 , 2 ( x? , ? , ? , t ) ( 0 ) + ? ?? 1 , 2 ( 0 ) ( x? , ? , ? , t ) + ? 2 ?? 1 , 2 ( 2 ) ( x? , ? , ? , t ) + ? (B.6) ? ( x? , ? , ? , t ) = ? ( 0 ) ( x? , ? , ? , t ) + ? ? ( 1 ) ( x? , ? , ? , t ) + ? 2 ? ( 2 ) ( x? , ? , ? , t ) + ? (B.7) p? ( x? , ? , ? , t ) = 1 ? p? ( ? 1 ) ( x? , ? , ? , t ) + p? ( 0 ) ( x? , ? , ? , t ) + ? p? ( 1 ) ( x? , ? , ? , t ) + ? (B.8) n? ( x? , ? , ? , t ) = n? ( 0 ) ( x? , ? , ? , t ) + ? n? ( 1 ) ( x? , ? , ? , t ) + ? By substituting these expansions into the equations, introducing the appropriate coordinate transformations of the differential operators in the inner region and matching powers of ?, the field equations may be determined in the ? ? 0 limit. By evaluating the outer and inner expansions in a region near the edge of the transition layer where both expansions are valid and matching the results, the sharp interface jump conditions may be recovered. At order 1/?, we find that p ?1 is constant in both ?T and ?H. From the inner expansion, and the matching condition, we conclude that p (?1) is the same constant in each domain and thus does not contribute to the velocity. At the next order in ?, ( e.g. , ?0), the solutions of the diffuse interface system satisfy ? T ( 0 ) = 1 in ?T and ? T ( 0 ) = 0 in ?H. Further, the other order ?0 variables satisfy the sharp interface system given in Sec. 3.6. 