Cardiac Motion Recovery via Active Trajectory Field Models Cardiovascular researchers are constantly developing new and innovative medical imaging technologies, striving to improve the understanding, diagnosis, and treatment of cardiovascular dysfunction. Combining these sophisticated imaging methods with advancements in image understanding via computational intelligence will continue to advance the frontier of cardiovascular medicine. Recently, researchers have turned to a new class of tissue motion imaging techniques, including displacement encoding with stimulated echoes (DENSE) in cardiac magnetic resonance (cMR) imaging, to directly quantify cardiac displacement and produce accurate spatiotemporal measurements of myocardial strain, twist, and torsion. The associated analysis of DENSE cMR and other tissue motion imagery, however, represents a major bottleneck in the study of intra-myocardial mechanics. In the computational intelligence area of deformable models, this paper develops an automated motion recovery technique termed active trajectory field models (ATFMs) geared towards these new motion imaging protocols, offering quantitative physiological measurements without the pains of manual analyses. This novel generative deformable model exploits both image information and prior knowledge of cardiac motion, utilizing a point distribution model derived from a training set of myocardial trajectory fields to automatically recover cardiac motion from a noisy image sequence. The effectiveness of the ATFM method is demonstrated by quantifying myocardial motion in 2D short-axis murine DENSE cMR image sequences both before and after myocardial infarction, producing results comparable to existing semi-automatic analysis methods.  I. Introduction Modern cardiovascular science boasts a rich array of imaging technology within the suite of medical imaging modalities, providing vital physiological insights which aid in the understanding, diagnosis, and treatment of cardiovascular dysfunction. Each imaging technology affords an opportunity to develop associated image analysis software, which strives to automatically quantify cardiac parameters and produce results comparable to existing manual methods while alleviating researchers and clinicians from tedious, time-consuming, and highly variable manual data analyses. As new and more sophisticated imaging techniques are under constant development, automated cardiovascular image analysis will remain an important and vigorous area of research in computational intelligence for many years to come. One of the most important cardiovascular imaging modalities today is of course cardiac magnetic resonance (cMR) imaging. cMR techniques already offer a wealth of cardiac measurements, including ejection fraction, myocardial mass, myocardial wall thickening, and cardiac perfusion. A promising addition to the cMR toolbox is found in the study of intra-myocardial function, which attempts to quantify tissue motion throughout the cardiac muscle and produce accurate spatiotemporal measurements of myocardial strain, twist, and torsion. Consequently, many cMR researchers have turned to quantitative tissue tracking techniques, such as myocardial tagging [ 1 - 3 ], velocity-encoded phase contrast imaging [ 4 , 5 ], harmonic phase (HARP) analysis [ 6 ], and the more recent displacement encoding with stimulated echoes (DENSE) [ 7 - 10 ], to potentially advance our current understanding of basic cardiovascular science. Of particular interest is cine DENSE cMR, which offers direct measurement of tissue displacement at a high spatial resolution throughout the course of the cardiac cycle [ 10 ]. A recent cine DENSE cMR protocol for murine imaging by Zhong et al [ 11 ] achieves spatial and temporal resolutions of 0.2 × 0.2 × 1 mm3 and 6.9 ms, respectively, in a scan time of 6-8 minutes per slice. Even higher resolutions are possible with this imaging technique, albeit at the cost of increased scan time. DENSE cMR presents a clear opportunity in computational intelligence for the development of novel automated analysis software, as extracting meaningful tissue motion from acquired imagery remains a complex task requiring significant manual interaction [ 10 ]. Though existing medical image analysis methods were considered [ 12 - 14 ] in the context of DENSE cMR, it was deemed necessary to develop an application specific algorithm capable of the automatic recovery of meaningful left-ventricular motion from acquired DENSE cMR image sequences. In this paper, we consider the automated analysis of acquired tissue motion imagery via a novel generative deformable modeling technique we term active trajectory field models (ATFMs). ATFMs are within a class of methods known in the computational intelligence community as deformable models , which include active contours [ 12 ], active shape/appearance models [ 13 , 14 ], active surfaces [ 15 ], and splines [ 16 ]. The ATFM method introduced here exploits both image information and prior knowledge of the cardiac motion we wish to recover, using a training set of myocardial trajectory fields to automatically recover tissue motion from a noisy image sequence. This technique is able to eliminate our dependence on finite element approximations of complex biomechanical models by instead deriving a myocardial motion model directly from real world training data. As with active shape/appearance models, the ATFM technique relies on our ability to represent a motion trajectory field as a discrete set of spatiotemporal points. After choosing points in the same manner from every trajectory field within a training set of fields, we can examine the statistics of these labeled point positions and develop a point distribution model describing how the spatiotemporal locations vary. We are then able to move about in this model space by varying a small number of parameters associated with the modes of variation within the training data. To automatically recover motion from a noisy image sequence, we must choose parameter values that best fit model to noisy imagery. The development of the ATFM motion recovery technique is wrought with challenges, including the preliminary semi-automatic analysis of a training set of complex spatiotemporal trajectory fields, the characterization of variability within the training set, and a solution to a combinatorial optimization problem of searching for the trajectory field of best fit to a noisy image sequence. As DENSE cMR resolutions are well suited for studies that use imaging of transgenic mice to elucidate the roles of individual genes in contractile function, we focus our efforts on left ventricular motion recovery within 2D short-axis murine cine DENSE cMR imagery, discussed in detail in the next section. Though we concentrate on the analysis of this single imaging technique, the ATFM method can be adapted to 2D human DENSE cMR imagery (differing primarily in scale and resolution), other displacement data such as myocardial tagging (differing primarily in resolution), as well as 3D DENSE cMR motion recovery (requiring an extension to 3D space and 3D displacements) In the next section, we present necessary background information including an in-depth discussion of a state-of-the-art DENSE cMR analysis, as well as an introduction to deformable models and their application to cardiac segmentation problems. We then develop the proposed ATFM method in detail, including a novel preliminary semi-automatic training set analysis, model definition, and the final automated motion field recovery. We demonstrate the effectiveness of the ATFM method by quantifying myocardial motion in 2D short-axis murine DENSE cMR image sequences both before and after myocardial infarction.  II. Background This section presents two topics essential to the proposed research: a discussion on the typical cine DENSE cMR image analysis method, and a short review of deformable models for cardiac segmentation. A. Typical Cine DENSE cMR Analysis A typical magnetic resonance (MR) acquisition consists of a complex valued dataset, and conventionally researchers and clinicians discard all phase information and make use of the magnitude information only. DENSE cMR, however, exploits this phase space by directly encoding tissue displacement into the phase-reconstructed images [ 7 ]. DENSE cMR first uses a spatial magnetic field gradient to impart a location-dependent phase shift to the MR signal at the initial cardiac configuration. A similar gradient is applied at subsequent cardiac configurations such that, if no displacement occurred, the initial imparted phase shift would be removed. Any residual phase shift remaining after application of the second gradient pulse directly reflects tissue displacement that occurred during the time between the two gradient pulses. A more detailed discussion of the cine DENSE cMR acquisition method, beyond the scope of this article, can be found in [ 8 ]. Fig. 1 illustrates a typical single-frame DENSE cMR acquisition and analysis. We acquire complex DENSE cMR imagery consisting of magnitude ( Fig. 1b ) and phase ( Fig. 1c ) information, where phase is directly proportional to displacement in a single direction. In this example, phase is encoded in the horizontal direction. A similar procedure produces phase imagery encoded in the vertical direction (not shown). Let us now briefly consider the typical transformation of a 2D+time DENSE cMR image acquisition into meaningful tissue motion as described by Spottiswoode et al . [ 10 ]. As MR phase is inherently bounded between –? and ?, large displacements produce wrapping artifacts, visible at the 3 o'clock position in Fig. 1c . This wrapping effect is corrected by a two-dimensional phase unwrapping technique described in [ 17 ], known as quality-guided path following . This technique unwraps the phase image one pixel at a time along a 2D path guided by the phase quality image, proportional to the variance of the partial derivatives of the locally unwrapped phase within a small neighborhood around each pixel. Fig. 1d illustrates unwrapped phase values within the myocardial region of interest, where dark pixels represent movement to the left and bright pixels represent movement to the right. After unwrapping the vertically encoded phase image (not shown) via a similar procedure, the associated horizontal and vertical displacements are combined to obtain the displacement field illustrated in Fig. 1e . This field consists of noisy vectors with heads located at pixel centers and tails located at the pixel points of origin. A series of these single frame displacement fields measured over the course of the cardiac cycle is concatenated to recover a meaningful myocardial trajectory field, as illustrated in Fig. 2 . This generally involves spatial filtering, linear interpolation to determine frame-to-frame motion, measurement of coarse trajectories using these frame-to-frame vectors, and temporal smoothing of the coarse trajectories via Fourier basis functions. To gain more insight into myocardial function, strain can be directly calculated from the recovered trajectory fields according to the method described in [ 18 ]. Consider a single trajectory [ x 0 ( t ), y 0 ( t )] and its nearest neighbor [ x 1( t ), y 1( t )] defined by the Euclidean distance between spatial origins. We define the distance between these points at an arbitrary time t as (1) d x ( t ) = [ x 1 ( t ) ? x 0 ( t ) y 1 ( t ) ? y 0 ( t ) ] . A two-dimensional deformation gradient tensor F ( t ) , of size [2×2], maps vectors from the original configuration d x (0) to the current configuration d x ( t ) and is defined as (2) d x ( t ) = F ( t ) ? d x ( 0 ) . Given a trajectory with at least two neighbors, F ( t ) can be determined via a least squares technique. The associated LaGrangian strain tensor S ( t ) , of size [2×2], is given as (3) S ( t ) = 1 2 [ F ( t ) T F ( t ) ? I ] . where I is the identity matrix. This 2D Cartesian strain tensor is typically decomposed into its radial and circumferential components, pointing towards the myocardial center and along the circumference of the myocardium, respectively. Fig. 3 illustrates typical end-systolic (full cardiac contraction) strain fields. Note that the average end-systolic radial strain of approximately 0.35 and average end-systolic circumferential strain of approximately -0.15 are in good agreement with previous measurements of strain in the mouse heart [ 9 , 19 ]. Though this state-of-the-art analysis method provides revealing myocardial trajectory fields, it does suffer from several distinct disadvantages. It first requires a significant amount of user input, as the left ventricle must be manually delineated on at least one frame, and the phase unwrapping algorithm performance is improved when the left ventricle is delineated on all frames. In our lab, manual myocardial segmentation within a typical murine DENSE cMR acquisition of 30 frames may take 5-10 minutes. Performing this segmentation on multiple data sets quickly becomes monotonous and time consuming. Manual segmentation is especially problematic early in the cardiac cycle, as blood encoded with the DENSE cMR pulse sequence remains in the blood pool, virtually eliminating myocardial contrast. Additionally, little effort is directed towards noise compensation among the displacement vectors beyond some spatial filtering and an individual temporal fit to each trajectory. There is a clear opportunity for a more automated solution via advances in computational intelligence. B. Deformable Models for Cardiac Segmentation One of the most successful classes of medical image segmentation methods, termed deformable models , attempts to exploit both image information and prior knowledge of the anatomical structure to be delineated. Here, we will consider some of the most relevant prior research on deformable models for myocardial segmentation. The popularization of deformable models for image segmentation is commonly attributed to the introduction of active contours by Kass et al . [ 12 ]. An active contour captures a desired image feature by minimizing a corresponding energy functional, typically the weighted sum of an image-based external energy , attracting the contour to features of interest, and a contour-based internal energy , ensuring a smooth segmentation solution. While active contours have been utilized for cardiac segmentation by a number of researchers [ 20 - 22 ], this method does not allow for the inclusion of any known size, shape, or appearance information. Cootes et al . [ 13 ] introduced a technique termed active shape models (ASMs) that integrates an expected feature shape into the deformable model framework. An ASM measures the variability of a set of training shapes via principle component analysis (PCA), and constrains the segmentation solution to this shape space. Given the proper training set, the corresponding model is able to encapsulate all shape variability within a small subset of principle component weighting parameters. The ASM technique has been used successfully to delineate a number of different anatomical shapes including the myocardium [ 13 , 23 ], but the location of anatomical features with ASM is driven by often spurious low-level image features. To improve their segmentation results, Cootes et al . [ 14 ] introduced an extension to the ASM technique termed active appearance models (AAMs). This technique considers not only the expected object shape, but also the expected pattern of intensity or color in and around the object termed the object appearance . AAMs belong to a subclass of deformable models termed generative deformable models , as we can generate a synthetic image corresponding to any shape and appearance within the model space. Segmentation via this method proceeds via analysis-by-synthesis , finding the set of model parameters that minimizes the difference between noisy imagery and model-derived synthetic imagery. AAM techniques have shown significant promise in the segmentations of a wide range of cardiac imagery [ 24 - 27 ]. Unfortunately, the aforementioned algorithms are ill-suited to the analysis of cardiac displacement imagery such as DENSE cMR. Myocardial edge contrast is nonexistent early in the cardiac cycle, causing purely edge-based segmentation methods such as active contours and ASMs to fail or require significant correction. AAMs show more promise as they could consider the entire myocardial muscle appearance rather than just the myocardial borders, however we would still require the complex displacement analysis methods discussed in the previous section to recover meaningful myocardial motion from the segmentation solution. We therefore endeavor to create a novel motion recovery method geared specifically to tissue motion imagery. Of particular interest is the concept of a generative deformable model, as it is a relatively simple matter to generate ideal DENSE cMR phase imagery from a given trajectory field. We hypothesize that it is possible to characterize the variability of a set of training trajectory fields, and then recover cardiac motion via an analysis-by-synthesis technique that minimizes the difference between ideal phase imagery and a noisy DENSE cMR sequence. The ATFM approach described in this paper accomplishes this goal, developing a novel generative deformable model to recover cardiac motion in tissue motion imagery that exploits known intra-myocardial spatiotemporal variability.  A. Typical Cine DENSE cMR Analysis A typical magnetic resonance (MR) acquisition consists of a complex valued dataset, and conventionally researchers and clinicians discard all phase information and make use of the magnitude information only. DENSE cMR, however, exploits this phase space by directly encoding tissue displacement into the phase-reconstructed images [ 7 ]. DENSE cMR first uses a spatial magnetic field gradient to impart a location-dependent phase shift to the MR signal at the initial cardiac configuration. A similar gradient is applied at subsequent cardiac configurations such that, if no displacement occurred, the initial imparted phase shift would be removed. Any residual phase shift remaining after application of the second gradient pulse directly reflects tissue displacement that occurred during the time between the two gradient pulses. A more detailed discussion of the cine DENSE cMR acquisition method, beyond the scope of this article, can be found in [ 8 ]. Fig. 1 illustrates a typical single-frame DENSE cMR acquisition and analysis. We acquire complex DENSE cMR imagery consisting of magnitude ( Fig. 1b ) and phase ( Fig. 1c ) information, where phase is directly proportional to displacement in a single direction. In this example, phase is encoded in the horizontal direction. A similar procedure produces phase imagery encoded in the vertical direction (not shown). Let us now briefly consider the typical transformation of a 2D+time DENSE cMR image acquisition into meaningful tissue motion as described by Spottiswoode et al . [ 10 ]. As MR phase is inherently bounded between –? and ?, large displacements produce wrapping artifacts, visible at the 3 o'clock position in Fig. 1c . This wrapping effect is corrected by a two-dimensional phase unwrapping technique described in [ 17 ], known as quality-guided path following . This technique unwraps the phase image one pixel at a time along a 2D path guided by the phase quality image, proportional to the variance of the partial derivatives of the locally unwrapped phase within a small neighborhood around each pixel. Fig. 1d illustrates unwrapped phase values within the myocardial region of interest, where dark pixels represent movement to the left and bright pixels represent movement to the right. After unwrapping the vertically encoded phase image (not shown) via a similar procedure, the associated horizontal and vertical displacements are combined to obtain the displacement field illustrated in Fig. 1e . This field consists of noisy vectors with heads located at pixel centers and tails located at the pixel points of origin. A series of these single frame displacement fields measured over the course of the cardiac cycle is concatenated to recover a meaningful myocardial trajectory field, as illustrated in Fig. 2 . This generally involves spatial filtering, linear interpolation to determine frame-to-frame motion, measurement of coarse trajectories using these frame-to-frame vectors, and temporal smoothing of the coarse trajectories via Fourier basis functions. To gain more insight into myocardial function, strain can be directly calculated from the recovered trajectory fields according to the method described in [ 18 ]. Consider a single trajectory [ x 0 ( t ), y 0 ( t )] and its nearest neighbor [ x 1( t ), y 1( t )] defined by the Euclidean distance between spatial origins. We define the distance between these points at an arbitrary time t as (1) d x ( t ) = [ x 1 ( t ) ? x 0 ( t ) y 1 ( t ) ? y 0 ( t ) ] . A two-dimensional deformation gradient tensor F ( t ) , of size [2×2], maps vectors from the original configuration d x (0) to the current configuration d x ( t ) and is defined as (2) d x ( t ) = F ( t ) ? d x ( 0 ) . Given a trajectory with at least two neighbors, F ( t ) can be determined via a least squares technique. The associated LaGrangian strain tensor S ( t ) , of size [2×2], is given as (3) S ( t ) = 1 2 [ F ( t ) T F ( t ) ? I ] . where I is the identity matrix. This 2D Cartesian strain tensor is typically decomposed into its radial and circumferential components, pointing towards the myocardial center and along the circumference of the myocardium, respectively. Fig. 3 illustrates typical end-systolic (full cardiac contraction) strain fields. Note that the average end-systolic radial strain of approximately 0.35 and average end-systolic circumferential strain of approximately -0.15 are in good agreement with previous measurements of strain in the mouse heart [ 9 , 19 ]. Though this state-of-the-art analysis method provides revealing myocardial trajectory fields, it does suffer from several distinct disadvantages. It first requires a significant amount of user input, as the left ventricle must be manually delineated on at least one frame, and the phase unwrapping algorithm performance is improved when the left ventricle is delineated on all frames. In our lab, manual myocardial segmentation within a typical murine DENSE cMR acquisition of 30 frames may take 5-10 minutes. Performing this segmentation on multiple data sets quickly becomes monotonous and time consuming. Manual segmentation is especially problematic early in the cardiac cycle, as blood encoded with the DENSE cMR pulse sequence remains in the blood pool, virtually eliminating myocardial contrast. Additionally, little effort is directed towards noise compensation among the displacement vectors beyond some spatial filtering and an individual temporal fit to each trajectory. There is a clear opportunity for a more automated solution via advances in computational intelligence.  B. Deformable Models for Cardiac Segmentation One of the most successful classes of medical image segmentation methods, termed deformable models , attempts to exploit both image information and prior knowledge of the anatomical structure to be delineated. Here, we will consider some of the most relevant prior research on deformable models for myocardial segmentation. The popularization of deformable models for image segmentation is commonly attributed to the introduction of active contours by Kass et al . [ 12 ]. An active contour captures a desired image feature by minimizing a corresponding energy functional, typically the weighted sum of an image-based external energy , attracting the contour to features of interest, and a contour-based internal energy , ensuring a smooth segmentation solution. While active contours have been utilized for cardiac segmentation by a number of researchers [ 20 - 22 ], this method does not allow for the inclusion of any known size, shape, or appearance information. Cootes et al . [ 13 ] introduced a technique termed active shape models (ASMs) that integrates an expected feature shape into the deformable model framework. An ASM measures the variability of a set of training shapes via principle component analysis (PCA), and constrains the segmentation solution to this shape space. Given the proper training set, the corresponding model is able to encapsulate all shape variability within a small subset of principle component weighting parameters. The ASM technique has been used successfully to delineate a number of different anatomical shapes including the myocardium [ 13 , 23 ], but the location of anatomical features with ASM is driven by often spurious low-level image features. To improve their segmentation results, Cootes et al . [ 14 ] introduced an extension to the ASM technique termed active appearance models (AAMs). This technique considers not only the expected object shape, but also the expected pattern of intensity or color in and around the object termed the object appearance . AAMs belong to a subclass of deformable models termed generative deformable models , as we can generate a synthetic image corresponding to any shape and appearance within the model space. Segmentation via this method proceeds via analysis-by-synthesis , finding the set of model parameters that minimizes the difference between noisy imagery and model-derived synthetic imagery. AAM techniques have shown significant promise in the segmentations of a wide range of cardiac imagery [ 24 - 27 ]. Unfortunately, the aforementioned algorithms are ill-suited to the analysis of cardiac displacement imagery such as DENSE cMR. Myocardial edge contrast is nonexistent early in the cardiac cycle, causing purely edge-based segmentation methods such as active contours and ASMs to fail or require significant correction. AAMs show more promise as they could consider the entire myocardial muscle appearance rather than just the myocardial borders, however we would still require the complex displacement analysis methods discussed in the previous section to recover meaningful myocardial motion from the segmentation solution. We therefore endeavor to create a novel motion recovery method geared specifically to tissue motion imagery. Of particular interest is the concept of a generative deformable model, as it is a relatively simple matter to generate ideal DENSE cMR phase imagery from a given trajectory field. We hypothesize that it is possible to characterize the variability of a set of training trajectory fields, and then recover cardiac motion via an analysis-by-synthesis technique that minimizes the difference between ideal phase imagery and a noisy DENSE cMR sequence. The ATFM approach described in this paper accomplishes this goal, developing a novel generative deformable model to recover cardiac motion in tissue motion imagery that exploits known intra-myocardial spatiotemporal variability.  III. Methods This section presents an in-depth description of the proposed ATFM technique, towards the goal of automated motion recovery from tissue displacement imagery. The ATFM method defines a point distribution model characterizing the variability of spatiotemporal myocardial landmarks within a training set of discrete trajectory fields, and then automatically recovers motion from a noisy image sequence by finding the best fit of model to imagery. The development of this method is not a trivial task, as we must consider the preliminary semi-automatic analysis of a training set of DENSE cMR image sequences, a characterization of variation within recovered trajectory field training set, and a solution to the combinatorial optimization problem of searching a noisy image sequence for the trajectory field of best fit. As previously mentioned, though we focus our efforts on murine DENSE cMR imagery, the ATFM method can be adapted to human data, other tissue motion imaging techniques, as well as 3D motion recovery. A. Training set analysis The current state-of-the-art DENSE cMR motion recovery method discussed in Section II.A does not lend itself to the construction of our cardiac point distribution model, as each heart in the training set is sampled at a unique set of spatiotemporal locations. To address this concern, as well improve noise compensation within the acquired datasets, we introduce a novel semi-automatic DENSE cMR analysis method. This method defines a smooth and continuous myocardial trajectory field via two spatiotemporal splines, given phase-unwrapped image sequences and expertly delineated myocardial contours. Note that this novel semi-automatic training set analysis is only a stepping stone towards the fully automated ATFM solution discussed in subsequent sections. Consider deformation in a single direction. Let { z n , n ? [1... N ]} represent the finite set of N irregularly spaced spatiotemporal deformations at the Cartesian coordinates ( x n , y n ) ? ? and at temporal locations t n ? [0...1] (varying from the start to the end of the cardiac cycle, respectively). We define the function f ( x , y , t ) as the unique solution that minimizes (4) E s p l i n e ( f ) = ? 1 ? 0 1 [ ? ? ( f x x 2 + 2 f x y 2 + f y y 2 ) d x d y ] d t + ? 2 ? ? [ ? 0 1 f t t 2 d t ] d x d y + ( 1 ? ? 1 ? ? 2 ) ? ? n = 1 N ? z n ? f ( x n , y n , t n ) ? . where (?1,?2) ? [0...1] define the relative weight between energy terms and f dd is the second derivative of f ( x , y , t ) in the direction d . We apply an additional boundary constraint to our solution that forces trajectories to begin and end at their respective spatial origins by requiring zero valued deformations at these temporal locations. The first energy term in (4) is derived from a 2D thin plate spline [ 16 , 28 ], the 2D analog of the 1D cubic spline. This term quantifies the spatial bending energy at each temporal location in the function f ( x , y , t ) , ensuring a spatially smooth deformation field. The second energy term is derived from a one-dimensional cubic spline [ 16 ]. This term quantifies the temporal curvature of our solution, i.e. the sum of squared acceleration across time within the spatial region of interest, ensuring a temporally smooth deformation field when minimized. Our energy functional also includes an L2-norm data constraint, forcing the solution towards the least-squares approximation of the input deformations. Minimizing the weighted sum of these three energy terms produces a spatially and temporally smooth solution that closely matches the input deformation data. We note that although (4) could be formulated in the L1-norm sense, the range and variability of noise present in the displacement data has lent itself to an L2-norm minimization scheme. To ensure we do not over smooth and lose local tissue motion features, our choice of ?1 and ?2 is governed by the cross-validation technique described in [ 29 ]. We divide our entire training set of displacement fields into estimation data and validation data, choosing D random displacements from each field as the validation data. We then search the parameter space for the spatiotemporal splines derived from the estimation data that best fit the validation data. Fig. 4 illustrates a typical spatiotemporal spline fit. The top row shows the original displacement fields, and the bottom row shows the corresponding spline deformation fields. We can additionally calculate strain fields by discretizing this continuous trajectory field and using the method described in Section II.A, as illustrated in Fig. 5 . B. Model definition With a training set of continuous spatiotemporal trajectory fields in hand, we may now consider the construction of a trajectory field model for subsequent motion recovery [ 30 ]. This is a three step process, wherein we align the training data to a single reference coordinate system, discretize each continuous trajectory field at the same set of myocardial landmarks and cardiac phases, and define a point distribution model that measures the variability among these discrete trajectory fields via PCA. Let us first consider training data alignment. The center of each resting heart within the training set lies at a different spatial location within its respective image acquisition space. Additionally, each resting heart has a different orientation with respect to this center. Finally, two hearts that differ in size may still exhibit the same motion characteristics. To more accurately characterize motion variability within the training set, we eliminate these differences in cardiac position, orientation, and scale by aligning each resting heart to a single reference coordinate system. We refer to the resulting aligned trajectory field as normalized . As it is difficult to manually delineate the myocardium in DENSE cMR imagery early in the cardiac cycle, we define the resting heart by projecting expert drawn contours and features (right ventricle insertion points, see Fig. 1a ) from the frame of greatest myocardial contrast back to their resting positions via the spatiotemporal spline definition. Alignment of this resting configuration is achieved via a Procrustes analysis [ 13 , 31 ], with respect to a reference myocardium centered at the spatial origin with right-ventricle insertion points aligned to the vertical axis and unity epicardial radius. Fig. 6 illustrates a typical alignment, transforming a resting configuration and motion field ( Fig. 6a-b ) to the reference coordinate system ( Fig. 6c-d ). To aid visualization, the right ventricle insertion points are marked as squares. After alignment, the next challenge in model construction is the spatial and temporal discretization of each trajectory field within the training set using an identical set of myocardial- landmarks. To elaborate, if trajectory #10 in the first training field corresponds to the anterior right ventricle insertion point, trajectory #10 in all training fields must correspond to the same anterior right ventricle insertion point. We achieve this trajectory matching by mapping a sampling template to the aligned resting myocardial definition, and recovering the discrete trajectories associated with each of these spatial origins. Fig. 7 illustrates this procedure, using a sampling template ( Fig. 7a ) to sample the normalized resting myocardial definition ( Fig. 7b ) and produce a discrete set of resting spatial locations ( Fig. 7c ) and a corresponding trajectory field ( Fig. 7d ). Temporal discretization is achieved by sampling each training trajectory field at a known set of cardiac phases. Given the set of normalized discrete training trajectory fields, we are able to characterize the data variability via principal component analysis (PCA). Let X ijk = [ x ijk , y ijk ] represent the x - y position of the i th trajectory at the j th cardiac phase of the k th normalized trajectory field, where i ? [1... Ni ] , j ? [1... Nj ] , and k ? [1... Nk ] . We vectorize the k th trajectory field as (5) ? k = [ X 1 , 1 , k , X 2 , 1 , k , … , X N i , 1 , c ? Phase 1 , … … X 1 , j , k , … , X N i , j , k , ? Phase j … , X 1 , N j , k , … , X N i , N j , k ? Phase Nj ] T , of size [(2 · Ni · Nj ) × 1] . The average normalized trajectory field is defined as (6) ? ? = 1 N k ? k = 1 N k ? k , and the sample distribution covariance matrix is defined by (7) C o v = 1 N k ? k = 1 N k ( ? k ? ? ? ) ? ( ? k ? ? ? ) T . The eigenvectors P of the covariance matrix define the modes of variation within the training set, and the corresponding eigenvalues describe the relative significance of each mode. The percentage of variation accounted for by each eigenvector is defined as the corresponding eigenvalue divided by the sum of all eigenvalues. We can recover any normalized trajectory field within the training set by a linear combination of the average normalized trajectory field with the modes of variation. Moreover, we can approximate any normalized trajectory field within the training data by a linear combination of the average normalized trajectory field with the most significant eigenvectors, termed principle components, as in (8) M k ? M ? + P ^ ? b ^ k , where P? is a subset of the modes of variation P , and b? k is set of weighting coefficients corresponding to the k th trajectory field. In practice, we define an amount of variation we wish to approximate (e.g. 95% variation), and use the principle components that account for this level of variation. These principle components of variation, combined with a rotation, translation, and scale to transform the normalized trajectory fields back to the image space of a new DENSE cMR sequence, define our trajectory field model. We are able to achieve any trajectory field within the search space by varying a small number of parameters, i.e. the principle component weights, orientation, translation, and scale. C. ATFM motion recovery Given the aforementioned model space definition, we are able to attempt the automatic recovery of cardiac motion from a newly acquired DENSE cMR sequence. In this section, we will first consider the search criterion which defines the best match between trajectory field and noisy imagery. We then discuss our method of attack to solve the combinatorial optimization problem of locating the best match within the model search space. We measure the correspondence between a given trajectory field and a noisy image sequence via an analysis-by-synthesis technique. Given any myocardial trajectory field, one can synthesize a set of “ideal” DENSE cMR values which represent the noise-free DENSE cMR data that would have produced the trajectory field in question. This is accomplished by measuring displacement from the spatial origin for each trajectory at each phase of the cardiac cycle, and scaling according to the DENSE cMR encoding parameter. Let ? = {[ x n ( t ), y n ( t )], n ? [1... N ]} represent a set of N temporally continuous trajectories. The ideal DENSE cMR value corresponding to each trajectory at some time t are defined as (9) I ^ n x ( t ) = k e ? [ x n ( t ) ? x n ( 0 ) ] I ^ n y ( t ) = k e ? [ y n ( t ) ? y n ( 0 ) ] , where { I ^ n x ( t ) } and { I ^ n y ( t ) } are the x-direction and y-direction ideal values, respectively, and k e is the DENSE cMR encoding parameter. Let I x ( x , y , t ) and I y ( x , y , t ) represent the discrete noisy DENSE cMR image sequence encoded in the x -direction and y -direction, respectively, where ( x , y ) ? ? and t takes on k ? [1... Nk ] unique values within the range [0...1] . We define the distance D (·) ? [0, ?] of a given trajectory field ? to a noisy DENSE cMR sequence in the L2-norm sense as (10) D ( ? ) = ? k = 1 N k ? n = 1 N ( I x [ x n ( t k ) , y n ( t k ) , t k ] ? I ^ n x [ t k ] ) 2 + ? k = 1 N k ? n = 1 N ( I y [ x n ( t k ) , y n ( t k ) , t k ] ? I ^ n y [ t k ] ) 2 . To determine the trajectory field of highest similarity to a given noisy DENSE cMR image sequence, we must traverse the combinatorial optimization space of the trajectory field model to locate the field of minimum distance defined by (10). A direct search of the model space for the globally minimum distance is computationally prohibitive. We therefore search the model space via simulated annealing [ 32 ], analogous to the metallurgical annealing process wherein hot metal is slowly cooled to form a perfect crystalline structure with minimum free energy. In simulated annealing, we slowly “cool” our model search to locate the point within the model space of minimum energy, where “coolness” reflects the decreasing probability of moving to an inferior solution in terms of an energy measure that quantifies solution quality. Let ?1 represent the current trajectory field state of our model search, with some distance to the noisy DENSE cMR imagery D (?1). We perturb the model parameters associated with this trajectory field, obtaining a new trajectory field ?2 with corresponding distance D (?2), and consider changing the state of our system to this new trajectory field. If we accepted only good moves, i.e. when D (?2) < D (?1), we would quickly find a local minima within our search space, but would become trapped in this local minima and unable to discover the global minimum. In simulated annealing we utilize a more sophisticated acceptance condition, i.e. changes in the model state are accepted if (11) 1 1 + e D ( ? 2 ) ? D ( ? 1 ) T < U ( 0 , 1 ) , where T is the current system temperature, and U (0,1) is a uniformly distributed random variable between 0 and 1. At high temperatures, all changes have an equal probability of being accepted. As the temperature is lowered, moves that increase the system energy have a lower probability of acceptance, until the algorithm reduces to the greedy method at T = 0 accepting only moves that reduce the system energy. We begin the annealing process at some initial temperature T 0 (in which every possible change to the system state is equally probable), and follow a geometric annealing schedule which reducing the temperature by some constant ? ( T k +1 = ? · T k ) at each temperature until a final temperature T final is reached. At each temperature, we test N C candidate points within the model space. When T final is achieved, the algorithm is essentially a greedy one, for which achieving a local minimum is guaranteed. To provide a small reduction in the search space dimensionality, we define the orientation, position, and scaling of the normalized trajectory field model to the DENSE cMR image space via a small number of user defined myocardial landmarks. The computational complexity of this annealing algorithm scales linearly according to the number of principle components used, the number of candidate point tested at each temperature, and the number of temperatures evaluated.  A. Training set analysis The current state-of-the-art DENSE cMR motion recovery method discussed in Section II.A does not lend itself to the construction of our cardiac point distribution model, as each heart in the training set is sampled at a unique set of spatiotemporal locations. To address this concern, as well improve noise compensation within the acquired datasets, we introduce a novel semi-automatic DENSE cMR analysis method. This method defines a smooth and continuous myocardial trajectory field via two spatiotemporal splines, given phase-unwrapped image sequences and expertly delineated myocardial contours. Note that this novel semi-automatic training set analysis is only a stepping stone towards the fully automated ATFM solution discussed in subsequent sections. Consider deformation in a single direction. Let { z n , n ? [1... N ]} represent the finite set of N irregularly spaced spatiotemporal deformations at the Cartesian coordinates ( x n , y n ) ? ? and at temporal locations t n ? [0...1] (varying from the start to the end of the cardiac cycle, respectively). We define the function f ( x , y , t ) as the unique solution that minimizes (4) E s p l i n e ( f ) = ? 1 ? 0 1 [ ? ? ( f x x 2 + 2 f x y 2 + f y y 2 ) d x d y ] d t + ? 2 ? ? [ ? 0 1 f t t 2 d t ] d x d y + ( 1 ? ? 1 ? ? 2 ) ? ? n = 1 N ? z n ? f ( x n , y n , t n ) ? . where (?1,?2) ? [0...1] define the relative weight between energy terms and f dd is the second derivative of f ( x , y , t ) in the direction d . We apply an additional boundary constraint to our solution that forces trajectories to begin and end at their respective spatial origins by requiring zero valued deformations at these temporal locations. The first energy term in (4) is derived from a 2D thin plate spline [ 16 , 28 ], the 2D analog of the 1D cubic spline. This term quantifies the spatial bending energy at each temporal location in the function f ( x , y , t ) , ensuring a spatially smooth deformation field. The second energy term is derived from a one-dimensional cubic spline [ 16 ]. This term quantifies the temporal curvature of our solution, i.e. the sum of squared acceleration across time within the spatial region of interest, ensuring a temporally smooth deformation field when minimized. Our energy functional also includes an L2-norm data constraint, forcing the solution towards the least-squares approximation of the input deformations. Minimizing the weighted sum of these three energy terms produces a spatially and temporally smooth solution that closely matches the input deformation data. We note that although (4) could be formulated in the L1-norm sense, the range and variability of noise present in the displacement data has lent itself to an L2-norm minimization scheme. To ensure we do not over smooth and lose local tissue motion features, our choice of ?1 and ?2 is governed by the cross-validation technique described in [ 29 ]. We divide our entire training set of displacement fields into estimation data and validation data, choosing D random displacements from each field as the validation data. We then search the parameter space for the spatiotemporal splines derived from the estimation data that best fit the validation data. Fig. 4 illustrates a typical spatiotemporal spline fit. The top row shows the original displacement fields, and the bottom row shows the corresponding spline deformation fields. We can additionally calculate strain fields by discretizing this continuous trajectory field and using the method described in Section II.A, as illustrated in Fig. 5 .  B. Model definition With a training set of continuous spatiotemporal trajectory fields in hand, we may now consider the construction of a trajectory field model for subsequent motion recovery [ 30 ]. This is a three step process, wherein we align the training data to a single reference coordinate system, discretize each continuous trajectory field at the same set of myocardial landmarks and cardiac phases, and define a point distribution model that measures the variability among these discrete trajectory fields via PCA. Let us first consider training data alignment. The center of each resting heart within the training set lies at a different spatial location within its respective image acquisition space. Additionally, each resting heart has a different orientation with respect to this center. Finally, two hearts that differ in size may still exhibit the same motion characteristics. To more accurately characterize motion variability within the training set, we eliminate these differences in cardiac position, orientation, and scale by aligning each resting heart to a single reference coordinate system. We refer to the resulting aligned trajectory field as normalized . As it is difficult to manually delineate the myocardium in DENSE cMR imagery early in the cardiac cycle, we define the resting heart by projecting expert drawn contours and features (right ventricle insertion points, see Fig. 1a ) from the frame of greatest myocardial contrast back to their resting positions via the spatiotemporal spline definition. Alignment of this resting configuration is achieved via a Procrustes analysis [ 13 , 31 ], with respect to a reference myocardium centered at the spatial origin with right-ventricle insertion points aligned to the vertical axis and unity epicardial radius. Fig. 6 illustrates a typical alignment, transforming a resting configuration and motion field ( Fig. 6a-b ) to the reference coordinate system ( Fig. 6c-d ). To aid visualization, the right ventricle insertion points are marked as squares. After alignment, the next challenge in model construction is the spatial and temporal discretization of each trajectory field within the training set using an identical set of myocardial- landmarks. To elaborate, if trajectory #10 in the first training field corresponds to the anterior right ventricle insertion point, trajectory #10 in all training fields must correspond to the same anterior right ventricle insertion point. We achieve this trajectory matching by mapping a sampling template to the aligned resting myocardial definition, and recovering the discrete trajectories associated with each of these spatial origins. Fig. 7 illustrates this procedure, using a sampling template ( Fig. 7a ) to sample the normalized resting myocardial definition ( Fig. 7b ) and produce a discrete set of resting spatial locations ( Fig. 7c ) and a corresponding trajectory field ( Fig. 7d ). Temporal discretization is achieved by sampling each training trajectory field at a known set of cardiac phases. Given the set of normalized discrete training trajectory fields, we are able to characterize the data variability via principal component analysis (PCA). Let X ijk = [ x ijk , y ijk ] represent the x - y position of the i th trajectory at the j th cardiac phase of the k th normalized trajectory field, where i ? [1... Ni ] , j ? [1... Nj ] , and k ? [1... Nk ] . We vectorize the k th trajectory field as (5) ? k = [ X 1 , 1 , k , X 2 , 1 , k , … , X N i , 1 , c ? Phase 1 , … … X 1 , j , k , … , X N i , j , k , ? Phase j … , X 1 , N j , k , … , X N i , N j , k ? Phase Nj ] T , of size [(2 · Ni · Nj ) × 1] . The average normalized trajectory field is defined as (6) ? ? = 1 N k ? k = 1 N k ? k , and the sample distribution covariance matrix is defined by (7) C o v = 1 N k ? k = 1 N k ( ? k ? ? ? ) ? ( ? k ? ? ? ) T . The eigenvectors P of the covariance matrix define the modes of variation within the training set, and the corresponding eigenvalues describe the relative significance of each mode. The percentage of variation accounted for by each eigenvector is defined as the corresponding eigenvalue divided by the sum of all eigenvalues. We can recover any normalized trajectory field within the training set by a linear combination of the average normalized trajectory field with the modes of variation. Moreover, we can approximate any normalized trajectory field within the training data by a linear combination of the average normalized trajectory field with the most significant eigenvectors, termed principle components, as in (8) M k ? M ? + P ^ ? b ^ k , where P? is a subset of the modes of variation P , and b? k is set of weighting coefficients corresponding to the k th trajectory field. In practice, we define an amount of variation we wish to approximate (e.g. 95% variation), and use the principle components that account for this level of variation. These principle components of variation, combined with a rotation, translation, and scale to transform the normalized trajectory fields back to the image space of a new DENSE cMR sequence, define our trajectory field model. We are able to achieve any trajectory field within the search space by varying a small number of parameters, i.e. the principle component weights, orientation, translation, and scale.  C. ATFM motion recovery Given the aforementioned model space definition, we are able to attempt the automatic recovery of cardiac motion from a newly acquired DENSE cMR sequence. In this section, we will first consider the search criterion which defines the best match between trajectory field and noisy imagery. We then discuss our method of attack to solve the combinatorial optimization problem of locating the best match within the model search space. We measure the correspondence between a given trajectory field and a noisy image sequence via an analysis-by-synthesis technique. Given any myocardial trajectory field, one can synthesize a set of “ideal” DENSE cMR values which represent the noise-free DENSE cMR data that would have produced the trajectory field in question. This is accomplished by measuring displacement from the spatial origin for each trajectory at each phase of the cardiac cycle, and scaling according to the DENSE cMR encoding parameter. Let ? = {[ x n ( t ), y n ( t )], n ? [1... N ]} represent a set of N temporally continuous trajectories. The ideal DENSE cMR value corresponding to each trajectory at some time t are defined as (9) I ^ n x ( t ) = k e ? [ x n ( t ) ? x n ( 0 ) ] I ^ n y ( t ) = k e ? [ y n ( t ) ? y n ( 0 ) ] , where { I ^ n x ( t ) } and { I ^ n y ( t ) } are the x-direction and y-direction ideal values, respectively, and k e is the DENSE cMR encoding parameter. Let I x ( x , y , t ) and I y ( x , y , t ) represent the discrete noisy DENSE cMR image sequence encoded in the x -direction and y -direction, respectively, where ( x , y ) ? ? and t takes on k ? [1... Nk ] unique values within the range [0...1] . We define the distance D (·) ? [0, ?] of a given trajectory field ? to a noisy DENSE cMR sequence in the L2-norm sense as (10) D ( ? ) = ? k = 1 N k ? n = 1 N ( I x [ x n ( t k ) , y n ( t k ) , t k ] ? I ^ n x [ t k ] ) 2 + ? k = 1 N k ? n = 1 N ( I y [ x n ( t k ) , y n ( t k ) , t k ] ? I ^ n y [ t k ] ) 2 . To determine the trajectory field of highest similarity to a given noisy DENSE cMR image sequence, we must traverse the combinatorial optimization space of the trajectory field model to locate the field of minimum distance defined by (10). A direct search of the model space for the globally minimum distance is computationally prohibitive. We therefore search the model space via simulated annealing [ 32 ], analogous to the metallurgical annealing process wherein hot metal is slowly cooled to form a perfect crystalline structure with minimum free energy. In simulated annealing, we slowly “cool” our model search to locate the point within the model space of minimum energy, where “coolness” reflects the decreasing probability of moving to an inferior solution in terms of an energy measure that quantifies solution quality. Let ?1 represent the current trajectory field state of our model search, with some distance to the noisy DENSE cMR imagery D (?1). We perturb the model parameters associated with this trajectory field, obtaining a new trajectory field ?2 with corresponding distance D (?2), and consider changing the state of our system to this new trajectory field. If we accepted only good moves, i.e. when D (?2) < D (?1), we would quickly find a local minima within our search space, but would become trapped in this local minima and unable to discover the global minimum. In simulated annealing we utilize a more sophisticated acceptance condition, i.e. changes in the model state are accepted if (11) 1 1 + e D ( ? 2 ) ? D ( ? 1 ) T < U ( 0 , 1 ) , where T is the current system temperature, and U (0,1) is a uniformly distributed random variable between 0 and 1. At high temperatures, all changes have an equal probability of being accepted. As the temperature is lowered, moves that increase the system energy have a lower probability of acceptance, until the algorithm reduces to the greedy method at T = 0 accepting only moves that reduce the system energy. We begin the annealing process at some initial temperature T 0 (in which every possible change to the system state is equally probable), and follow a geometric annealing schedule which reducing the temperature by some constant ? ( T k +1 = ? · T k ) at each temperature until a final temperature T final is reached. At each temperature, we test N C candidate points within the model space. When T final is achieved, the algorithm is essentially a greedy one, for which achieving a local minimum is guaranteed. To provide a small reduction in the search space dimensionality, we define the orientation, position, and scaling of the normalized trajectory field model to the DENSE cMR image space via a small number of user defined myocardial landmarks. The computational complexity of this annealing algorithm scales linearly according to the number of principle components used, the number of candidate point tested at each temperature, and the number of temperatures evaluated.  IV. Results To demonstrate the effectiveness of the ATFM technique for tissue motion recovery within displacement imagery, we attempted to quantify myocardial motion in 2D short-axis murine DENSE cMR imagery. We considered a dataset containing two distinct murine conditions, healthy mice and mice seven days after induction of an experimental heart attack. The former condition consisted of 13 healthy mice imaged with a standard 2D cine DENSE cMR protocol, obtaining between 20 and 27 short-axis mid-plane images of the cardiac cycle per mouse. The latter condition consisted of six unhealthy mice with an induced myocardial infarction in the anterolateral wall, again imaged with a standard 2D cine DENSE cMR protocol, obtaining between 17 and 21 short-axis mid-plane images of the cardiac cycle per mouse. For each image sequence, a trained technician delineated the endocardial and epicardial borders on every frame and labeled the right ventricle insertion points on the last sequence frame. In this section, we present our findings. We first illustrate the failings of traditional segmentation methods towards the goal of automated cardiac motion recovery. We then present a physiological comparison of DENSE cMR analysis techniques, evaluating agreement between the traditional semi-automatic DENSE cMR analysis described in Section II.A and the novel ATFM technique presented within this paper. A. Motion Analysis via Traditional Automated Segmentation Semi-automatic DENSE cMR analysis can be broken into two distinct steps: 1) the manual delineation of myocardial borders within the magnitude imagery throughout the cardiac cycle by a trained technician, and 2) tissue motion recovery via phase analysis as described in Sections II.A or III.A. This natural division implies a plausible alternative for automated tissue motion recovery, i.e. the delineation of endocardial and epicardial borders via a traditional automated segmentation technique followed by DENSE cMR phase analysis. Many researchers have had significant success with deformable models for cMR segmentation [ 20 , 22 - 25 ], and thus we chose to examine such an alternative. To evaluate the effectiveness of such a system, we considered myocardial segmentation via the classical active contour segmentation technique described in [ 12 ]. The active contour was driven by a negative gradient magnitude external force, derived from DENSE cMR magnitude imagery. Endocardial and epicardial borders were separately initialized on each frame of a given image sequence as circles particularly close to the correct myocardial locations. After segmentation, we applied the traditional DENSE cMR phase analysis method described in Section II.A to recover tissue motion. This traditional segmentation technique was unable to accurately define myocardial borders on every image frame of any healthy DENSE cMR image sequence, which rendered the subsequent trajectory fields meaningless. Across the dataset, endocardial and epicardial active contour segmentation had root mean square errors of 0.87mm and 0.38mm respectively, exceedingly large as compared to the average myocardial wall thickness of ~2mm. Fig. 8 illustrates two typical segmentation problems. Fig. 8a shows an attempted segmentation early in the cardiac cycle, which fails due to a lack of myocardial contrast. Fig. 8b shows an attempted segmentation at the end of cardiac cycle, which fails as the epicardial border is drawn to the higher edge strength of the endocardial border. These failures lead us to conclude that a more comprehensive tissue motion analysis solution is required. B. ATFM Motion Recovery Analysis Let us now consider the evaluation of the novel automated ATFM motion recovery technique. As we desire to automatically reproduce physiologically meaningful measurements of cardiac motion similar to traditional semi-automatic techniques, we compare strain values measured by both the automated ATFM technique and a traditional semi-automatic DENSE cMR analysis. We will quantify agreement between the two methods via correlation and a Bland-Altman analysis [ 33 ]. The preliminary analysis of the ATFM training data utilized the same manually delineated myocardial borders and myocardial features of interest as the traditional DENSE cMR analysis. ATFM analysis was performed via a leave-one-out cross-validation study, attempting motion recovery on each noisy DENSE cMR image sequence within the data set using the remaining trajectory fields as training data. Parameters used for a given motion recovery technique remained consistent across the entire dataset. Spatiotemporal strain was calculated at many points within the myocardium as described in Section II.A. For comparison across motion recovery methods, we divide the left-ventricle into six segments, as standardized in [ 34 ] and illustrated in Fig. 9a . We quantify and plot the average radial and circumferential strain in each segment throughout the cardiac cycle, as illustrated in Fig. 9b and Fig. 9c respectively. As a quantitative comparison, we sample 10 evenly spaced cardiac phases throughout the cardiac cycle for each left-ventricular segment, resulting in 60 data points per heart. The two methods show good correlation, as illustrated in Fig. 10a-b . The average correlation value of radial strain is 0.83 (p<0.001), and the average correlation value of circumferential strain is 0.86 (p < 0.001). A Bland-Altman analysis of the data, shown in Fig. 10c-d , reveals further similarity between the two methods. We measure an average difference of -0.02 in radial strain (95% confidence interval of –0.16 to 0.11) and an average difference of <0.01 in circumferential strain (95% confidence interval of – 0.05 to 0.07) between the two methods.  IV. Results To demonstrate the effectiveness of the ATFM technique for tissue motion recovery within displacement imagery, we attempted to quantify myocardial motion in 2D short-axis murine DENSE cMR imagery. We considered a dataset containing two distinct murine conditions, healthy mice and mice seven days after induction of an experimental heart attack. The former condition consisted of 13 healthy mice imaged with a standard 2D cine DENSE cMR protocol, obtaining between 20 and 27 short-axis mid-plane images of the cardiac cycle per mouse. The latter condition consisted of six unhealthy mice with an induced myocardial infarction in the anterolateral wall, again imaged with a standard 2D cine DENSE cMR protocol, obtaining between 17 and 21 short-axis mid-plane images of the cardiac cycle per mouse. For each image sequence, a trained technician delineated the endocardial and epicardial borders on every frame and labeled the right ventricle insertion points on the last sequence frame. In this section, we present our findings. We first illustrate the failings of traditional segmentation methods towards the goal of automated cardiac motion recovery. We then present a physiological comparison of DENSE cMR analysis techniques, evaluating agreement between the traditional semi-automatic DENSE cMR analysis described in Section II.A and the novel ATFM technique presented within this paper. A. Motion Analysis via Traditional Automated Segmentation Semi-automatic DENSE cMR analysis can be broken into two distinct steps: 1) the manual delineation of myocardial borders within the magnitude imagery throughout the cardiac cycle by a trained technician, and 2) tissue motion recovery via phase analysis as described in Sections II.A or III.A. This natural division implies a plausible alternative for automated tissue motion recovery, i.e. the delineation of endocardial and epicardial borders via a traditional automated segmentation technique followed by DENSE cMR phase analysis. Many researchers have had significant success with deformable models for cMR segmentation [ 20 , 22 - 25 ], and thus we chose to examine such an alternative. To evaluate the effectiveness of such a system, we considered myocardial segmentation via the classical active contour segmentation technique described in [ 12 ]. The active contour was driven by a negative gradient magnitude external force, derived from DENSE cMR magnitude imagery. Endocardial and epicardial borders were separately initialized on each frame of a given image sequence as circles particularly close to the correct myocardial locations. After segmentation, we applied the traditional DENSE cMR phase analysis method described in Section II.A to recover tissue motion. This traditional segmentation technique was unable to accurately define myocardial borders on every image frame of any healthy DENSE cMR image sequence, which rendered the subsequent trajectory fields meaningless. Across the dataset, endocardial and epicardial active contour segmentation had root mean square errors of 0.87mm and 0.38mm respectively, exceedingly large as compared to the average myocardial wall thickness of ~2mm. Fig. 8 illustrates two typical segmentation problems. Fig. 8a shows an attempted segmentation early in the cardiac cycle, which fails due to a lack of myocardial contrast. Fig. 8b shows an attempted segmentation at the end of cardiac cycle, which fails as the epicardial border is drawn to the higher edge strength of the endocardial border. These failures lead us to conclude that a more comprehensive tissue motion analysis solution is required. B. ATFM Motion Recovery Analysis Let us now consider the evaluation of the novel automated ATFM motion recovery technique. As we desire to automatically reproduce physiologically meaningful measurements of cardiac motion similar to traditional semi-automatic techniques, we compare strain values measured by both the automated ATFM technique and a traditional semi-automatic DENSE cMR analysis. We will quantify agreement between the two methods via correlation and a Bland-Altman analysis [ 33 ]. The preliminary analysis of the ATFM training data utilized the same manually delineated myocardial borders and myocardial features of interest as the traditional DENSE cMR analysis. ATFM analysis was performed via a leave-one-out cross-validation study, attempting motion recovery on each noisy DENSE cMR image sequence within the data set using the remaining trajectory fields as training data. Parameters used for a given motion recovery technique remained consistent across the entire dataset. Spatiotemporal strain was calculated at many points within the myocardium as described in Section II.A. For comparison across motion recovery methods, we divide the left-ventricle into six segments, as standardized in [ 34 ] and illustrated in Fig. 9a . We quantify and plot the average radial and circumferential strain in each segment throughout the cardiac cycle, as illustrated in Fig. 9b and Fig. 9c respectively. As a quantitative comparison, we sample 10 evenly spaced cardiac phases throughout the cardiac cycle for each left-ventricular segment, resulting in 60 data points per heart. The two methods show good correlation, as illustrated in Fig. 10a-b . The average correlation value of radial strain is 0.83 (p<0.001), and the average correlation value of circumferential strain is 0.86 (p < 0.001). A Bland-Altman analysis of the data, shown in Fig. 10c-d , reveals further similarity between the two methods. We measure an average difference of -0.02 in radial strain (95% confidence interval of –0.16 to 0.11) and an average difference of <0.01 in circumferential strain (95% confidence interval of – 0.05 to 0.07) between the two methods.  A. Motion Analysis via Traditional Automated Segmentation Semi-automatic DENSE cMR analysis can be broken into two distinct steps: 1) the manual delineation of myocardial borders within the magnitude imagery throughout the cardiac cycle by a trained technician, and 2) tissue motion recovery via phase analysis as described in Sections II.A or III.A. This natural division implies a plausible alternative for automated tissue motion recovery, i.e. the delineation of endocardial and epicardial borders via a traditional automated segmentation technique followed by DENSE cMR phase analysis. Many researchers have had significant success with deformable models for cMR segmentation [ 20 , 22 - 25 ], and thus we chose to examine such an alternative. To evaluate the effectiveness of such a system, we considered myocardial segmentation via the classical active contour segmentation technique described in [ 12 ]. The active contour was driven by a negative gradient magnitude external force, derived from DENSE cMR magnitude imagery. Endocardial and epicardial borders were separately initialized on each frame of a given image sequence as circles particularly close to the correct myocardial locations. After segmentation, we applied the traditional DENSE cMR phase analysis method described in Section II.A to recover tissue motion. This traditional segmentation technique was unable to accurately define myocardial borders on every image frame of any healthy DENSE cMR image sequence, which rendered the subsequent trajectory fields meaningless. Across the dataset, endocardial and epicardial active contour segmentation had root mean square errors of 0.87mm and 0.38mm respectively, exceedingly large as compared to the average myocardial wall thickness of ~2mm. Fig. 8 illustrates two typical segmentation problems. Fig. 8a shows an attempted segmentation early in the cardiac cycle, which fails due to a lack of myocardial contrast. Fig. 8b shows an attempted segmentation at the end of cardiac cycle, which fails as the epicardial border is drawn to the higher edge strength of the endocardial border. These failures lead us to conclude that a more comprehensive tissue motion analysis solution is required.  A. Motion Analysis via Traditional Automated Segmentation Semi-automatic DENSE cMR analysis can be broken into two distinct steps: 1) the manual delineation of myocardial borders within the magnitude imagery throughout the cardiac cycle by a trained technician, and 2) tissue motion recovery via phase analysis as described in Sections II.A or III.A. This natural division implies a plausible alternative for automated tissue motion recovery, i.e. the delineation of endocardial and epicardial borders via a traditional automated segmentation technique followed by DENSE cMR phase analysis. Many researchers have had significant success with deformable models for cMR segmentation [ 20 , 22 - 25 ], and thus we chose to examine such an alternative. To evaluate the effectiveness of such a system, we considered myocardial segmentation via the classical active contour segmentation technique described in [ 12 ]. The active contour was driven by a negative gradient magnitude external force, derived from DENSE cMR magnitude imagery. Endocardial and epicardial borders were separately initialized on each frame of a given image sequence as circles particularly close to the correct myocardial locations. After segmentation, we applied the traditional DENSE cMR phase analysis method described in Section II.A to recover tissue motion. This traditional segmentation technique was unable to accurately define myocardial borders on every image frame of any healthy DENSE cMR image sequence, which rendered the subsequent trajectory fields meaningless. Across the dataset, endocardial and epicardial active contour segmentation had root mean square errors of 0.87mm and 0.38mm respectively, exceedingly large as compared to the average myocardial wall thickness of ~2mm. Fig. 8 illustrates two typical segmentation problems. Fig. 8a shows an attempted segmentation early in the cardiac cycle, which fails due to a lack of myocardial contrast. Fig. 8b shows an attempted segmentation at the end of cardiac cycle, which fails as the epicardial border is drawn to the higher edge strength of the endocardial border. These failures lead us to conclude that a more comprehensive tissue motion analysis solution is required.  B. ATFM Motion Recovery Analysis Let us now consider the evaluation of the novel automated ATFM motion recovery technique. As we desire to automatically reproduce physiologically meaningful measurements of cardiac motion similar to traditional semi-automatic techniques, we compare strain values measured by both the automated ATFM technique and a traditional semi-automatic DENSE cMR analysis. We will quantify agreement between the two methods via correlation and a Bland-Altman analysis [ 33 ]. The preliminary analysis of the ATFM training data utilized the same manually delineated myocardial borders and myocardial features of interest as the traditional DENSE cMR analysis. ATFM analysis was performed via a leave-one-out cross-validation study, attempting motion recovery on each noisy DENSE cMR image sequence within the data set using the remaining trajectory fields as training data. Parameters used for a given motion recovery technique remained consistent across the entire dataset. Spatiotemporal strain was calculated at many points within the myocardium as described in Section II.A. For comparison across motion recovery methods, we divide the left-ventricle into six segments, as standardized in [ 34 ] and illustrated in Fig. 9a . We quantify and plot the average radial and circumferential strain in each segment throughout the cardiac cycle, as illustrated in Fig. 9b and Fig. 9c respectively. As a quantitative comparison, we sample 10 evenly spaced cardiac phases throughout the cardiac cycle for each left-ventricular segment, resulting in 60 data points per heart. The two methods show good correlation, as illustrated in Fig. 10a-b . The average correlation value of radial strain is 0.83 (p<0.001), and the average correlation value of circumferential strain is 0.86 (p < 0.001). A Bland-Altman analysis of the data, shown in Fig. 10c-d , reveals further similarity between the two methods. We measure an average difference of -0.02 in radial strain (95% confidence interval of –0.16 to 0.11) and an average difference of <0.01 in circumferential strain (95% confidence interval of – 0.05 to 0.07) between the two methods.  B. ATFM Motion Recovery Analysis Let us now consider the evaluation of the novel automated ATFM motion recovery technique. As we desire to automatically reproduce physiologically meaningful measurements of cardiac motion similar to traditional semi-automatic techniques, we compare strain values measured by both the automated ATFM technique and a traditional semi-automatic DENSE cMR analysis. We will quantify agreement between the two methods via correlation and a Bland-Altman analysis [ 33 ]. The preliminary analysis of the ATFM training data utilized the same manually delineated myocardial borders and myocardial features of interest as the traditional DENSE cMR analysis. ATFM analysis was performed via a leave-one-out cross-validation study, attempting motion recovery on each noisy DENSE cMR image sequence within the data set using the remaining trajectory fields as training data. Parameters used for a given motion recovery technique remained consistent across the entire dataset. Spatiotemporal strain was calculated at many points within the myocardium as described in Section II.A. For comparison across motion recovery methods, we divide the left-ventricle into six segments, as standardized in [ 34 ] and illustrated in Fig. 9a . We quantify and plot the average radial and circumferential strain in each segment throughout the cardiac cycle, as illustrated in Fig. 9b and Fig. 9c respectively. As a quantitative comparison, we sample 10 evenly spaced cardiac phases throughout the cardiac cycle for each left-ventricular segment, resulting in 60 data points per heart. The two methods show good correlation, as illustrated in Fig. 10a-b . The average correlation value of radial strain is 0.83 (p<0.001), and the average correlation value of circumferential strain is 0.86 (p < 0.001). A Bland-Altman analysis of the data, shown in Fig. 10c-d , reveals further similarity between the two methods. We measure an average difference of -0.02 in radial strain (95% confidence interval of –0.16 to 0.11) and an average difference of <0.01 in circumferential strain (95% confidence interval of – 0.05 to 0.07) between the two methods.  V. Conclusions The medical image analysis field continues to benefit from the advent of new and exciting medical imaging techniques. One class of techniques, tissue motion imaging such as DENSE cMR, boasts the ability to quantify tissue motion throughout the cardiac muscle and produce accurate spatiotemporal measurements of myocardial strain, twist, and torsion. Though current manual and semi-automatic analysis methods can generate remarkable trajectory fields, researchers and clinicians would benefit from a fully automated analysis software package. As an advance in computational intelligence in biomedicine, this paper has presented a novel generative deformable modeling technique, termed active trajectory field models (ATFM), for the automated analysis of acquired tissue motion imagery. The development of this technique was a complex task, requiring a novel preliminary semi-automatic DENSE cMR analysis technique, the alignment and subsequent variability characterization of a complex set of spatiotemporal trajectory fields, and the solution of a combinatorial optimization problem to find the trajectory field of best fit to a given noisy image sequence. We validated the ATFM method by quantifying myocardial motion in 2D short-axis murine DENSE cMR image sequences both before and after myocardial infarction, producing results comparable to existing semi-automatic analysis methods. Though we focused our efforts on left ventricular motion recovery within 2D short-axis murine cine DENSE cMR imagery, the ATFM method can be adapted to human data, other tissue motion imaging techniques, as well as 3D motion recovery.  Figures Fig. 1 Single frame murine DENSE cMR analysis. (a) Short-axis anatomical diagram, (b) magnitude image, (c) horizontal encoded phase image, (d) phase-unwrapped image, and (e) displacement field. Fig. 2 Typical murine DENSE cMR trajectory field. Fig. 3 End-systolic (left) radial and (right) circumferential strain. Fig. 4 Typical spatiotemporal spline fitting. (top row) Original displacement fields and (bottom row) corresponding spline fields. Fig. 5 End-systolic (left) radial and (right) circumferential strain using the spatiotemporal spline method. Fig. 6 Alignment of training data to reference coordinate system. (a) Expert segmentation at rest, (b) corresponding trajectory field, (c) aligned resting segmentation, (d) aligned trajectory field. Fig. 7 Trajectory field discretization. (a) Sampling template, (b) normalized myocardial borders, (c) discretized myocardial definition, (d) corresponding trajectory field Fig. 8 Example active contour segmentation (a) early in the cardiac cycle and (b) late in the cardiac cycle Fig. 9 Typical six-segment strain analysis. (a) Anatomical diagram, (b) radial and (c) circumferential segmental strain. Fig. 10 Strain correlation of traditional and ATFM methods. Radial/circumferential (a-b) correlation and (c-d) Bland-Altman analyses 