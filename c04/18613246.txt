Marginalized models for longitudinal ordinal data with application to quality of life studies SUMMARY Random effects are often used in generalized linear models to explain the serial dependence for longitudinal categorical data. Marginalized random effects models (MREMs) for the analysis of longitudinal binary data have been proposed to permit likelihood-based estimation of marginal regression parameters. In this paper, we introduce an extension of the MREM to accommodate longitudinal ordinal data. Maximum marginal likelihood estimation is implemented utilizing quasi-Newton algorithms with Monte Carlo integration of the random effects. Our approach is applied to analyze the quality of life data from a recent colorectal cancer clinical trial. Dropout occurs at a high rate and is often due to tumor progression or death. To deal with progression/death, we use a mixture model for the joint distribution of longitudinal measures and progression/death times and principal stratification to draw causal inferences about survivors.  1. INTRODUCTION Longitudinal data are repeated measurements from the same subject observed over time. The within-subject measurements (over time) are typically not independent. Although serial correlation may not be of primary interest but it must be taken into account to make proper inferences. In marginal models, the population-averaged effect of covariates on the longitudinal response is directly specified [ 1 , 2 ] and the regression coefficients have interpretation for the population rather than for any individual [ 3 ]. In conditional models, the effect of covariates on responses is specified conditional on random effects or previous history of responses. Hence, the population-averaged effect of covariates is indirectly specified [ 4 , 5 ]. In this paper, we consider marginal model approaches. Properly specified probability models lead to efficient estimation even under missing at random (MAR) [ 6 ] and nested models can be compared using likelihood ratio tests and non-nested models by penalized criteria such as Akaike information criterion (AIC) [ 7 ] or Bayesian information criterion [ 8 ]. Recently, marginalized likelihood-based models have been developed for the analysis of longitudinal categorical data [ 9 – 13 ]. Heagerty [ 9 , 10 ] proposed marginally specified logistic-normal models and marginalized transition models (MTM) for longitudinal binary data. In both models, a marginal logistic-regression model was used for explaining the average response. The models were specified by introducing random effects in the logistic-normal models and Markov dependence for MTM to explain the within-subject dependence. Miglioretti and Heagerty [ 12 ] developed marginalized multilevel models for longitudinal binary data in the presence of time-varying covariates. Lee and Daniels [ 13 ] extended Heagerty's work to accommodate longitudinal ordinal data using Markov dependence. Marginalized models have advantages over conditional models. First, the interpretation of regression coefficients does not depend on specification of the dependence in the model unlike in conditional models. In addition, estimation of covariate effects has been shown to be more robust to mis-specification of dependence [ 10 , 11 , 13 ]. Models for correlated ordinal data typically fall into two classes based on how the dependence is modeled: via the global odds ratio [ 14 – 17 ] or via random effects [ 18 – 20 ]. A general overview of models for ordinal categorical data can be found in Liu and Agresti [ 21 ]. The main contribution of this paper will be to introduce a new marginalized model for longitudinal ordinal data. A common issue in inference from longitudinal studies is potential biases introduced by missing data. Classes of models to accommodate longitudinal data with dropout are summarized in Hogan et al . [ 22 ]. Standard approaches to handle missing data implicitly ‘impute’ values of response after dropout. For quality of life (QOL) data, if a subject drops out due to death, the QOL will not be defined after the dropout time. One way to address the type of dropout is to model the joint distribution of the longitudinal responses and progression/death times [ 23 – 25 ]. Hogan and Laird [ 23 ] used a mixture model for the joint distribution of longitudinal measures and progression/death times. Pauler et al . [ 24 ] proposed a pattern mixture model (PMM) for longitudinal QOL data with non-ignorable missingness due to dropout and censorship by death. Recently, Kurland and Heagerty [ 25 ] explored regression models conditioning on being alive as a valid target of inference. They used regression models that condition on survival status rather than a specific survival time. We will use the ideas in Hogan and Laird [ 23 ] similar to the previous work by Pauler et al . [ 24 ]. We implement a principal stratification approach [ 26 , 27 ] here to make inference on the causal effect of the treatment on QOL among (potential) survivors on both treatment arms. Frangakis and Rubin [ 26 ] discussed causal effects in studies where the outcome was recorded and unobserved due to death. Rubin [ 28 ] and Hayden et al . [ 29 ] referred to the estimand in Frangakis and Rubin [ 26 ] as ‘the survivors average causal effect (SACE)’. Egleston et al . 27 proposed assumptions to identify the SACE and implemented a sensitivity analysis for some of those assumptions. Rubin [ 30 ] introduced the causal effect of a treatment on a outcome that is censored by death in QOL studies. In this paper, we describe an approach that can be used to obtain the causal effect of treatment in the presence of death based on principal stratification for longitudinal ordinal outcomes. This paper is arranged as follows. In Section 2, we describe the motivating example. We briefly review marginalized random effects models (MREMs) for longitudinal binary data [ 9 ] in Section 3. In Section 4, we propose an ordinal MREM (OMREM) for the longitudinal data with ignorable dropout. In Section 5, we conduct a simulation study to examine bias and efficiency in estimation of marginal mean parameters. In the context of QOL data collected in a recent colorectal cancer clinical trial [ 31 ], we propose models for the OMREM under dropout due to progression/death and illustrate them on this data in Section 6.  2. MOTIVATING EXAMPLE We analyzed QOL data from a recent colorectal cancer clinical trial [ 31 ]. A total of 795 patients with colorectal cancer were randomly assigned to one of the three treatments (FOLFOX, IFL (control) and IROX) between May 1999 and April 2001. The main objective of this trial was to find a better treatment for colorectal cancer. The median survival for patients receiving IFL was 15.0 months compared with 19.5 months for those receiving FOLFOX and 17.4 months for those receiving IROX. Survival for patients receiving FOLFOX did not differ from those receiving IROX (see [ 31 ]). However, given that the toxicity profiles were quite different on the three treatment arms, it was of interest to see if there was a negative impact of ‘better’ treatments on patients QOL. We focus on one QOL measure, fatigue. Fatigue is measured on a 5-point ordinal scale. Additional complications for analyzing QOL are posed by patients dying during the trial. The models and analysis to follow focus on two treatments, FOLFOX and IFL (control) and address appropriate analysis of QOL data in the presence of death.  3. REVIEW OF MARGINALLY SPECIFIED LOGISTIC-NORMAL MODELS FOR LONGITUDINAL BINARY DATA Now we review MREMs for longitudinal binary data [ 9 ]. Define ? i t M = P ( Y i t = 1 ? x i t ) . The marginalized logistic-normal model (MLNM) is specified using the following regressions: mean model : (1) logit ? i t M = x i t T ? dependence model : (2) logit ? i t c ( b i t ) = ? i t + b i t where ? is the p × 1 vector of regression coefficients and ? i t c ( b i t ) = E ( Y i t ? b i t , x i t ) . We assume that the response vector Y i is conditionally independent given b i = ( b i 1,..., b ini )T and that (3) b i ~ N ( 0 , A ) The covariance matrix A is assumed to have a simple structure. Conditional on x i and b i , the responses Y it are assumed to be conditionally independent. Parameters in A provide measures of random variation both across individuals and over time. The parameters ? it in (2) are functions of both the marginal mean parameters and the random effects variance and can be obtained using the following identity: (4) P ( Y i t = 1 ? x i t ) = ? P ( Y i t = 1 ? b i t , x i t ) f ( b i t ) d b i t where f is the univariate normal density function. This model has several desirable features. First, the mean model is specified separately from the dependence model. As a result, the interpretation of the regression parameter ? does not change as we modify assumptions regarding the dependence in equation (2) . This is not true for classical generalized random effects models, which parameterize ? i t c directly as a function of covariates. In addition, parameters in cov( b i ) provides measures of random variation both across individuals and over time. Second, the MLNM can be used with data where subjects have variable lengths of follow-up, permitting the likelihood analysis in settings where data may be MAR. Further details on MLNM are given in [ 9 ].  4. MREMS FOR LONGITUDINAL ORDINAL DATA In this section, we extend Heagerty's MLNM to accommodate longitudinal ordinal data. 4.1. Proposed models Let Y i = ( Y i 1,..., Y ini ) be a vector of longitudinal K -category ordinal responses on subject i = 1,..., N at times t = 1,..., n i , n i ? T . We assume that associated exogenous but possibly time-varying covariates, x it = ( x it 1,..., x itp ), are recorded for each subject at each time, and that the regression model properly specifies the full covariate conditional probability such that P ( Y it = y it | X it ) = P ( Y it = y it | X i 1,..., X ini ). The MREM for longitudinal ordinal data, also called OMREM, is specified using the following two regressions: mean model : (5) log P ( Y i t ? k ? x i t ) 1 ? P ( Y i t ? k ? x i t ) = ? 0 k + x i t T ? dependence model : (6) log P ( Y i t ? k ? b i , x i t ) 1 ? P ( Y i t ? k ? b i , x i t ) = ? i t k + b i t where b i T = ( b i 1 , … , b i n i ) ~ N ( 0 , ? i ) for i = 1,..., N and k = 1,..., K – 1. We assume that the variance–covariance matrix ? i of b i has an autoregressive covariance structure (7) ? i = ? i 2 ( 1 e ? ? e ? 2 ? ? e ? ( n i ? 1 ) ? e ? ? 1 e ? ? ? e ? ( n i ? 2 ) ? e ? 2 ? e ? ? 1 ? ? ? ? ? ? ? e ? ( n i ? 1 ) ? e ? ( n i ? 2 ) ? e ? ( n i ? 3 ) ? ? 1 ) = let ? i 2 ? ? where log ? i = z i T ? , z i is a c × 1 vector, and ? is a c × 1 coefficient vector of z i . The regression model for ? i allows heterogeneity to depend on subject-level covariates such as treatment or gender. In the dependence model, (6) , we need to ensure the monotonicity of ? in k to guarantee the validity of the mean model in (5) . Theorem 1 For the OMREM given by (5) and (6) , if ? 01 < ··· < ? 0 K –1, then ? it 1 <··· <? itK –1. Proof 1 See Appendix . The marginal mean model is a proportional odds model [ 32 ]. Serial dependence is captured by the random effects. The regression parameters in (5) have a marginal interpretations unlike generalized linear mixed models [ 5 ]. An advantage of this model is the ability to use conditional models for association (6) while still structuring the marginal mean as a function of covariates directly (5) . As a result, the interpretation of the regression coefficients, ( ? 0, ? ) does not depend on the specification of the dependence model. For longitudinal data with random effects b i , the marginal probability captures the systematic variation in the marginal probability that is due to x it , whereas parameters in cov( b i ) provide a measure of random variation both across individuals and over time. Heagerty and Kurland [ 33 ] investigated the impact on the estimates of regression coefficients of incorrect assumptions regarding the random effects in generalized linear mixed models and marginalized models and found that marginalized regression models are much less susceptible to bias resulting from random effects model misspecification. The marginal and conditional probabilities in (5) and (6) are related as follows: (8) P i t k M = ? P i t k c ( b i t ) f ( b i t ) d b i t where P i t k M = P ( Y i t ? k ? x i t ) , P i t k c ( b i t ) = P ( Y i t ? k ? b i t , x i t ) and f (·) is a univariate normal distribution with mean 0 and variance var( b it ). We use (8) to solve for ? itk given ? 0 k , ? and ? . Reparametrization of the random effects and their covariance matrix: From a computational perspective, it is convenient to orthogonalize the random effects by setting b i = ? i ?*1/2 a i where ?*1/2, a lower triangular matrix with positive diagonal elements, is the Cholesky factor of the n i × n i matrix ?* [ 34 ] and a i is a n i × 1 vector of independent standard normals. The reparameterized conditional model is then given by log P ( Y i t ? k ? a i , x i t ) 1 ? P ( Y i t ? k ? a i , x i t ) = ? i t k + ? i s ( t ) a i a i ~ N ( 0 , I ) where s ( t ) is the t th row of ?*1/2 and I is the identity matrix of order n i . This transformation allows us to estimate the Cholesky factor ?*1/2 instead of the covariance matrix ?*. Since the Cholesky factor is the square root of the covariance matrix, it allows more stable estimation of near-zero variance terms [ 35 ]. 4.2. Maximum likelihood estimation The likelihood function is the integral over random effects of a product of multinominals, (9) L ( ? ; y ) = ? i = 1 N ? ? t = 1 n i ? k = 1 K ( P i t k c ( a i ) ? P i t k ? 1 c ( a i ) ) y i t k ? ( a i ) d a i where P i t k c ( a i ) = P ( Y i t ? k ? a i , x i t ) , P i t 0 c ( a i ) = 0 , y i t k is the set of K indicators with y itk = 1 if y it = k ; y itk = 0 otherwise, for k = 1,..., K , ? (·) is a multivariate normal density with mean vector 0 and variance–covariance matrix I , and ? = ( ? 0, ?, ?, ? ). The marginalized likelihood in (9) is not available in the closed form. There are several approaches to (numerically) integrate out the random effects. Gauss–Hermite quadrature is popular for low-dimensional random effects models such as random intercept models [ 35 ]; adaptive versions [ 36 , 37 ] can increase efficiency. Monte Carlo methods are often used for the models with higher-dimensional integrals and use randomly sampled points to approximate the integrals. In our model, we use Monte Carlo methods to evaluate the integral in (9) as the dimension of a i is high. Maximizing the log likelihood with respect to ? yields the likelihood equation ? i = 1 N ? log L ( ? ; y i ) ? ? = ? i = 1 N L ? 1 ( ? ; y i ) ? ? L ( ? , a i ; y i ) ? ? ? ( a i ) d a i = 0 where (10) L ( ? ; y i ) = ? ? t = 1 n i ? k = 1 K ( P i t k c ( a i ) ? P i t k ? 1 c ( a i ) ) y i t k ? ( a i ) d a i L ( ? , a i ; y i ) = ? t = 1 n i ? k = 1 K { P i t k c ( a i ) ? P i t k ? 1 c ( a i ) } y i t k The ( K –1+ p + c +1)-dimensional likelihood equations are given in the Appendix . The matrix of second derivatives of the observed data log likelihood has a very complex form. Fortunately, the sample empirical covariance matrix of the individual scores in any correctly specified model is a consistent estimator of the information and involves only the first derivatives. Therefore, the quasi-Newton method can be used to solve the likelihood equations, using ? ( m + 1 ) = ? ( m ) + [ I e ( ? ( m ) ; y ) ] ? 1 ? log L ? ? ( m ) where I e ( ? ), an empirical and consistent estimator of the information matrix at step m , is given by I e ( ? ; y ) = ? i = 1 N ? L ( ? ; y i ) ? ? ? L ( ? ; y i ) ? ? T At convergence, the large-sample variance–covariance matrix of the parameter estimates is then obtained as the inverse of I e ( ? ^ ; y ) . For the explicit forms of the terms in the quasi-Newton algorithm including the derivatives ?? itk /? ? 0, ?? itk /? ? and ?? itg /? ? calculated using (8) , see the Appendix . The intercepts ? itk are a function of ? 0 k , ? , ? and ? and must be obtained within the quasi-Newton algorithm. Let f ( ? i t k ) = ? P i t k c ( b i t ) ? ( b i t ) d b i t ? P i t k M . Estimates of ? itk can be obtained using the Newton–Raphson algorithm as follows: ? i t k ( l + 1 ) = ? i t k ( l ) ? ( ? f ( ? i t k ) ? ? i t k ) ? 1 f ( ? i t k ) where (11) ? f ( ? i t k ) ? ? i t k = ? P i t k c ( b i t ) ( 1 ? P i t k c ( b i t ) ) h ( b i t ) d b i t Note that the integral in (11) is one dimensional and we use Gauss–Hermite quadrature to evaluate this integral.  4.1. Proposed models Let Y i = ( Y i 1,..., Y ini ) be a vector of longitudinal K -category ordinal responses on subject i = 1,..., N at times t = 1,..., n i , n i ? T . We assume that associated exogenous but possibly time-varying covariates, x it = ( x it 1,..., x itp ), are recorded for each subject at each time, and that the regression model properly specifies the full covariate conditional probability such that P ( Y it = y it | X it ) = P ( Y it = y it | X i 1,..., X ini ). The MREM for longitudinal ordinal data, also called OMREM, is specified using the following two regressions: mean model : (5) log P ( Y i t ? k ? x i t ) 1 ? P ( Y i t ? k ? x i t ) = ? 0 k + x i t T ? dependence model : (6) log P ( Y i t ? k ? b i , x i t ) 1 ? P ( Y i t ? k ? b i , x i t ) = ? i t k + b i t where b i T = ( b i 1 , … , b i n i ) ~ N ( 0 , ? i ) for i = 1,..., N and k = 1,..., K – 1. We assume that the variance–covariance matrix ? i of b i has an autoregressive covariance structure (7) ? i = ? i 2 ( 1 e ? ? e ? 2 ? ? e ? ( n i ? 1 ) ? e ? ? 1 e ? ? ? e ? ( n i ? 2 ) ? e ? 2 ? e ? ? 1 ? ? ? ? ? ? ? e ? ( n i ? 1 ) ? e ? ( n i ? 2 ) ? e ? ( n i ? 3 ) ? ? 1 ) = let ? i 2 ? ? where log ? i = z i T ? , z i is a c × 1 vector, and ? is a c × 1 coefficient vector of z i . The regression model for ? i allows heterogeneity to depend on subject-level covariates such as treatment or gender. In the dependence model, (6) , we need to ensure the monotonicity of ? in k to guarantee the validity of the mean model in (5) . Theorem 1 For the OMREM given by (5) and (6) , if ? 01 < ··· < ? 0 K –1, then ? it 1 <··· <? itK –1. Proof 1 See Appendix . The marginal mean model is a proportional odds model [ 32 ]. Serial dependence is captured by the random effects. The regression parameters in (5) have a marginal interpretations unlike generalized linear mixed models [ 5 ]. An advantage of this model is the ability to use conditional models for association (6) while still structuring the marginal mean as a function of covariates directly (5) . As a result, the interpretation of the regression coefficients, ( ? 0, ? ) does not depend on the specification of the dependence model. For longitudinal data with random effects b i , the marginal probability captures the systematic variation in the marginal probability that is due to x it , whereas parameters in cov( b i ) provide a measure of random variation both across individuals and over time. Heagerty and Kurland [ 33 ] investigated the impact on the estimates of regression coefficients of incorrect assumptions regarding the random effects in generalized linear mixed models and marginalized models and found that marginalized regression models are much less susceptible to bias resulting from random effects model misspecification. The marginal and conditional probabilities in (5) and (6) are related as follows: (8) P i t k M = ? P i t k c ( b i t ) f ( b i t ) d b i t where P i t k M = P ( Y i t ? k ? x i t ) , P i t k c ( b i t ) = P ( Y i t ? k ? b i t , x i t ) and f (·) is a univariate normal distribution with mean 0 and variance var( b it ). We use (8) to solve for ? itk given ? 0 k , ? and ? . Reparametrization of the random effects and their covariance matrix: From a computational perspective, it is convenient to orthogonalize the random effects by setting b i = ? i ?*1/2 a i where ?*1/2, a lower triangular matrix with positive diagonal elements, is the Cholesky factor of the n i × n i matrix ?* [ 34 ] and a i is a n i × 1 vector of independent standard normals. The reparameterized conditional model is then given by log P ( Y i t ? k ? a i , x i t ) 1 ? P ( Y i t ? k ? a i , x i t ) = ? i t k + ? i s ( t ) a i a i ~ N ( 0 , I ) where s ( t ) is the t th row of ?*1/2 and I is the identity matrix of order n i . This transformation allows us to estimate the Cholesky factor ?*1/2 instead of the covariance matrix ?*. Since the Cholesky factor is the square root of the covariance matrix, it allows more stable estimation of near-zero variance terms [ 35 ].  Theorem 1 For the OMREM given by (5) and (6) , if ? 01 < ··· < ? 0 K –1, then ? it 1 <··· <? itK –1.  Proof 1 See Appendix . The marginal mean model is a proportional odds model [ 32 ]. Serial dependence is captured by the random effects. The regression parameters in (5) have a marginal interpretations unlike generalized linear mixed models [ 5 ]. An advantage of this model is the ability to use conditional models for association (6) while still structuring the marginal mean as a function of covariates directly (5) . As a result, the interpretation of the regression coefficients, ( ? 0, ? ) does not depend on the specification of the dependence model. For longitudinal data with random effects b i , the marginal probability captures the systematic variation in the marginal probability that is due to x it , whereas parameters in cov( b i ) provide a measure of random variation both across individuals and over time. Heagerty and Kurland [ 33 ] investigated the impact on the estimates of regression coefficients of incorrect assumptions regarding the random effects in generalized linear mixed models and marginalized models and found that marginalized regression models are much less susceptible to bias resulting from random effects model misspecification. The marginal and conditional probabilities in (5) and (6) are related as follows: (8) P i t k M = ? P i t k c ( b i t ) f ( b i t ) d b i t where P i t k M = P ( Y i t ? k ? x i t ) , P i t k c ( b i t ) = P ( Y i t ? k ? b i t , x i t ) and f (·) is a univariate normal distribution with mean 0 and variance var( b it ). We use (8) to solve for ? itk given ? 0 k , ? and ? . Reparametrization of the random effects and their covariance matrix: From a computational perspective, it is convenient to orthogonalize the random effects by setting b i = ? i ?*1/2 a i where ?*1/2, a lower triangular matrix with positive diagonal elements, is the Cholesky factor of the n i × n i matrix ?* [ 34 ] and a i is a n i × 1 vector of independent standard normals. The reparameterized conditional model is then given by log P ( Y i t ? k ? a i , x i t ) 1 ? P ( Y i t ? k ? a i , x i t ) = ? i t k + ? i s ( t ) a i a i ~ N ( 0 , I ) where s ( t ) is the t th row of ?*1/2 and I is the identity matrix of order n i . This transformation allows us to estimate the Cholesky factor ?*1/2 instead of the covariance matrix ?*. Since the Cholesky factor is the square root of the covariance matrix, it allows more stable estimation of near-zero variance terms [ 35 ].  4.2. Maximum likelihood estimation The likelihood function is the integral over random effects of a product of multinominals, (9) L ( ? ; y ) = ? i = 1 N ? ? t = 1 n i ? k = 1 K ( P i t k c ( a i ) ? P i t k ? 1 c ( a i ) ) y i t k ? ( a i ) d a i where P i t k c ( a i ) = P ( Y i t ? k ? a i , x i t ) , P i t 0 c ( a i ) = 0 , y i t k is the set of K indicators with y itk = 1 if y it = k ; y itk = 0 otherwise, for k = 1,..., K , ? (·) is a multivariate normal density with mean vector 0 and variance–covariance matrix I , and ? = ( ? 0, ?, ?, ? ). The marginalized likelihood in (9) is not available in the closed form. There are several approaches to (numerically) integrate out the random effects. Gauss–Hermite quadrature is popular for low-dimensional random effects models such as random intercept models [ 35 ]; adaptive versions [ 36 , 37 ] can increase efficiency. Monte Carlo methods are often used for the models with higher-dimensional integrals and use randomly sampled points to approximate the integrals. In our model, we use Monte Carlo methods to evaluate the integral in (9) as the dimension of a i is high. Maximizing the log likelihood with respect to ? yields the likelihood equation ? i = 1 N ? log L ( ? ; y i ) ? ? = ? i = 1 N L ? 1 ( ? ; y i ) ? ? L ( ? , a i ; y i ) ? ? ? ( a i ) d a i = 0 where (10) L ( ? ; y i ) = ? ? t = 1 n i ? k = 1 K ( P i t k c ( a i ) ? P i t k ? 1 c ( a i ) ) y i t k ? ( a i ) d a i L ( ? , a i ; y i ) = ? t = 1 n i ? k = 1 K { P i t k c ( a i ) ? P i t k ? 1 c ( a i ) } y i t k The ( K –1+ p + c +1)-dimensional likelihood equations are given in the Appendix . The matrix of second derivatives of the observed data log likelihood has a very complex form. Fortunately, the sample empirical covariance matrix of the individual scores in any correctly specified model is a consistent estimator of the information and involves only the first derivatives. Therefore, the quasi-Newton method can be used to solve the likelihood equations, using ? ( m + 1 ) = ? ( m ) + [ I e ( ? ( m ) ; y ) ] ? 1 ? log L ? ? ( m ) where I e ( ? ), an empirical and consistent estimator of the information matrix at step m , is given by I e ( ? ; y ) = ? i = 1 N ? L ( ? ; y i ) ? ? ? L ( ? ; y i ) ? ? T At convergence, the large-sample variance–covariance matrix of the parameter estimates is then obtained as the inverse of I e ( ? ^ ; y ) . For the explicit forms of the terms in the quasi-Newton algorithm including the derivatives ?? itk /? ? 0, ?? itk /? ? and ?? itg /? ? calculated using (8) , see the Appendix . The intercepts ? itk are a function of ? 0 k , ? , ? and ? and must be obtained within the quasi-Newton algorithm. Let f ( ? i t k ) = ? P i t k c ( b i t ) ? ( b i t ) d b i t ? P i t k M . Estimates of ? itk can be obtained using the Newton–Raphson algorithm as follows: ? i t k ( l + 1 ) = ? i t k ( l ) ? ( ? f ( ? i t k ) ? ? i t k ) ? 1 f ( ? i t k ) where (11) ? f ( ? i t k ) ? ? i t k = ? P i t k c ( b i t ) ( 1 ? P i t k c ( b i t ) ) h ( b i t ) d b i t Note that the integral in (11) is one dimensional and we use Gauss–Hermite quadrature to evaluate this integral.  5. SIMULATION STUDY We conducted a simulation to examine the bias and efficiency for estimation of the marginal mean parameters in the setting of misspecification of the dependence model under no missing data and under MAR missingness (common in longitudinal data). We also compare the efficiency of the OMREM to the independence proportional odds model (IPOM), given in (5) . We simulated the longitudinal ordinal data under an OMREM. Covariates were time and group (two levels). The marginal probability for the OMREM was specified as log ( P ( Y i t ? k ? x i t ) 1 ? P ( Y i t ? k ? x i t ) ) = ? 0 k + ? 1 ? time i t + ? 2 ? group i ? 0 = ( ? 01 , ? 02 , ? 03 ) = ( ? 1.0 , 0.5 , 1.0 ) ; ? = ( ? 1 , ? 2 ) = ( ? 0.5 , 0.5 ) where t = 1,..., 6, time it = ( t –1)/6, and group i equals 0 or 1 with an approximately equal sample size per group. The conditional probabilities were specified from (6) and (7) with ( ? i, ? ) = (1.1, 0.2) if group i =0; ( ? i, ? ) = (1.5, 0.2) if group i =1. Note that ? = 0.2 corresponds to a lag one correlation of exp(–0.2)=0.819. We simulated 500 data sets each with a sample size of 300. We then fit the IPOM and the OMREM. For the MAR missingness, we specified the following MAR dropout model: (12) logit P ( dropout = t ? dropout ? t ) = { ? 1.5 + 0.3 Y i t ? 1 grp i = 0 ? 1.5 + 0.1 Y i t ? 1 grp i = 1 } where Y it –1 ?{0,1,2,3}. Table I presents the point estimates, root mean-squared error (?MSE), and 95 per cent Monte Carlo error intervals of the marginal mean parameters. When there were no missing data, the estimates were essentially unbiased for both the OMREM and the IPOM. The root MSEs in the IPOM were also similar to those in the OMREM but sometimes slightly larger (e.g. for ? 1 and ? 2). In the presence of MAR missingness, the estimates in the OMREM were still essentially unbiased. However, for the IPOM, we saw considerable biases; for example, the relative bias for the coefficient of time, ? 1 was 34 per cent ((–0.33+0.5)/(–0.5)). In addition, the root MSEs were larger in the IPOM; for ? 1 and ? 2, the root MSEs were eight and three times as large as the OMREM, respectively. Overall, the simulation shows the increased efficiency of the OMREM over the independence model (IPOM) in complete data and the large biases that can occur in the marginal mean parameters when the dependence is mis-modeled in the presence of MAR missingness.  6. QOL EXAMPLE WITH DROPOUT DUE TO PROGRESSION/DEATH We focus on one QOL measure, fatigue, measured on a 5-point ordinal scale (1, I am usually not tired at all; 2, I am occasionally rather tired; 3, there are frequently periods when I am quite tired; 4, I am usually very tired; 5, I feel exhausted most of the time). Because very few patients reported category 5, we combined categories 4 and 5 into one category. We used 707 subjects without missing data at baseline and focused on two treatments, FOLFOX and IFL (control). To examine treatment differences in fatigue levels, we included the type of treatment, Tx, Tx i = { 0 if subject i is assigned to IFL ( control ) 1 if subject i is assigned to FOLFOX ( active ) } and visit number(TIME=0.0,0.1,...,0.5) re-scaled. The patient's visit corresponds to the time period during which the survey was filled out (0, baseline; 1, 1–84 days after going on study; 2, 85–168 days after going on study;...,; 5, 337–420 days after going on study). We will analyze the data from the first five windows (up to about 1 year). We assumed that the missing responses (mostly due to dropout) were MAR in our initial analysis. In Section 6.2, we more carefully handled the missingness related to the reason for dropping out (including death). The quasi-Newton algorithm is not trivial computationally due to the need to obtain estimates and derivatives of ? it using the Gauss–Hermite quadrature for all subjects and at all times, within each quasi-Newton step. Each quasi-Newton step (in which all the ? it need to be computed) on a Pentium with a 1.6 GHz processor took about 3 min for the OMREM with MC sample size of 10 000 and 40 point Gauss–Hermite quadrature. Using good initial values based on fitting an IPOM in standard software results in a minimal number of iterations until convergence. For example, in our analysis below, we obtained convergence in 20 iterations using a fairly strict convergence criterion, ? ? ^ old ? ? ^ new ? ? 10 ? 4 where ? ^ new and ? ^ old are current and previous estimates of the parameters, respectively. 6.1. Model fit We first fitted three OMREMs and one IPOM under an assumption of ignorable dropout. OMREM-1 allowed the random effects variance to depend on treatment, log ? i = ? 0 + ? 1 × Tx i . OMREM-2 was a simpler model, with a constant variance, log ? i = ? 0. Both had autoregressive variance–covariance structures. OMREM-3 was the OMREM-2 with b it = b i 0 ~ N(0, ? 2). Table II gives the maximum likelihood estimates (MLEs) for all four models. The inferences for some of the coefficients under the IPOM were very different from those for the dependence models. For example, the interaction of treatment and visit was highly significant under the IPOM, indicating an increase in fatigue over time for FOLFOX relative to IFL, whereas the dependence models indicated a non-significant decrease in fatigue over time. Comparison of AIC for IPOM and OMREM-3 indicated that the OMREM-3 fit much better than the IPOM (2561.154 for OMREM-3, 2745.116 for IPOM). Point estimates and standard errors for marginal mean parameters for the OMREM-1 and OMREM-2 were similar. To compare the fit of the two models under ignorability, we computed the likelihood ratio test. Comparison of deviances for OMREM-2 and OMREM-1, which were nested yielded ? D 12 = 2 × (1267.623 – 1266.112) = 3.022, p -value=0.082 on 1 d.f. This comparison indicated that the OMREM-1 did not provide a significantly better fit than the OMREM-2. We also computed the likelihood ratio test to compare OMREM-2 and OMREM-3. The deviance difference was ? D 23 = 2 × (1273.577 – 1267.623) = 11.908 p -value<0.01 on 1 d.f. This indicated that the OMREM-2 fit better than the OMREM-3. The estimate of the correlation parameter ? in OMREM-2 was significant and corresponded to an estimated correlation of ? ^ = exp ( ? ? ^ ) = exp ( ? 0.264 ) = 0.768 . The MLE for ? (exp(1.251)=3.49) indicated large subject-to-subject variation in the odds of the cumulative probability of fatigue. The coefficients of treatment and the interaction of treatment and visit in the marginal mean model were not significant indicating that fatigue (and its trajectory over time) did not differ between the two treatments. 6.2. Dropout due to progression/death QOL responses not measured due to participant death do not exist whereas scheduled measurements due to dropout for other reasons can be viewed as existing but unobserved. If we fit models using methods in Section 4 (as we did in Section 6.1), the missing data due to death are implicitly imputed (under MAR). We outline a PMM approach to address this next. 6.2.1. PMM approach Define S i to be death time for subject i . To address dropout due to death, we can specify the OMREMs conditional on death time, S . The models are given by (13) log P ( Y i t ? k ? x i t , S i = j ) 1 ? P ( Y i t ? k ? x i t , S i = j ) = ? 0 k ( j ) + x i t T ? ( j ) log P ( Y i t ? k ? b i , x i t , S i = j ) 1 ? P ( Y i t ? k ? b i , x i t , S i = j ) = ? i t k ( j ) + b i t ( j ) b i ( j ) T = ( b i 1 ( j ) , … , b i T ( j ) ) ~ N ( 0 , ? i ( j ) ) where x it is a vector of covariates including treatments, j = 1,..., J , and J is the number of patterns ( J ? T ). This approach implicitly assumes that for a given death time (pattern) that missing data before the death time is MAR (conditional on pattern). Now, suppress i without loss of clarity. One target of inference is P ( Y t > k | S > j, x ) [ 25 ], which is recovered from the PMM by summing over the survival distribution [ 38 ], (14) P ( Y t > k ? S > j , x ) = ? g > j P ( Y t > k ? S = g , x ) P ( S = g ? x ) ? l > j P ( S = l ? x ) where P ( Y t > k | S = g, x ) is estimated from (13) and is only defined for t < g . Unfortunately, this approach only uses the ‘survivors’ under each treatment and the corresponding inference is not the causal effect of the treatment. 6.2.2. PMM approach applied A large number of subjects dropped out of this study due to tumor progression or death (41 per cent). Based on consultation with Mayo investigators for assessing QOL, we grouped tumor progression and death together. When the dropout rates due to progression/death are broken down by treatment arms, the rates were marginally higher in the IFL arm. For subjects randomized to the IFL arm, 50 per cent dropped out due to progression/death, whereas 29 per cent dropped out due to progression/death for subjects with the FOLFOX arm (see Table III ). The number of subjects by progression/death windows by treatment groups is given in Table IV . For a subject who dropped out for reason unrelated to death/progression, we still know when the subject died or progressed if it happened before the study ended. For example, if a subject dropped out for reason unrelated to death/progression after the second visit and was alive until the study was finished, the subject belonged to progression/Death window 6. We specify the OMREMs conditional on progression/death time, S as outlined in Section 6.2.1. Due to the small sample sizes when conditioning on individual times, we assumed that the parameters were the same for S =1,...,5 (those who progressed/died before the end of the study) but different for those who did not, S =6. In our analysis here, we compared three models, an OMREM (OMREM-2), an independent proportional odds model (IPOM) under ignorable missingness and a mixture model (PMM) as outlined in Section 6.2.1. In the PMM, the target probabilities given in (14) evaluated at j = 5 correspond to those who did not progress/die before the end of the study. Table V presents the estimated target probabilities on the two treatment arms. Figure 1 indicates MLEs of P ( Y t > k | S >5, Tx) for the PMM and those of P ( Y t > k |Tx) for the MREM (OMREM) and the independent proportional odds model (IPOM) under ignorable missingness, respectively. In the PMM and OMREM, P ( Y t > k | S >5, Tx) and P ( Y t > k |Tx), which, respectively, evaluate the probability of fatigue for those who did not progress/die before the end of study and that for all patients were calculated. In the PMM, the target probabilities for the FOLFOX arm increased over time, whereas that for the IFL arm did not change. However, there were no significant differences over time between the treatment arms. In the OMREM, we have a pattern similar to that in the PMM. In the IPOM, the target probabilities for the FOLFOX were higher than those for the IFL unlike the other models as time increases because the estimate of coefficient of interaction between visit and arm was positive and large compared with those in the other models (1.059 for the IPOM and 0.469 for the OMREM). Because the PMM handled the missingness due to progression/death properly, we focus on the PMM and conclude that patients’ fatigue was not affected by treatment like in the inappropriate ignorable models. However, because we restrict the analyses for the QOL data to subgroup of patients who survived, the resulting treatment comparisons will no longer have a causal interpretation. In the following section, we present a principal stratification approach to address this. 6.2.3. Principal stratification Before defining the causal effect of treatment, we introduce potential outcomes. Potential outcomes are all the outcomes that would be observed if both treatments had been applied to each of the subjects [ 39 – 41 ]. Frangakis and Rubin [ 26 ] used the concept of potential outcomes in an approach called ‘principal stratification’. Principal stratification partitions subjects into sets with respect to post-treatment variables. The principal strata are not affected by treatment assignment and therefore can be used as any pre-treatment covariate. Causal effects are defined within these principal strata. In the following, the post-treatment variable of interest is progression/death. Let Tx be the treatment indicator as defined earlier. Let Y t (Tx), the potential outcome at time t , be an ordinal QOL response. We only observe either Y t (1) or Y t (0) for each subject. Now, let D t (Tx) be tumor progression/death indicator at visit t on treatment Tx, D t ( Tx ) = { 0 alive 1 tumor progressed or dead } Obviously, if D t (Tx) = 1, then D s (Tx) = 1 for s > t . In this case, there are four principal strata defined by the pairs of potential values of D t (Tx): A t (0)={ i |( D t (0), D t (1))=(0,0)}: the subjects who would be alive under both arms at visit t ; A t (1)={ i |( D t (0), D t (1)) = (1,0)}: the subjects who would be alive under the treatment arm but not alive under the control arm at visit t ; A t (2)={ i |( D t (0), D t (1)) = (0,1)}: the subjects who would be alive under control arm but not alive under the treatment arm at visit t ; A t (3)={ i |( D t (0), D t (1)) = (1,1)}: the subjects who would not be alive under either treatment at visit t . As we are interested in subjects who were alive until the end of the study, A t (3) is not of direct interest. The full set of potential outcomes at visit t is P t = { D t ( 0 ) , ( Y t ( 0 ) ; D t ( 0 ) = 0 ) , D t ( 1 ) , ( Y t ( 1 ) ; D t ( 1 ) = 0 ) } = where for treatment tx, Y t (tx) is the potential response if a subject is alive at visit t ( D t (tx) = 0). If the patient is alive ( D it (Tx i )=0), define R it to be the indicator that Y it = Y it (Tx i ) is observed. In the following, we assume monotone dropout ( R it = 1 ? R it –1 = 1). Hence, the observed data for individual i is O i t = { Tx i , D i t , ( R i t ; D i t = 0 ) , ( Y i t ; D i t = 0 , R i t = 1 ) } We formally define the causal effects of interest and then state some additional assumptions that are necessary to estimate them. Suppress i here for clarity and let T be the last visit in the study. We define the causal effect of interest [ 27 ] as SACE k ( 1 , 0 ) = odds { Y T ( 1 ) > k ? ( D T ( 0 ) , D T ( 1 ) ) = ( 0 , 0 ) } odds { Y T ( 0 ) > k ? ( D T ( 0 ) , D T ( 1 ) ) = ( 0 , 0 ) } = odds { Y T ( 1 ) > k ? A T ( 0 ) } odds { Y T ( 0 ) > k ? A T ( 0 ) } SACE k (1,0) is the odds ratios based on the probability that response at time T is larger than k for subjects who would be alive under both treatments between the treatment arm (FOLFOX) and the control arm (IFL). Now, define P ? t = ( P 1 , … , P t ) to be the history of potential outcomes up to and including the outcomes at visit t . We first make the Stable Unit Treatment Value Assumption (SUTVA, [ 40 ]) which states that a patient's potential outcomes are unrelated to the treatment status of other patients. Next, we list the additional assumptions necessary to identify the causal effect of interest: Assumption 1 (Monotonicity) If D t (1) = 1, then D t (0) = 1; if D t (0) = 0, then D t (1) = 0. Assumption 1 assumes that the active treatment is effective. As such, if a patient is alive under the control arm, then the patient will also be alive under the active arm. Note that A t (2) is empty from Assumption 1. Assumption 2 (Ignorability) Tx ? P ? T . Note that P ? t is all the potential outcome up to and including time t . Assumption 2 states that the treatment arm is unrelated to the set of potential outcomes. Assumption 3 R t ? Y t ? P ? t ? 1 . This assumption states that missingness of the outcome is independent of the value of the outcome given all the potential outcome up to and including time t –1. It is similar to an assumption of sequential MAR [ 42 ]. Assumption 4 (Proportional odds) logit P ( Y T ( 1 ) > k ? a 1 ) = ? 0 k ( 1 ) + ? 1 ( 1 ) a 1 where ? 01 ( 1 ) ? ? 02 ( 1 ) ? ? ? ? 0 K ? 1 ( 1 ) and a 1 = { 1 if a subject is in A T ( 1 ) 0 otherwise } This assumption can be re-written as (15) odds ( Y T ( 1 ) > k ? A T ( 1 ) ) odds ( Y T ( 1 ) > k ? A T ( 0 ) ) = e ? 1 ( 1 ) = let ? We use this to reduce the number of sensitivity parameters. This will become apparent in what follows. In general, the goal here is to use the observed data, O t , along with these assumptions to draw inference about SACE. To identify SACE, we need to identify P ( Y T (0)> k | A T (0)) and P ( Y T (1)> k | A T (0)). We provide the details of this identification using Assumptions 1–4 in the Appendix . 6.2.4. Principal stratification applied In our study, even though there is a known survival difference between the groups, differential toxicity between the treatment arms led us to examine QOL in a manner not influenced by the survival difference. The causal estimand of interest, SACE is a function of g T (Tx) and h T ,Tx( k ) (see below and Appendix for more details). For Tx=0, 1, ? i = 1 N ( tx ) 1 ? D i T ? Tx = tx ~ Bin ( N ( tx ) , g T ( tx ) ) where N (tx) is the number of subjects who had the treatment Tx=tx. The estimate of g T (tx) is given by (16) g ^ T ( tx ) = N T ( tx ) ? N ( tx ) where N T (tx) is the number of subjects who were alive after the study was complete under Tx=tx. To define h T ,Tx( k ), we define S to be the progression/death time and specify the OMREM conditional on progression/death time as in (13) . Within this framework, h T ,Tx( k ) is given by (17) h T , Tx ( k ) = P ( Y T > k ? S > T ? 1 , Tx ) = ? j > T ? 1 P ( Y T > k ? S = j , Tx ) P ( S = j ? Tx ) ? j > T ? 1 P ( S = j ? Tx ) where P ( S = j |Tx) is a multinomial mass function for S , and P ( Y T > k | S = j , Tx) is calculated from (14) given Tx and is only defined for t < j . To calculate standard errors for SACE, we use the delta method. The identification of the SACE relies on untestable assumptions. We implemented a sensitivity analysis procedure to draw inference about SACE by varying the sensitivity parameter ? in (15) (see Assumption 4). This is similar to the approach in [ 27 ]. The sensitivity parameter ? is the odds ratio of the probability of fatigue under the FOLFOX arm among the group that is alive under the FOLFOX arm but not alive under the control treatment at visit T when compared with the group that is alive under both arms. A large value of ? means that the probability of fatigue under the FOLFOX arm among patients in stratum A T (1) is higher than that among patients in stratum A T (0). The Mayo investigator told us it was very unlikely that ? was outside the range (0.5,2.0), corresponding to a two-fold or less change in either direction. Thus, we used this as the range for our sensitivity analysis. The causal effect of treatment may be estimated for principal stratum A T (0), patients who would survive to the end of the study period regardless of the treatment. Table IV shows the proportions of patients who were alive after the study was finished (progression/Death window 6). Using the data in Table IV and (16) , the MLEs of g T (·) were g ^ T ( 0 ) = 0.366 and g ^ T ( 1 ) = 0.554 . To estimate SACE K –1(1,0) we also need to estimate P ( D T (0)=0| D T (1)=0), P ( Y T (0)> K –1| A T (0)) and P ( Y T (1)> K –1| A T (0)). All these probabilities are estimable given Assumptions 1–4. The estimate of P ( D T (0)=0| D T (1)=0), the probability of surviving under the control arm given survival under the FOLFOX arm, was 0.661. The estimate of P ( Y T (0)> K –1| A T (0)) was h ^ T , 0 ( K ? 1 ) = 0.087 and P ( Y T (1)> K –1| A T (0)) was h ^ T , 1 ( K ? 1 ) = 0.141 . The estimated values of SACE K –1(1,0) and associated confidence intervals over ? ranging from 0.5 to 2.0 are given in Figure 2 . As ? increased, the estimated values of SACE K –1(1,0) decreased. The estimated values of SACE K –1(1,0) were always larger than 1. This indicated that the probability of a patient's fatigue on the FOLFOX treatment was larger than the probability of a patient's fatigue on the IFL treatment. However, there was no significant difference between the two arms (at 95 per cent level). Thus, we conclude that patients’ fatigue was not affected by the treatment.  6.1. Model fit We first fitted three OMREMs and one IPOM under an assumption of ignorable dropout. OMREM-1 allowed the random effects variance to depend on treatment, log ? i = ? 0 + ? 1 × Tx i . OMREM-2 was a simpler model, with a constant variance, log ? i = ? 0. Both had autoregressive variance–covariance structures. OMREM-3 was the OMREM-2 with b it = b i 0 ~ N(0, ? 2). Table II gives the maximum likelihood estimates (MLEs) for all four models. The inferences for some of the coefficients under the IPOM were very different from those for the dependence models. For example, the interaction of treatment and visit was highly significant under the IPOM, indicating an increase in fatigue over time for FOLFOX relative to IFL, whereas the dependence models indicated a non-significant decrease in fatigue over time. Comparison of AIC for IPOM and OMREM-3 indicated that the OMREM-3 fit much better than the IPOM (2561.154 for OMREM-3, 2745.116 for IPOM). Point estimates and standard errors for marginal mean parameters for the OMREM-1 and OMREM-2 were similar. To compare the fit of the two models under ignorability, we computed the likelihood ratio test. Comparison of deviances for OMREM-2 and OMREM-1, which were nested yielded ? D 12 = 2 × (1267.623 – 1266.112) = 3.022, p -value=0.082 on 1 d.f. This comparison indicated that the OMREM-1 did not provide a significantly better fit than the OMREM-2. We also computed the likelihood ratio test to compare OMREM-2 and OMREM-3. The deviance difference was ? D 23 = 2 × (1273.577 – 1267.623) = 11.908 p -value<0.01 on 1 d.f. This indicated that the OMREM-2 fit better than the OMREM-3. The estimate of the correlation parameter ? in OMREM-2 was significant and corresponded to an estimated correlation of ? ^ = exp ( ? ? ^ ) = exp ( ? 0.264 ) = 0.768 . The MLE for ? (exp(1.251)=3.49) indicated large subject-to-subject variation in the odds of the cumulative probability of fatigue. The coefficients of treatment and the interaction of treatment and visit in the marginal mean model were not significant indicating that fatigue (and its trajectory over time) did not differ between the two treatments.  6.2. Dropout due to progression/death QOL responses not measured due to participant death do not exist whereas scheduled measurements due to dropout for other reasons can be viewed as existing but unobserved. If we fit models using methods in Section 4 (as we did in Section 6.1), the missing data due to death are implicitly imputed (under MAR). We outline a PMM approach to address this next. 6.2.1. PMM approach Define S i to be death time for subject i . To address dropout due to death, we can specify the OMREMs conditional on death time, S . The models are given by (13) log P ( Y i t ? k ? x i t , S i = j ) 1 ? P ( Y i t ? k ? x i t , S i = j ) = ? 0 k ( j ) + x i t T ? ( j ) log P ( Y i t ? k ? b i , x i t , S i = j ) 1 ? P ( Y i t ? k ? b i , x i t , S i = j ) = ? i t k ( j ) + b i t ( j ) b i ( j ) T = ( b i 1 ( j ) , … , b i T ( j ) ) ~ N ( 0 , ? i ( j ) ) where x it is a vector of covariates including treatments, j = 1,..., J , and J is the number of patterns ( J ? T ). This approach implicitly assumes that for a given death time (pattern) that missing data before the death time is MAR (conditional on pattern). Now, suppress i without loss of clarity. One target of inference is P ( Y t > k | S > j, x ) [ 25 ], which is recovered from the PMM by summing over the survival distribution [ 38 ], (14) P ( Y t > k ? S > j , x ) = ? g > j P ( Y t > k ? S = g , x ) P ( S = g ? x ) ? l > j P ( S = l ? x ) where P ( Y t > k | S = g, x ) is estimated from (13) and is only defined for t < g . Unfortunately, this approach only uses the ‘survivors’ under each treatment and the corresponding inference is not the causal effect of the treatment. 6.2.2. PMM approach applied A large number of subjects dropped out of this study due to tumor progression or death (41 per cent). Based on consultation with Mayo investigators for assessing QOL, we grouped tumor progression and death together. When the dropout rates due to progression/death are broken down by treatment arms, the rates were marginally higher in the IFL arm. For subjects randomized to the IFL arm, 50 per cent dropped out due to progression/death, whereas 29 per cent dropped out due to progression/death for subjects with the FOLFOX arm (see Table III ). The number of subjects by progression/death windows by treatment groups is given in Table IV . For a subject who dropped out for reason unrelated to death/progression, we still know when the subject died or progressed if it happened before the study ended. For example, if a subject dropped out for reason unrelated to death/progression after the second visit and was alive until the study was finished, the subject belonged to progression/Death window 6. We specify the OMREMs conditional on progression/death time, S as outlined in Section 6.2.1. Due to the small sample sizes when conditioning on individual times, we assumed that the parameters were the same for S =1,...,5 (those who progressed/died before the end of the study) but different for those who did not, S =6. In our analysis here, we compared three models, an OMREM (OMREM-2), an independent proportional odds model (IPOM) under ignorable missingness and a mixture model (PMM) as outlined in Section 6.2.1. In the PMM, the target probabilities given in (14) evaluated at j = 5 correspond to those who did not progress/die before the end of the study. Table V presents the estimated target probabilities on the two treatment arms. Figure 1 indicates MLEs of P ( Y t > k | S >5, Tx) for the PMM and those of P ( Y t > k |Tx) for the MREM (OMREM) and the independent proportional odds model (IPOM) under ignorable missingness, respectively. In the PMM and OMREM, P ( Y t > k | S >5, Tx) and P ( Y t > k |Tx), which, respectively, evaluate the probability of fatigue for those who did not progress/die before the end of study and that for all patients were calculated. In the PMM, the target probabilities for the FOLFOX arm increased over time, whereas that for the IFL arm did not change. However, there were no significant differences over time between the treatment arms. In the OMREM, we have a pattern similar to that in the PMM. In the IPOM, the target probabilities for the FOLFOX were higher than those for the IFL unlike the other models as time increases because the estimate of coefficient of interaction between visit and arm was positive and large compared with those in the other models (1.059 for the IPOM and 0.469 for the OMREM). Because the PMM handled the missingness due to progression/death properly, we focus on the PMM and conclude that patients’ fatigue was not affected by treatment like in the inappropriate ignorable models. However, because we restrict the analyses for the QOL data to subgroup of patients who survived, the resulting treatment comparisons will no longer have a causal interpretation. In the following section, we present a principal stratification approach to address this. 6.2.3. Principal stratification Before defining the causal effect of treatment, we introduce potential outcomes. Potential outcomes are all the outcomes that would be observed if both treatments had been applied to each of the subjects [ 39 – 41 ]. Frangakis and Rubin [ 26 ] used the concept of potential outcomes in an approach called ‘principal stratification’. Principal stratification partitions subjects into sets with respect to post-treatment variables. The principal strata are not affected by treatment assignment and therefore can be used as any pre-treatment covariate. Causal effects are defined within these principal strata. In the following, the post-treatment variable of interest is progression/death. Let Tx be the treatment indicator as defined earlier. Let Y t (Tx), the potential outcome at time t , be an ordinal QOL response. We only observe either Y t (1) or Y t (0) for each subject. Now, let D t (Tx) be tumor progression/death indicator at visit t on treatment Tx, D t ( Tx ) = { 0 alive 1 tumor progressed or dead } Obviously, if D t (Tx) = 1, then D s (Tx) = 1 for s > t . In this case, there are four principal strata defined by the pairs of potential values of D t (Tx): A t (0)={ i |( D t (0), D t (1))=(0,0)}: the subjects who would be alive under both arms at visit t ; A t (1)={ i |( D t (0), D t (1)) = (1,0)}: the subjects who would be alive under the treatment arm but not alive under the control arm at visit t ; A t (2)={ i |( D t (0), D t (1)) = (0,1)}: the subjects who would be alive under control arm but not alive under the treatment arm at visit t ; A t (3)={ i |( D t (0), D t (1)) = (1,1)}: the subjects who would not be alive under either treatment at visit t . As we are interested in subjects who were alive until the end of the study, A t (3) is not of direct interest. The full set of potential outcomes at visit t is P t = { D t ( 0 ) , ( Y t ( 0 ) ; D t ( 0 ) = 0 ) , D t ( 1 ) , ( Y t ( 1 ) ; D t ( 1 ) = 0 ) } = where for treatment tx, Y t (tx) is the potential response if a subject is alive at visit t ( D t (tx) = 0). If the patient is alive ( D it (Tx i )=0), define R it to be the indicator that Y it = Y it (Tx i ) is observed. In the following, we assume monotone dropout ( R it = 1 ? R it –1 = 1). Hence, the observed data for individual i is O i t = { Tx i , D i t , ( R i t ; D i t = 0 ) , ( Y i t ; D i t = 0 , R i t = 1 ) } We formally define the causal effects of interest and then state some additional assumptions that are necessary to estimate them. Suppress i here for clarity and let T be the last visit in the study. We define the causal effect of interest [ 27 ] as SACE k ( 1 , 0 ) = odds { Y T ( 1 ) > k ? ( D T ( 0 ) , D T ( 1 ) ) = ( 0 , 0 ) } odds { Y T ( 0 ) > k ? ( D T ( 0 ) , D T ( 1 ) ) = ( 0 , 0 ) } = odds { Y T ( 1 ) > k ? A T ( 0 ) } odds { Y T ( 0 ) > k ? A T ( 0 ) } SACE k (1,0) is the odds ratios based on the probability that response at time T is larger than k for subjects who would be alive under both treatments between the treatment arm (FOLFOX) and the control arm (IFL). Now, define P ? t = ( P 1 , … , P t ) to be the history of potential outcomes up to and including the outcomes at visit t . We first make the Stable Unit Treatment Value Assumption (SUTVA, [ 40 ]) which states that a patient's potential outcomes are unrelated to the treatment status of other patients. Next, we list the additional assumptions necessary to identify the causal effect of interest: Assumption 1 (Monotonicity) If D t (1) = 1, then D t (0) = 1; if D t (0) = 0, then D t (1) = 0. Assumption 1 assumes that the active treatment is effective. As such, if a patient is alive under the control arm, then the patient will also be alive under the active arm. Note that A t (2) is empty from Assumption 1. Assumption 2 (Ignorability) Tx ? P ? T . Note that P ? t is all the potential outcome up to and including time t . Assumption 2 states that the treatment arm is unrelated to the set of potential outcomes. Assumption 3 R t ? Y t ? P ? t ? 1 . This assumption states that missingness of the outcome is independent of the value of the outcome given all the potential outcome up to and including time t –1. It is similar to an assumption of sequential MAR [ 42 ]. Assumption 4 (Proportional odds) logit P ( Y T ( 1 ) > k ? a 1 ) = ? 0 k ( 1 ) + ? 1 ( 1 ) a 1 where ? 01 ( 1 ) ? ? 02 ( 1 ) ? ? ? ? 0 K ? 1 ( 1 ) and a 1 = { 1 if a subject is in A T ( 1 ) 0 otherwise } This assumption can be re-written as (15) odds ( Y T ( 1 ) > k ? A T ( 1 ) ) odds ( Y T ( 1 ) > k ? A T ( 0 ) ) = e ? 1 ( 1 ) = let ? We use this to reduce the number of sensitivity parameters. This will become apparent in what follows. In general, the goal here is to use the observed data, O t , along with these assumptions to draw inference about SACE. To identify SACE, we need to identify P ( Y T (0)> k | A T (0)) and P ( Y T (1)> k | A T (0)). We provide the details of this identification using Assumptions 1–4 in the Appendix . 6.2.4. Principal stratification applied In our study, even though there is a known survival difference between the groups, differential toxicity between the treatment arms led us to examine QOL in a manner not influenced by the survival difference. The causal estimand of interest, SACE is a function of g T (Tx) and h T ,Tx( k ) (see below and Appendix for more details). For Tx=0, 1, ? i = 1 N ( tx ) 1 ? D i T ? Tx = tx ~ Bin ( N ( tx ) , g T ( tx ) ) where N (tx) is the number of subjects who had the treatment Tx=tx. The estimate of g T (tx) is given by (16) g ^ T ( tx ) = N T ( tx ) ? N ( tx ) where N T (tx) is the number of subjects who were alive after the study was complete under Tx=tx. To define h T ,Tx( k ), we define S to be the progression/death time and specify the OMREM conditional on progression/death time as in (13) . Within this framework, h T ,Tx( k ) is given by (17) h T , Tx ( k ) = P ( Y T > k ? S > T ? 1 , Tx ) = ? j > T ? 1 P ( Y T > k ? S = j , Tx ) P ( S = j ? Tx ) ? j > T ? 1 P ( S = j ? Tx ) where P ( S = j |Tx) is a multinomial mass function for S , and P ( Y T > k | S = j , Tx) is calculated from (14) given Tx and is only defined for t < j . To calculate standard errors for SACE, we use the delta method. The identification of the SACE relies on untestable assumptions. We implemented a sensitivity analysis procedure to draw inference about SACE by varying the sensitivity parameter ? in (15) (see Assumption 4). This is similar to the approach in [ 27 ]. The sensitivity parameter ? is the odds ratio of the probability of fatigue under the FOLFOX arm among the group that is alive under the FOLFOX arm but not alive under the control treatment at visit T when compared with the group that is alive under both arms. A large value of ? means that the probability of fatigue under the FOLFOX arm among patients in stratum A T (1) is higher than that among patients in stratum A T (0). The Mayo investigator told us it was very unlikely that ? was outside the range (0.5,2.0), corresponding to a two-fold or less change in either direction. Thus, we used this as the range for our sensitivity analysis. The causal effect of treatment may be estimated for principal stratum A T (0), patients who would survive to the end of the study period regardless of the treatment. Table IV shows the proportions of patients who were alive after the study was finished (progression/Death window 6). Using the data in Table IV and (16) , the MLEs of g T (·) were g ^ T ( 0 ) = 0.366 and g ^ T ( 1 ) = 0.554 . To estimate SACE K –1(1,0) we also need to estimate P ( D T (0)=0| D T (1)=0), P ( Y T (0)> K –1| A T (0)) and P ( Y T (1)> K –1| A T (0)). All these probabilities are estimable given Assumptions 1–4. The estimate of P ( D T (0)=0| D T (1)=0), the probability of surviving under the control arm given survival under the FOLFOX arm, was 0.661. The estimate of P ( Y T (0)> K –1| A T (0)) was h ^ T , 0 ( K ? 1 ) = 0.087 and P ( Y T (1)> K –1| A T (0)) was h ^ T , 1 ( K ? 1 ) = 0.141 . The estimated values of SACE K –1(1,0) and associated confidence intervals over ? ranging from 0.5 to 2.0 are given in Figure 2 . As ? increased, the estimated values of SACE K –1(1,0) decreased. The estimated values of SACE K –1(1,0) were always larger than 1. This indicated that the probability of a patient's fatigue on the FOLFOX treatment was larger than the probability of a patient's fatigue on the IFL treatment. However, there was no significant difference between the two arms (at 95 per cent level). Thus, we conclude that patients’ fatigue was not affected by the treatment.  6.2.1. PMM approach Define S i to be death time for subject i . To address dropout due to death, we can specify the OMREMs conditional on death time, S . The models are given by (13) log P ( Y i t ? k ? x i t , S i = j ) 1 ? P ( Y i t ? k ? x i t , S i = j ) = ? 0 k ( j ) + x i t T ? ( j ) log P ( Y i t ? k ? b i , x i t , S i = j ) 1 ? P ( Y i t ? k ? b i , x i t , S i = j ) = ? i t k ( j ) + b i t ( j ) b i ( j ) T = ( b i 1 ( j ) , … , b i T ( j ) ) ~ N ( 0 , ? i ( j ) ) where x it is a vector of covariates including treatments, j = 1,..., J , and J is the number of patterns ( J ? T ). This approach implicitly assumes that for a given death time (pattern) that missing data before the death time is MAR (conditional on pattern). Now, suppress i without loss of clarity. One target of inference is P ( Y t > k | S > j, x ) [ 25 ], which is recovered from the PMM by summing over the survival distribution [ 38 ], (14) P ( Y t > k ? S > j , x ) = ? g > j P ( Y t > k ? S = g , x ) P ( S = g ? x ) ? l > j P ( S = l ? x ) where P ( Y t > k | S = g, x ) is estimated from (13) and is only defined for t < g . Unfortunately, this approach only uses the ‘survivors’ under each treatment and the corresponding inference is not the causal effect of the treatment.  6.2.2. PMM approach applied A large number of subjects dropped out of this study due to tumor progression or death (41 per cent). Based on consultation with Mayo investigators for assessing QOL, we grouped tumor progression and death together. When the dropout rates due to progression/death are broken down by treatment arms, the rates were marginally higher in the IFL arm. For subjects randomized to the IFL arm, 50 per cent dropped out due to progression/death, whereas 29 per cent dropped out due to progression/death for subjects with the FOLFOX arm (see Table III ). The number of subjects by progression/death windows by treatment groups is given in Table IV . For a subject who dropped out for reason unrelated to death/progression, we still know when the subject died or progressed if it happened before the study ended. For example, if a subject dropped out for reason unrelated to death/progression after the second visit and was alive until the study was finished, the subject belonged to progression/Death window 6. We specify the OMREMs conditional on progression/death time, S as outlined in Section 6.2.1. Due to the small sample sizes when conditioning on individual times, we assumed that the parameters were the same for S =1,...,5 (those who progressed/died before the end of the study) but different for those who did not, S =6. In our analysis here, we compared three models, an OMREM (OMREM-2), an independent proportional odds model (IPOM) under ignorable missingness and a mixture model (PMM) as outlined in Section 6.2.1. In the PMM, the target probabilities given in (14) evaluated at j = 5 correspond to those who did not progress/die before the end of the study. Table V presents the estimated target probabilities on the two treatment arms. Figure 1 indicates MLEs of P ( Y t > k | S >5, Tx) for the PMM and those of P ( Y t > k |Tx) for the MREM (OMREM) and the independent proportional odds model (IPOM) under ignorable missingness, respectively. In the PMM and OMREM, P ( Y t > k | S >5, Tx) and P ( Y t > k |Tx), which, respectively, evaluate the probability of fatigue for those who did not progress/die before the end of study and that for all patients were calculated. In the PMM, the target probabilities for the FOLFOX arm increased over time, whereas that for the IFL arm did not change. However, there were no significant differences over time between the treatment arms. In the OMREM, we have a pattern similar to that in the PMM. In the IPOM, the target probabilities for the FOLFOX were higher than those for the IFL unlike the other models as time increases because the estimate of coefficient of interaction between visit and arm was positive and large compared with those in the other models (1.059 for the IPOM and 0.469 for the OMREM). Because the PMM handled the missingness due to progression/death properly, we focus on the PMM and conclude that patients’ fatigue was not affected by treatment like in the inappropriate ignorable models. However, because we restrict the analyses for the QOL data to subgroup of patients who survived, the resulting treatment comparisons will no longer have a causal interpretation. In the following section, we present a principal stratification approach to address this.  6.2.3. Principal stratification Before defining the causal effect of treatment, we introduce potential outcomes. Potential outcomes are all the outcomes that would be observed if both treatments had been applied to each of the subjects [ 39 – 41 ]. Frangakis and Rubin [ 26 ] used the concept of potential outcomes in an approach called ‘principal stratification’. Principal stratification partitions subjects into sets with respect to post-treatment variables. The principal strata are not affected by treatment assignment and therefore can be used as any pre-treatment covariate. Causal effects are defined within these principal strata. In the following, the post-treatment variable of interest is progression/death. Let Tx be the treatment indicator as defined earlier. Let Y t (Tx), the potential outcome at time t , be an ordinal QOL response. We only observe either Y t (1) or Y t (0) for each subject. Now, let D t (Tx) be tumor progression/death indicator at visit t on treatment Tx, D t ( Tx ) = { 0 alive 1 tumor progressed or dead } Obviously, if D t (Tx) = 1, then D s (Tx) = 1 for s > t . In this case, there are four principal strata defined by the pairs of potential values of D t (Tx): A t (0)={ i |( D t (0), D t (1))=(0,0)}: the subjects who would be alive under both arms at visit t ; A t (1)={ i |( D t (0), D t (1)) = (1,0)}: the subjects who would be alive under the treatment arm but not alive under the control arm at visit t ; A t (2)={ i |( D t (0), D t (1)) = (0,1)}: the subjects who would be alive under control arm but not alive under the treatment arm at visit t ; A t (3)={ i |( D t (0), D t (1)) = (1,1)}: the subjects who would not be alive under either treatment at visit t . As we are interested in subjects who were alive until the end of the study, A t (3) is not of direct interest. The full set of potential outcomes at visit t is P t = { D t ( 0 ) , ( Y t ( 0 ) ; D t ( 0 ) = 0 ) , D t ( 1 ) , ( Y t ( 1 ) ; D t ( 1 ) = 0 ) } = where for treatment tx, Y t (tx) is the potential response if a subject is alive at visit t ( D t (tx) = 0). If the patient is alive ( D it (Tx i )=0), define R it to be the indicator that Y it = Y it (Tx i ) is observed. In the following, we assume monotone dropout ( R it = 1 ? R it –1 = 1). Hence, the observed data for individual i is O i t = { Tx i , D i t , ( R i t ; D i t = 0 ) , ( Y i t ; D i t = 0 , R i t = 1 ) } We formally define the causal effects of interest and then state some additional assumptions that are necessary to estimate them. Suppress i here for clarity and let T be the last visit in the study. We define the causal effect of interest [ 27 ] as SACE k ( 1 , 0 ) = odds { Y T ( 1 ) > k ? ( D T ( 0 ) , D T ( 1 ) ) = ( 0 , 0 ) } odds { Y T ( 0 ) > k ? ( D T ( 0 ) , D T ( 1 ) ) = ( 0 , 0 ) } = odds { Y T ( 1 ) > k ? A T ( 0 ) } odds { Y T ( 0 ) > k ? A T ( 0 ) } SACE k (1,0) is the odds ratios based on the probability that response at time T is larger than k for subjects who would be alive under both treatments between the treatment arm (FOLFOX) and the control arm (IFL). Now, define P ? t = ( P 1 , … , P t ) to be the history of potential outcomes up to and including the outcomes at visit t . We first make the Stable Unit Treatment Value Assumption (SUTVA, [ 40 ]) which states that a patient's potential outcomes are unrelated to the treatment status of other patients. Next, we list the additional assumptions necessary to identify the causal effect of interest:  Assumption 1 (Monotonicity) If D t (1) = 1, then D t (0) = 1; if D t (0) = 0, then D t (1) = 0. Assumption 1 assumes that the active treatment is effective. As such, if a patient is alive under the control arm, then the patient will also be alive under the active arm. Note that A t (2) is empty from Assumption 1.  Assumption 2 (Ignorability) Tx ? P ? T . Note that P ? t is all the potential outcome up to and including time t . Assumption 2 states that the treatment arm is unrelated to the set of potential outcomes.  Assumption 3 R t ? Y t ? P ? t ? 1 . This assumption states that missingness of the outcome is independent of the value of the outcome given all the potential outcome up to and including time t –1. It is similar to an assumption of sequential MAR [ 42 ].  Assumption 4 (Proportional odds) logit P ( Y T ( 1 ) > k ? a 1 ) = ? 0 k ( 1 ) + ? 1 ( 1 ) a 1 where ? 01 ( 1 ) ? ? 02 ( 1 ) ? ? ? ? 0 K ? 1 ( 1 ) and a 1 = { 1 if a subject is in A T ( 1 ) 0 otherwise } This assumption can be re-written as (15) odds ( Y T ( 1 ) > k ? A T ( 1 ) ) odds ( Y T ( 1 ) > k ? A T ( 0 ) ) = e ? 1 ( 1 ) = let ? We use this to reduce the number of sensitivity parameters. This will become apparent in what follows. In general, the goal here is to use the observed data, O t , along with these assumptions to draw inference about SACE. To identify SACE, we need to identify P ( Y T (0)> k | A T (0)) and P ( Y T (1)> k | A T (0)). We provide the details of this identification using Assumptions 1–4 in the Appendix .  6.2.4. Principal stratification applied In our study, even though there is a known survival difference between the groups, differential toxicity between the treatment arms led us to examine QOL in a manner not influenced by the survival difference. The causal estimand of interest, SACE is a function of g T (Tx) and h T ,Tx( k ) (see below and Appendix for more details). For Tx=0, 1, ? i = 1 N ( tx ) 1 ? D i T ? Tx = tx ~ Bin ( N ( tx ) , g T ( tx ) ) where N (tx) is the number of subjects who had the treatment Tx=tx. The estimate of g T (tx) is given by (16) g ^ T ( tx ) = N T ( tx ) ? N ( tx ) where N T (tx) is the number of subjects who were alive after the study was complete under Tx=tx. To define h T ,Tx( k ), we define S to be the progression/death time and specify the OMREM conditional on progression/death time as in (13) . Within this framework, h T ,Tx( k ) is given by (17) h T , Tx ( k ) = P ( Y T > k ? S > T ? 1 , Tx ) = ? j > T ? 1 P ( Y T > k ? S = j , Tx ) P ( S = j ? Tx ) ? j > T ? 1 P ( S = j ? Tx ) where P ( S = j |Tx) is a multinomial mass function for S , and P ( Y T > k | S = j , Tx) is calculated from (14) given Tx and is only defined for t < j . To calculate standard errors for SACE, we use the delta method. The identification of the SACE relies on untestable assumptions. We implemented a sensitivity analysis procedure to draw inference about SACE by varying the sensitivity parameter ? in (15) (see Assumption 4). This is similar to the approach in [ 27 ]. The sensitivity parameter ? is the odds ratio of the probability of fatigue under the FOLFOX arm among the group that is alive under the FOLFOX arm but not alive under the control treatment at visit T when compared with the group that is alive under both arms. A large value of ? means that the probability of fatigue under the FOLFOX arm among patients in stratum A T (1) is higher than that among patients in stratum A T (0). The Mayo investigator told us it was very unlikely that ? was outside the range (0.5,2.0), corresponding to a two-fold or less change in either direction. Thus, we used this as the range for our sensitivity analysis. The causal effect of treatment may be estimated for principal stratum A T (0), patients who would survive to the end of the study period regardless of the treatment. Table IV shows the proportions of patients who were alive after the study was finished (progression/Death window 6). Using the data in Table IV and (16) , the MLEs of g T (·) were g ^ T ( 0 ) = 0.366 and g ^ T ( 1 ) = 0.554 . To estimate SACE K –1(1,0) we also need to estimate P ( D T (0)=0| D T (1)=0), P ( Y T (0)> K –1| A T (0)) and P ( Y T (1)> K –1| A T (0)). All these probabilities are estimable given Assumptions 1–4. The estimate of P ( D T (0)=0| D T (1)=0), the probability of surviving under the control arm given survival under the FOLFOX arm, was 0.661. The estimate of P ( Y T (0)> K –1| A T (0)) was h ^ T , 0 ( K ? 1 ) = 0.087 and P ( Y T (1)> K –1| A T (0)) was h ^ T , 1 ( K ? 1 ) = 0.141 . The estimated values of SACE K –1(1,0) and associated confidence intervals over ? ranging from 0.5 to 2.0 are given in Figure 2 . As ? increased, the estimated values of SACE K –1(1,0) decreased. The estimated values of SACE K –1(1,0) were always larger than 1. This indicated that the probability of a patient's fatigue on the FOLFOX treatment was larger than the probability of a patient's fatigue on the IFL treatment. However, there was no significant difference between the two arms (at 95 per cent level). Thus, we conclude that patients’ fatigue was not affected by the treatment.  7. CONCLUSION We have proposed MREMs for longitudinal ordinal data that directly model marginal probabilities as a function of covariates while accounting for the longitudinal correlation via random effects. To evaluate the marginalized likelihood, we used Monte Carlo integration. Parameter estimation was based on ML using a quasi-Newton algorithm. As discussed in Section 6, about 40 per cent of the patients dropped out due to tumor progression or death. We adjusted for this using a pattern mixture approach with patterns defined based on the observed progression/death times and then using a principal stratification approach to estimate treatment effects. We plan on extending this to a fully Bayesian approach and as such, using informative priors for the sensitivity parameters to obtain a single inference that characterizes our uncertainty about the sensitivity parameters. We also will consider an extension to three treatments (two active and one placebo) and a weakening of the monotonicity assumptions. We can extend marginalized ordinal models to allow both serial dependence via a Markov structure and random effects [ 43 ]. These models are particularly useful in longitudinal analyses with a moderate to large number of repeated measurements per subject. We are also working on extensions to multivariate longitudinal ordinal responses which would be applicable to QOL data [ 44 ].  A.1. Proof of Theorem 1 We know that ? 01<···< ? 0 K –1 implies that P i t k ? 1 M < P i t k M where P i t k M = ? P ( Y i t ? k ? b i t , x i ) f ( b i t ) d b i t Hence, ? P ( Y i t ? k ? b i t , x i ) f ( b i t ) d b i t > ? P ( Y i t ? k ? 1 ? b i t , x i ) f ( b i t ) d b i t for all k . We can rewrite this as (A1) ? ( e ? i t k + b i t 1 + e ? i t k + b i t ? e ? i t k ? 1 + b i t 1 + e ? i t k ? 1 + b i t ) f ( b i t ) d b i t > 0 We now claim that ? itk >? itk –1 for all k . We will show that if it is not true (i.e, ? itk ?? itk –1 for some k ), then condition (A1) cannot be satisfied. If ? itk = ? itk –1 for some k , then the left-hand side term of (A1) is zero. This is a contradiction to (A1) . If ? itk < ? itk –1 for some k , then let ? itk –1 = ? itk + ? for some ? >0. Therefore, (A1) is given by 0 < ? ( e ? i t k + b i t 1 + e ? i t k + b i t ? e ? i t k + ? + b i t 1 + e ? i t k + ? + b i t ) f ( b i t ) d b i t = ? e ? i t k ( e b i t ? e ? e b i t ) ( 1 + e ? i t k + b i t ) ( 1 + e ? e ? i t k + b i t ) f ( b i t ) d b i t ? ? e ? i t k ( e b i t ? e ? e b i t ) f ( b i t ) d b i t = e ? i t k ? e b i t ( 1 ? e ? ) f ( b i t ) d b i t As E b { e b i t ( 1 ? e ? ) } < 0 , this is a contradiction to (A1) .  A.2. Detailed calculations of quasi-Newton under ignorability The contribution of subject i to the log likelihood is given by log L ( ? ; y i ) = log ? ? t = 1 n i ? k = 1 K ( P i t k c ( a i ) ? P i t k ? 1 c ( a i ) ) y i t k ? ( a i ) d a i = log ? exp [ { ? t = 1 T ? k = 1 K ? 1 ( R i t k ? i t k ? R i t k + 1 g ( ? i t k ) ) } ] ? ( a i ) d a i where R i t k = Y i t 1 + ? + Y i t k , ? i t k = log ( P i t k c ? P i t k + 1 c ? P i t k c ) , and g ( a ) = log { 1 + exp ( a ) } . The forms of the derivatives for quasi-Newton algorithm are ? log L ? ? 0 j = ? i = 1 N L ( ? ; y i ) ? 1 ? L ( ? , a i ? y i ) { ? t = 1 n i ? k = 1 K ? 1 ( R i t k ? R i t k + 1 e ? i t k 1 + e ? i t k ) } × { ( ? ? i t k ? P i t k c ( a i ) ? P i t k c ( a i ) ? ? i t k ? ? i t k ? ? 0 j + ? ? i t k ? P i t k + 1 c ( a i ) ? P i t k + 1 c ( a i ) ? ? i t k + 1 ? ? i t k + 1 ? ? 0 j ) } ? ( a i ) d a i ? log L ? ? = ? i = 1 N L ( ? ; y i ) ? 1 ? L ( ? , a i ? y i ) { ? t = 1 n i ? k = 1 K ? 1 ( R i t k ? R i t k + 1 e ? i t k 1 + e ? i t k ) } × { ( ? ? i t k ? P i t k c ( a i ) ? P i t k c ( a i ) ? ? i t k ? ? i t k ? ? + ? ? i t k ? P i t k + 1 c ( a i ) ? P i t k + 1 c ( a i ) ? ? i t k + 1 ? ? i t k + 1 ? ? ) } ? ( a i ) d a i ? log L ? ? = ? i = 1 N L ( ? ; y i ) ? 1 ? L ( ? , a i ? y i ) [ ? t = 1 n i ? k = 1 K ? 1 ( R i t k ? R i t k + 1 e ? i t k 1 + e ? i t k ) ] × { ? ? i t k ? P i t k c ( a i ) ( ? P i t k c ( a i ) ? ? i t k ? ? i t k ? ? + P i t k c ( a i ) ( 1 ? P i t k c ( a i ) ) s ( t ) a i z i ) } + [ { ? ? i t k ? P i t k + 1 c ( a i ) ( ? P i t k + 1 c ( a i ) ? ? i t k + 1 ? ? i t k + 1 ? ? + P i t k c ( a i ) ( 1 ? P i t k c ( a i ) ) s ( t ) a i z i ) } ] ? ( a i ) d a i ? log L ? ? = ? i = 1 N L ( ? ; y i ) ? 1 ? L ( ? , a i ? y i ) [ ? t = 1 n i ? k = 1 K ? 1 ( R i t k ? R i t k + 1 e ? i t k 1 + e ? i t k ) ] × { ? ? i t k ? P i t k c ( a i ) P i t k c ( a i ) ( 1 ? P i t k c ( a i ) ) ? i ? s ( t ) ? ? } a i [ { + ? ? i t k ? P i t k + 1 c ( a i ) P i t k c ( a i ) ( 1 ? P i t k c ( a i ) ) ? i ? s ( t ) ? ? a i } ] ? ( a i ) d a i where L (?, a i | y i ) is given by (10) and reexpressed as L ( ? , a i ? y i ) = exp [ { ? t = 1 T ? k = 1 K ? 1 ( R i t k ? i t k ? R i t k + 1 g ( ? i t k ) ) } ] for j = 1,..., K –1. The integrals are estimated using Monte Carlo integration. We simply generate 10 000 random vectors from multivariate standard normal distributions to compute the integrals. To make the derivatives simpler, (8) can be reexpressed as (A2) P i t k M = ? P i t k c ( ? i a ) ? ( a ) d a where ? (·) is the standard normal density function. Note that the integral in (A2) is one dimensional. To compute the score vector and information matrix, we also need derivatives of ? it with respect to ? 0, ? and ? . They can be obtained from relationship (A2) , ? P i t k M ? ? = ? ? P i t k c ( ? i a ) ? ? i t k ? ? i t k ? ? ? ( a ) d a ? ? ? i t k ? ? = ? P i t k B ? ? ? ? ? P i t k c ( ? i a ) ? ? i t k ? ( a ) d a Similarly, we have ? ? i t k ? ? 0 j = ? P i t k M ? ? ? 0 j ? ? P i t k c ( ? i a ) ? ? i t k ? ( a ) d a ? ? i t k ? ? = ? ? P i t k c ( ? i a ) ( 1 ? P i t k c ( ? i a ) ) a ? i z i ? ( a ) d a ? ? P i t k c ( ? i a ) ? ? i t k ? ( a ) d a  A.3. Identification of the causal effects Based on observed data and Assumptions 1–4 in Section 6.2.3, we show how to estimate the causal effects SACE. Assumption 1 implies that P ( Y t ( tx ) > k ? A t ( 0 ) ) = P ( Y t ( tx ) > k ? D t ( 0 ) = 0 ) for tx=0,1. Assumption 2 implies that (A3) P ( D t ( tx ) = 0 ) = P ( D t = 0 ? Tx = tx ) = let g t ( tx ) and P ( Y t ( tx ) > k ? D t ( tx ) = 0 , D ? t ? 1 ( tx ) ) = P ( Y t > k ? D t = 0 , D ? t ? 1 , Tx = tx ) for tx=0,1. From Assumptions 2 and 3, we have that P ( Y t ( tx ) > k ? D t ( tx ) = 0 , D ? t ? 1 ( tx ) ) = P ( Y t > k ? D t = 0 , D ? t ? 1 , Tx = tx , R t = 1 ) = P ( Y t > k ? D t = 0 , D t ? 1 , Tx = tx , R t = 1 ) and P ( Y t ( tx ) > k ? D t ( tx ) = 0 ) = P ( Y t > k ? D t = 0 , Tx = tx , R t = 1 ) = let h t , tx ( k ) for tx=0,1. Recall we need to estimate P ( Y T (1)> k | A T (0)) to estimate SACE k (1,0). To do this, we show that P ( Y T (1)> k | D T (1)=0) can be expressed as (A4) P ( Y T ( 1 ) > k ? D T ( 1 ) = 0 ) = P ( Y T ( 1 ) > k ? A T ( 0 ) ) P ( A T ( 0 ) ? D T ( 1 ) = 0 ) + P ( Y T ( 1 ) > k ? A T ( 1 ) ) P ( A T ( 1 ) ? D T ( 1 ) = 0 ) = P ( Y T ( 1 ) > k ? A T ( 0 ) ) P ( D T ( 0 ) = 0 , D T ( 1 ) = 0 ? D T ( 1 ) = 0 ) + P ( Y T ( 1 ) > k ? A T ( 1 ) ) P ( D T ( 0 ) = 1 , D T ( 1 ) = 0 ? D T ( 1 ) = 0 ) = P ( Y T ( 1 ) > k ? A T ( 0 ) ) P ( D T ( 0 ) = 0 ? D T ( 1 ) = 0 ) + P ( Y T ( 1 ) > k ? A T ( 1 ) ) P ( D T ( 0 ) = 1 ? D T ( 1 ) = 0 ) The original expressions P ( Y T (tx)> k | D T (tx)=0) for tx=0,1 are identifiable. However, only some of the factors in (A4) are identified. The mixing probabilities, P ( D T (0)=0| D T (1)=0) and P ( D T (0)=1| D T (1)=0), are identifiable by (A3) as P ( D T ( 0 ) = 0 ? D T ( 1 ) = 0 ) = g T ( 0 ) g T ( 1 ) P ( D T ( 0 ) = 1 ? D T ( 1 ) = 0 ) = 1 ? P ( D T ( 0 ) = 0 ? D T ( 1 ) = 0 ) However, P ( Y T (1)> k | A T (0)) and P ( Y T (1)> k | A T (1)) in (A4) are not identified. Given the identified components, to identify these unidentified quantities, we only need to know their ratios. All three ratios are identified via Assumption 4, (A5) odds ( Y T ( 1 ) > k ? A T ( 1 ) ) odds ( Y T ( 1 ) > k ? A T ( 0 ) ) = e ? 1 ( 1 ) = let ? From (A4) and (15) , we can identify P ( Y T (1)> k | A T (0)) by solving the following quadratic equation: g T ( 0 ) ( 1 ? ? ) x 2 ? { ( 1 ? ? ) ( g T ( 0 ) + h T , 1 ( k ) g T ( 1 ) ) + ? g T ( 1 ) } x + h T , 1 ( 1 ) = 0 where x = P ( Y T (1)> k | A T (0)). When ? =1, P ( Y T ( 1 ) > k ? A T ( 0 ) ) = h T , 1 ( k ) When ? ? 1 , we have P ( Y T ( 1 ) > k ? A T ( 0 ) ) = ? b ( ? ) + b 2 ( ? ) ? 4 a ( ? ) c ( 1 ) 2 a ( ? ) where a ( ? ) = (1– ? ) g T (0), b ( ? ) = ( ? –1)( h T ,1( k ) g T (1)+ g T (0))– ?g T (1), and c (1) = h T ,1( k ) g T (1). Note that the solution is a decreasing function of ? .  Figures and Tables Figure 1 Maximum likelihood estimates of P ( Y t > k | S >5, Tx) for the pattern mixture model (PMM) and those of P ( Y t > k |Tx) for the marginalized random effects model (OMREM) and the independent proportional odds model (IPOM) under ignorable missingness, respectively, and 95 per cent confidence intervals, where S is progression/death time. P ( Y t > k | S >5, Tx) evaluates the probability of fatigue for those who did not progress/die before the end of study. Solid line is for IFL; dashed line is for FOLFOX. ?, ?, and ? are for k = 3, 2, 1, respectively. (a) PMM for k = 1, 2, 3; (b) OMREM for k = 1, 2, 3; and (c) IPOM for k = 1, 2, 3. Figure 2 SACE K –1(1,0) as a function of ? (Solid line). Dashed lines are 95 per cent confidence intervals. Table I Bias of maximum likelihood estimators. Complete data MAR dropout OMREM IPOM OMREM IPOM Parameter Truth Mean MSE Mean MSE Mean MSE Mean MSE ? 01 –1.00 –0.99 0.01 –0.99 0.01 –1.01 0.01 –0.98 0.02 (–1.00, –0.98) (–1.00, –0.98) (–1.02, –0.99) (–0.99, –0.97) ? 02 0.50 0.51 0.01 0.51 0.01 0.49 0.01 0.51 0.01 (0.50, 0.51) (0.50, 0.52) (0.48, 0.50) (0.50, 0.52) ? 03 1.00 1.00 0.00 1.00 0.00 0.99 0.01 1.01 0.01 (0.99, 1.01) (1.00, 1.01) (0.98, 1.00) (1.00, 1.02) ? 1 (Time) –0.50 –0.51 0.01 –0.52 0.02 –0.48 0.02 –0.33 0.17 (–0.53, –0.49) (–0.54, –0.50) (–0.52, –0.45) (–0.36, –0.30) ? 2 0.50 0.50 0.00 0.51 0.01 0.51 0.01 0.47 0.03 (0.49, 0.51) (0.49, 0.52) (0.49, 0.52) (0.46, 0.48) Displayed are the average regression coefficient estimates, the MSE and 95 per cent Monte Carlo error interval ( ? ? ± 1.96 var ( ? ? ) ? 500 ) . The true conditional probabilities were specified with ? i =1.1 and ? =0.2 if group i =0; ? i =1.5 and ? =0.2 if group i =1. The fitted conditional probabilities were specified with random effects, b i ~ N ( 0 , ? i 2 ? ? ) with log ? i = ? 1+group i? 2 for the OMREM. Table II Maximum likelihood estimates for marginalized random effects models under ignorable missingness. OMREM-1 OMREM-2 OMREM-3 IPOM Mean parameters Int1 –1.099 * (0.126) –1.093 * (0.126) –1.119 * (0.124) –1.163 (0.636) Int2 0.839 * (0.126) 0.839 * (0.127) 0.816 * (0.123) 0.796 * (0.149) Int3 2.280 * (0.160) 2.277 * (0.160) 2.261 * (0.156) 2.277 * (0.982) Visit –0.334 (0.620) –0.367 (0.609) –0.166 (0.472) –0.424 * (0.113) Tx –0.073 (0.168) –0.072 (0.167) –0.069 (0.161) –0.003 (0.039) Visit × Tx –0.607 (0.922) –0.469 (0.917) –0.541 (0.725) 1.059 * (0.063) Dependence parameters Int 1 .086 * (0.634) 1.251 (0.816) 0.664 * (0.144) Tx 0.280 (0.897) ? 0.243 * (0.076) 0.264 * (0.081) Max. log L –1266.112 –1267.623 –1273.577 –1366.558 AIC 2550.224 2551.246 2561.154 2745.116 OMREM-1 and OMREM-2 are OMREMs with random effects variance log ? i = ? 0+ ? 1×Tx i and log ? i = ? 0, respectively. Both had autoregressive covariance structures. OMREM-3 is the OMREM-2 with b it = b i 0~ N(0, ? 2). IPOM is an independent proportional odds model. Tx is an indicator for FOLFOX. Visit is the patient's visit corresponding to the time period. * Significance under 95 per cent confidence level. Table III Break down of completers and dropouts by treatment groups for QOL data. Dropouts by reason Treatment Completer Progression/death Other Total IFL 10 (0.04) 117 (0.50) 108 (0.46) 235 FOLFOX 4 (0.02) 68 (0.29) 161 (0.69) 233 Total 14 (0.03) 185 (0.41) 269 (0.57) 468 Proportions are given in parentheses. Table IV Break down of progression/death windows by treatment groups for QOL data. Progression/death window Treatment 1 2 3 4 5 6 Total IFL 35 (0.15) 32 (0.14) 38 (0.16) 26 (0.11) 18 (0.08) 86 (0.37) 235 FOLFOX 16 (0.07) 28 (0.12) 24 (0.10) 17 (0.07) 19 (0.08) 129 (0.55) 233 Total 51 (0.11) 60 (0.13) 62 (0.13) 43 (0.09) 37 (0.08) 215 (0.46) 468 Window 6 means ‘after study.’ Proportions are given in parentheses. Table V Maximum likelihood estimates of P ( Y t > k | S >5, Tx) (standard errors) where S is progression/death time. Visit( t ) Trt k 1 2 3 4 5 6 IFL 1 0.753 (0.039) 0.754 (0.034) 0.754 (0.037) 0.755 (0.047) 0.755 (0.061) 0.756 (0.077) 2 0.287 (0.044) 0.288 (0.037) 0.288 (0.040) 0.288 (0.051) 0.289 (0.066) 0.290 (0.084) 3 0.086 (0.019) 0.086 (0.017) 0.087 (0.019) 0.087 (0.023) 0.087 (0.028) 0.087 (0.035) FOLFOX 1 0.731 (0.033) 0.757 (0.028) 0.781 (0.032) 0.803 (0.039) 0.823 (0.047) 0.842 (0.054) 2 0.264 (0.034) 0.291 (0.031) 0.320 (0.038) 0.350 (0.054) 0.381 (0.073) 0.413 (0.095) 3 0.078 (0.016) 0.088 (0.016) 0.099 (0.019) 0.112 (0.026) 0.126 (0.036) 0.141 (0.049) P ( Y t > k | S >5, Tx) evaluates probability of fatigue stress for those who did not progress/die before the end of the study. 