Automated Detection of Breast Mass Spiculation Levels and Evaluation of Scheme Performance Rationale and Objectives Although spiculation level of breast mass boundary is a primary sign of malignancy for the mass detected on mammograms, developing an automated computer scheme to detect mass spiculation level and quantitatively evaluating the performance of the scheme is a difficult task. The objective of this study is to ( 1 ) develop and test a new scheme to improve mass segmentation and detect mass boundary spiculation level, and ( 2 ) assess the scheme performance using a relatively large image dataset. Materials and Methods This fully-automated scheme includes three image processing steps. The first step applies the maximum entropy principle in the selected region of interest (ROI) after correcting the background-trend to enhance the initial outlines of the masses. The second step uses an active contour model to refine the initial outlines. The third step detects and identifies spiculated lines connected to the mass boundary using a special line detector. A quantitative spiculation index is computed to assess the degree of spiculation levels. To develop and evaluate this automated scheme, we selected 211 ROIs depicting masses that were extracted from a publicly available image database. Among these ROIs, 106 depict “circumscribed” mass regions and 105 involve “spiculated” mass regions. The scheme performance was evaluated using the receiver operating characteristic (ROC) analysis method. Results The computed area under ROC curve when applying the scheme to the dataset is 0.701 ± 0.027. By setting up a threshold at spiculation index = 5.0, the scheme achieves the overall classification accuracy of 66.4% with 54.3% sensitivity and 78.3% specificity, respectively. Conclusions We developed a new computer scheme with a number of unique characteristics to detect spiculated mass regions and applied a simple spiculation index to quantify mass spiculation levels. Although this quantitative index can be used to classify between the spiculated and circumscribed masses, the results also suggest that automated detection of mass spiculation levels remains a technical challenge.  INTRODUCTION Breast cancer is one of the leading causes of death in women ( 1 , 2 ). Early detection and treatment of breast cancer can substantially reduce patient mortality and morbidity ( 3 ). For the early detection of breast cancer, mammography is widely used as one of the most reliable and cost-effective methods ( 4 , 5 ). However, in the clinical environment, mammography reading is a time-consuming and low-specificity task for the most of radiologists. To help improve reading efficiency and interpreting performance of radiologists, a large number of computer-aided detection or diagnosis (CAD) schemes have been developed and tested ( 6 ). Currently commercialized CAD schemes have achieved very high performance in detecting micro-calcification clusters (i.e., 98% sensitivity with 0.2 false-positive clusters per image ( 7 )), while their performance in mass detection remains relatively low ( 8 ). As a result, using CAD substantially improved radiologists’ performance and efficiency in micro-calcification clusters detection ( 9 ). However, due to the low confidence of radiologists in CAD-cued masses, most of CAD-cued false-negative masses are discarded by radiologists as false-positive detections in the screening environment ( 10 ). A large number of studies have been reported in an attempt to improve CAD performance in mass detection ( 6 ). One approach focuses on improving mass segmentation accuracy and identifying effective image features. Previous studies have suggested that improving accuracy of mass region segmentation could also significantly improve CAD performance in mass detection and characterization ( 11 , 12 ). Segmentation of masses on the original images is often difficult when the masses are overlapped with surrounding dense tissue parenchyma. Several automated and semi-automated methods focusing on this problem have been developed ( 13 – 17 ). These include using ( 1 ) a density-weighted contrast enhancement algorithm that combined adaptive filtering and edge detection ( 13 ), ( 2 ) an adaptive multi-layer topographic region growth algorithm ( 14 ), ( 3 ) a gray level based iterative and linear segmentation algorithm ( 15 ), a dynamic programming approach ( 16 ), and dynamic contour modeling ( 17 ) to segment mass lesions from surrounding breast tissue. One important feature in automated mass detection and classification is mass boundary spiculation level ( 18 ). A number of previous studies have been reported in an attempt to automatically detect spiculated masses and incorporate this feature into CAD schemes ( 19 – 22 ). Kegelmeyer et al ( 19 ) detected spiculated masses using local edge orientation and laws texture features. The algorithm applies a statistical classifier to labeling each pixel with its probability of being located on an abnormality, but it is not applicable for detection of non-spiculated masses. Karssemeijer et al. ( 20 ) used a method based on statistical analysis of a map of pixel orientations to detect of stellate distortions on mammograms. Huo et al. ( 21 ) developed a new spiculation-sensitive pattern recognition technique to quantify the degree of spiculation of a lesion and classified masses as malignant or benign. The study reported that the computer-extracted spiculation measure was shown to yield higher classification accuracy than the spiculation rating of an experienced radiologist. Sahiner et al. ( 22 ) presented a fully automated and three-stage segmentation method that included clustering, active contour, and spiculation detection stages to detect spiculated and non-spiculated masses. The results indicated that combining texture features with morphological features extracted from automatically segmented mass regions was an effective approach for automated characterization of mammographic masses. Recent studies of developing interactive computer-aided diagnosis (ICAD) schemes also suggested that accurate detection and classification of mass boundary spiculation levels played an important role in improving visual similarity of similar reference mass regions selected by ICAD schemes ( 23 ). Despite the fact that significant research effort has been made in developing computer schemes to detect mass boundary spiculation levels, accurate and robust detection of mass spiculation remains a technical challenge because the spiculated patterns are often subtle and varied in appearance and image sub-sampling are frequently used in mass detection schemes ( 12 ). In addition, due to the lack of “ground-truth” of mass spiculation levels in the testing dataset, assessing scheme performance is also a difficult issue. In this study, we developed and tested a new computer scheme that aims to obtain an accurate delineation of mass boundaries and quantification of boundary spiculation levels. This fully-automated scheme includes three main steps. The first step uses maximum entropy principle to detect the initial mass outlines (boundary contour) in the region of interest (ROI) after correcting noisy background-trend. The second step applies an active contour model to refine the initially detected mass boundary contour. The third step uses a line detector to detect and identify spiculated lines connected to the mass boundary. Based on the final region segmentation, a quantitative measure (feature) defined as spiculation index ( SI ) is used to assess the degree of spiculation levels. The performance of the scheme using the spiculation index for classifying identified mass regions is evaluated using a relatively large image dataset and the area under the receiver operating characteristic (ROC) curve.  Materials and Methods This fully-automated scheme includes three image processing steps. The first step applies the maximum entropy principle in the selected region of interest (ROI) after correcting the background-trend to enhance the initial outlines of the masses. The second step uses an active contour model to refine the initial outlines. The third step detects and identifies spiculated lines connected to the mass boundary using a special line detector. A quantitative spiculation index is computed to assess the degree of spiculation levels. To develop and evaluate this automated scheme, we selected 211 ROIs depicting masses that were extracted from a publicly available image database. Among these ROIs, 106 depict “circumscribed” mass regions and 105 involve “spiculated” mass regions. The scheme performance was evaluated using the receiver operating characteristic (ROC) analysis method.  Results The computed area under ROC curve when applying the scheme to the dataset is 0.701 ± 0.027. By setting up a threshold at spiculation index = 5.0, the scheme achieves the overall classification accuracy of 66.4% with 54.3% sensitivity and 78.3% specificity, respectively.  Conclusions We developed a new computer scheme with a number of unique characteristics to detect spiculated mass regions and applied a simple spiculation index to quantify mass spiculation levels. Although this quantitative index can be used to classify between the spiculated and circumscribed masses, the results also suggest that automated detection of mass spiculation levels remains a technical challenge.  MATERIALS AND METHODS Selection of Image Dataset Images used in this study were selected from a publicly available database, Digital Database for Screening Mammography (DDSM) assembled by a research group at the University of South Florida ( 24 ). This database has been selected and used in developing a number of CAD schemes ( 15 , 25 ). The criteria for inclusion of an image in the dataset for this study are that the image contains circumscribed and irregular spiculated masses subjectively classified by radiologists and recorded in DDSM. We selected both malignant and benign masses that meet the inclusion criteria for this study. In image selection, we first used the software provided by Michael Heath Computer Vision Laboratory, University of South Florida ( 24 ), to uncompress the images. Then the raw data of images that were digitized using both LUMISYS and HOWTEK digitizer were sub-sampled using average of 8 × 8 pixel values (i.e., increasing the pixel size from 50?m × 50?m to 400?m × 400?m when using LUMISYS digitizer). We also compressed the range of image pixel gray level from 12bits to 8bits. In DDSM, each image depicted abnormal masses has a corresponding overlay file that records the detailed information about each mass region, including its lesion type, the BI-RADS assessment, the pathology (malignant or benign) classification, subjective rating on lesion subtlety, and visual assessment of boundary margin characteristics. The mass boundaries of DDSM have been subjectively characterized as following: (1) spiculated, (2) circumscribed, (3) ill-defined, (4) microlobulated, and (5) obscured. In this study, we only selected the ROIs that depict spiculated and circumscribed masses. To regularly extract each ROI, we first manually marked a point (pixel) near the subjectively estimated mass geometric center. After applying a window of 15 × 15 pixels centered at the marked pixel, our computer scheme searched for a pixel with the minimum gray level (digital value) inside the window. Then, using this pixel as the center, the computer scheme automatically extracted the ROI that covers the selected mass region. Each extracted ROI includes 128 × 128 pixels (i.e., 51.2mm × 51.2mm for images digitized using LUMISYS digitizer). The selected test dataset consists of 106 ROIs involving circumscribed mass regions and 105 ROIs involving spiculated mass regions from 206 mammograms of 144 patients ( Table 1 ). The subtlety for each abnormality recorded in DDSM ranges from 1 to 5, where 1 is “subtle” and 5 is “obvious.” The histogram of the subtle rating of the selected ROIs is plotted in Figure 1 . The distribution of the size of the selected mass regions is shown in Figure 2 , which indicates that the distribution of the sizes for both circumscribed and spiculated masses is similar. The mean sizes of the circumscribed masses and the spiculated masses are 12.2mm and 14.8mm, respectively in the selected dataset. Correction of Background-trend of ROI The density of the neighboring and overlapping breast tissues may affect the background gray levels of ROI. In general, the background tissues do not directly relate to the presence of the mass, but may affect the segmentation and feature extraction results used in the computerized analysis. In order to reduce the influence of the background tissues to the mass, we applied an algorithm that could correct the gray level distribution and make the mass salient on the ROI. The method was chosen based on the topographic form of the ROI. The topographic form of mass is higher than that of background tissues. The mass typically contains high-frequency information, while the background contains low frequencies. Due to these facts, a plane fitting based on the least square method ( 26 ) was applied. Figure 3 shows one spiculated mass ( Figure 3a ) and one circumscribed mass ( Figure 3b ) depicted on two ROIs. Figure 3c–3d illustrate the fitting plane image of the original ROIs, while Figure 3e–3f show the corresponding ROIs obtained by subtraction of the plane image from the original ROIs. The processing substantially reduces the variation of the background gray levels which results in the “flat background” of the ROI, while at the same time the processing remains high-frequency information (i.e., mass) located at a new relatively flat background. Next, in order to improve mass contrast, the Gamma correction procedure and a simple Gaussian filter were used sequentially. This image processing procedure generates the background-trend corrected ROIs ( Figure 3g–3h ). From these ROIs, one can observe that the influence of the background structures is reduced, while the masses are becoming salient objects. Segmentation of Mass Region After background-trend correction, our computer scheme applies three steps to segment mass region and detects its boundary spiculation level as described below. Step 1 - Initial segmentation with maximum entropy principle This step segments mass region with the initial detection of a mass shape within a ROI using maximum entropy method. Entropy is a basic concept in information theory proposed by Shannon ( 27 ). For a discrete variable Y with y 1 , y 2 , … , y N a set of values, we define equation (1) as entropy based on the probability distribution of Y . In general, higher entropy means more information containing in the system. (1) H ( Y ) = ? ? 1 N P ( Y = y i ) log P ( Y = y i ) The maximum entropy principle is one of the most important threshold selection methods in image processing. It was firstly proposed by T. Pun ( 28 ) and aims at dividing histogram of image into independent classes, while the sum of entropies for all classes is the maximum. The problem can be formalized as below. For a set P , we divide P into k subsets without overlap, P = P 1 ? P 2 ? … ? P k . The sum of subset entropies is represented as below. (2) H ( P ) = H ( P 1 ) + H ( P 2 ) + ? + H ( P k ) Next, optimal thresholds are selected to divide histogram of P to achieve the maximum H ( P ) value. The purpose of this step is to partition pixels of ROI into mass and background tissues. It means that we should find an adaptive threshold to classify the pixels into two classes, A and B . The parameter k in equation (2) is “2” and p 0, p 1, … , p n is defined as the probability distribution of the gray levels of background-trend corrected ROI. If s is set to be the threshold, we could get two probability distributions. One is the probability distribution of 1 ~ s gray levels, while the other is the probability distribution of s+ 1 ~ n gray levels. The two probability distributions are: (3) A : p 0 P T , p 1 P T , … p s P T B : p s + 1 1 ? P T , p s + 2 1 ? P T , … p n 1 ? P T where P T = ? i = 0 s p i The respective entropy for A and B is: (4) H ( A ) = ? ? i = 0 s p i P T log p i P T ; and H ( B ) = ? ? i = 1 + s n p i 1 ? P T log p i 1 ? P T (5) s = arg ( max s ( H ( A ) + H ( B ) ) ) The optimal threshold s should satisfy equation (5) . With this threshold, we would get the maximum entropy (or maximum information) that represents the optimal division of the image. Figure 4a–4b show the segmentation results of the background-trend corrected ROIs (as shown in Figure 3 ) based on maximum entropy principle. The images are illustrated in binary form, value of 255 (white) indicates an object (mass) pixel, and zero (black) indicates a background pixel. To obtain initial contour of the mass region, a morphological dilation operation with a 3×3 square mask is applied to the binary image. Figure 4c–4d show results of initial boundary contour after subtraction of original segmented image from the dilated image. Due to the method depicted in ROI extraction, the ROI center is the brightest pixel (with minimum digital value) inside the segmented mass region. Hence, we treated the first connected area boundary on the direction pointing outward from the center as the final segmented outline of this stage as shown in Figure 4e–4f . In addition, Figure 4g–4h shows the segmentation results highlighted on the original ROIs. Step 2 - Segmentation refinement with active contour model We then applied an active contour (or snake) model ( 29 ) to improve mass boundary segmentation. Active contour model is an energy minimization method that has been widely used in applications of computer vision and pattern recognition, including edge detection, shape segmentation and motion tracking. However, active contour depends heavily on local edge-based image features to guide its convergence. This makes the models sensitive to noise and the initial estimation. Hence, a good initialization is often required. Because the preliminary results show that initial mass segmentation result obtained in the first step of the scheme generates reasonable mass shapes for the most of masses, we used it as the initial contour (starting point) in the active contour model. Snake is curve defined within an image domain that can move under the influence of internal forces within the curve itself and external forces derived from the image data. The actions of snake are directed by an energy function. A snake is defined as v ( s )= ( x ( s ), y ( s )), where x ( s ), y ( s ) are x, y coordinates along the contour, and s ? [0,1]. The general description of the energy function is in equation (6) . It consists of internal energy and external energy. (6) E snake = ? 0 1 E int ( v ( s ) ) d s + E ext ( v ( s ) ) d s The internal energy is usually written as E int = ( ? ( s )| v s ( s )|2 + ? ( s )| v ss ( s )|2)/2. It is composed of a first-order term controlled by ? ( s ) and a second-order term controlled by ? ( s ). The first-order term v s( s ) is treated as elastic energy, which causes the snake to shrink like an elastic rubber band. The second-order vss( s ) makes the snake to behave like a thin metal strip and is responsible for smoothness of the contour. The external energy is derived from the image date. It attracts snake to salient image contours such as edges, lines, and subjective contours. For this purpose, external energy can be defined as intensity or gradient of the image. In 1998, Xu et al ( 30 ) proposed gradient vector flow (GVF) to deal with the two key difficulties existing in the traditional active contour model. The gradient vector flow field, the vector V ( x , y )=[ u ( x , y ), v ( x , y )], minimizes the energy function (7) ? = ? ? ( u x 2 + u y 2 + v x 2 + v y 2 ) + ? ? f ? 2 ? V ? ? f ? 2 dxdy where |? f | is the gradient of the original image. The gradient of the original image is identified as an edge map in which each pixel is assigned a value according to the edge strength. Mostly pixels with big values represent object boundaries. The calculated edge magnitudes and capture range of the edge map directly affect the gradient vector flow field. In this study we applied our previously proposed method ( 31 ) to compute the edge map. Figure 5a–5b show the gradient of background-trend corrected ROI obtained with our method, while Figure 5c–5d show the gradient of background-trend corrected ROI obtained with general method ( 30 ). From the figure, we can see that the gradient computed using our method is more obvious than that computed using general method and it results in increasing the capture range of the external force field. In order to apply active contour (snake) algorithm to segment the boundaries of the suspected mass regions, we downloaded and tested an available active contour program (SNAKE DEMO version 1.0 beta designed by Xu et al ( 32 )). We then modified this program with the proposed gradient image and integrated it into our scheme. Figure 6a–6b show the refined results of the original ROI shown on Figure 3a–3b after applying active contour model to the images. Step 3 - Detection of spiculation level In this step a line or edge detection filter is applied to detect linear structures surrounding the mass boundary contour detected in previous steps. Although not all of the linear structures are related to the mass boundary spiculation, we define the spiculated lines that must be approximately located in the directions radiating from the mass region center, while the most of blood vessel or other tissue lines do not have such orientation characteristic. Hence, one useful feature of detecting spiculated lines is their orientation and we designed a special line detector to detect mass boundary spiculation. Detection of spiculations with line detector is complicated by the fact that the search direction for the spiculation changes with the shape of mass and the curvature of its margin. To overcome this problem, we firstly transformed original coordinates ( x, y ) of the background-trend corrected ROI containing mass boundary segmented by active contour model into polar coordinates ( ?, d ). The center of the background-trend corrected ROI defines the origin for the coordinate transform. The x axis in the polar coordinate image represents the angle ? from 0 to 2?, while the y axis represents the radius d from 0 to half of the ROI size (64 pixels). The transformed images are illustrated in Figure 7 . In the polar coordinate representation image, pixel value 0 represents the pixels inside the segmented result obtained with snake. After the transformation, pixels along a radial line from the center to the border of the background-trend corrected ROI are mapped to a column of the polar coordinate image. Pixels at a constant distance radiating from the center of the background-trend corrected ROI are mapped to a row of the polar coordinate image. In this way the border of a mass is expected to appear approximately as a horizontal edge, and spiculations are expected to appear approximately as vertical lines in the polar system. Based on the orientation characteristic of spiculations, we defined a line detector which could detect vertical line structures on the polar coordinate image. The line detector contains a series of edge filter templates which are shown in Figure 8 . They are used to obtain vertical or nearly vertical gradient transformation. Each edge filter template is applied to convolve the polar coordinate image respectively. With these defined templates five values at each pixel are obtained, and the largest one among the absolute of these five values is denoted as the last gray value for the pixel. If the largest value is above 255, the pixel value is denoted as 255. The obtained gradient transformation images are represented in Figure 9 . Next, threshold method with the optimal threshold value 255 is used to convert the filtered image into a binary image. All pixels with digital value smaller than 255 is assigned to 0, while other pixels with digital value of 255 is converted to 1. The binary image is transformed into original coordinates ( x, y ), and all detected lines with the mass boundary that we had already segmented are combined. Then a labeling method is applied to extract the first connected area boundary on the direction pointing outward from the center. The extracted connected area boundary is treated as the final segmented result of this segmentation algorithm. The results are shown in Figure 10 . Evaluation of Scheme Performance Although spiculation level is an important feature in detecting and classifying breast masses, previous study indicates a large inter-observer variation in subjectively rating mass boundary spiculation levels ( 33 ). Hence, mass boundary spiculation is a very subjective concept and there is no “ground-truth” to evaluate the severity of spiculation levels and the accuracy of the computer schemes. In order to “quantitatively” evaluate the accuracy of our spiculation detection method, we applied a computed measure index to assess the spiculation levels of different mass regions. This quantitative measure is defined as S I = P 2 A , where SI denotes the spiculation index, P represents A the detected number of perimeter pixels, and is the mass area (the total pixels detected inside the mass region). Higher spiculated mass has more pixels detected in the perimeter, which generates larger SI value. This feature has been widely accepted as an effective evaluation index for spiculation in CAD schemes of mammograms ( 12 , 34 ). After applying our automated computer scheme to the image dataset to detect mass boundary spiculation and compute total 211 SI values (including 106 ones for circumscribed masses and 105 ones for spiculated masses), we applied receiver operating characteristics (ROC) analysis method ( 35 ) to evaluate the abilities of the spiculation measure in classification between these circumscribed and spiculated masses. Specifically, we used a publicly available ROC program (ROCFIT ( 36 )) that uses a maximum likelihood statistical method to fit the experimental data, generate a smoothed ROC curve, and compute the area under the ROC curve ( A z value) that is used as a performance index of our computer scheme.  Selection of Image Dataset Images used in this study were selected from a publicly available database, Digital Database for Screening Mammography (DDSM) assembled by a research group at the University of South Florida ( 24 ). This database has been selected and used in developing a number of CAD schemes ( 15 , 25 ). The criteria for inclusion of an image in the dataset for this study are that the image contains circumscribed and irregular spiculated masses subjectively classified by radiologists and recorded in DDSM. We selected both malignant and benign masses that meet the inclusion criteria for this study. In image selection, we first used the software provided by Michael Heath Computer Vision Laboratory, University of South Florida ( 24 ), to uncompress the images. Then the raw data of images that were digitized using both LUMISYS and HOWTEK digitizer were sub-sampled using average of 8 × 8 pixel values (i.e., increasing the pixel size from 50?m × 50?m to 400?m × 400?m when using LUMISYS digitizer). We also compressed the range of image pixel gray level from 12bits to 8bits. In DDSM, each image depicted abnormal masses has a corresponding overlay file that records the detailed information about each mass region, including its lesion type, the BI-RADS assessment, the pathology (malignant or benign) classification, subjective rating on lesion subtlety, and visual assessment of boundary margin characteristics. The mass boundaries of DDSM have been subjectively characterized as following: (1) spiculated, (2) circumscribed, (3) ill-defined, (4) microlobulated, and (5) obscured. In this study, we only selected the ROIs that depict spiculated and circumscribed masses. To regularly extract each ROI, we first manually marked a point (pixel) near the subjectively estimated mass geometric center. After applying a window of 15 × 15 pixels centered at the marked pixel, our computer scheme searched for a pixel with the minimum gray level (digital value) inside the window. Then, using this pixel as the center, the computer scheme automatically extracted the ROI that covers the selected mass region. Each extracted ROI includes 128 × 128 pixels (i.e., 51.2mm × 51.2mm for images digitized using LUMISYS digitizer). The selected test dataset consists of 106 ROIs involving circumscribed mass regions and 105 ROIs involving spiculated mass regions from 206 mammograms of 144 patients ( Table 1 ). The subtlety for each abnormality recorded in DDSM ranges from 1 to 5, where 1 is “subtle” and 5 is “obvious.” The histogram of the subtle rating of the selected ROIs is plotted in Figure 1 . The distribution of the size of the selected mass regions is shown in Figure 2 , which indicates that the distribution of the sizes for both circumscribed and spiculated masses is similar. The mean sizes of the circumscribed masses and the spiculated masses are 12.2mm and 14.8mm, respectively in the selected dataset.  Correction of Background-trend of ROI The density of the neighboring and overlapping breast tissues may affect the background gray levels of ROI. In general, the background tissues do not directly relate to the presence of the mass, but may affect the segmentation and feature extraction results used in the computerized analysis. In order to reduce the influence of the background tissues to the mass, we applied an algorithm that could correct the gray level distribution and make the mass salient on the ROI. The method was chosen based on the topographic form of the ROI. The topographic form of mass is higher than that of background tissues. The mass typically contains high-frequency information, while the background contains low frequencies. Due to these facts, a plane fitting based on the least square method ( 26 ) was applied. Figure 3 shows one spiculated mass ( Figure 3a ) and one circumscribed mass ( Figure 3b ) depicted on two ROIs. Figure 3c–3d illustrate the fitting plane image of the original ROIs, while Figure 3e–3f show the corresponding ROIs obtained by subtraction of the plane image from the original ROIs. The processing substantially reduces the variation of the background gray levels which results in the “flat background” of the ROI, while at the same time the processing remains high-frequency information (i.e., mass) located at a new relatively flat background. Next, in order to improve mass contrast, the Gamma correction procedure and a simple Gaussian filter were used sequentially. This image processing procedure generates the background-trend corrected ROIs ( Figure 3g–3h ). From these ROIs, one can observe that the influence of the background structures is reduced, while the masses are becoming salient objects.  Segmentation of Mass Region After background-trend correction, our computer scheme applies three steps to segment mass region and detects its boundary spiculation level as described below. Step 1 - Initial segmentation with maximum entropy principle This step segments mass region with the initial detection of a mass shape within a ROI using maximum entropy method. Entropy is a basic concept in information theory proposed by Shannon ( 27 ). For a discrete variable Y with y 1 , y 2 , … , y N a set of values, we define equation (1) as entropy based on the probability distribution of Y . In general, higher entropy means more information containing in the system. (1) H ( Y ) = ? ? 1 N P ( Y = y i ) log P ( Y = y i ) The maximum entropy principle is one of the most important threshold selection methods in image processing. It was firstly proposed by T. Pun ( 28 ) and aims at dividing histogram of image into independent classes, while the sum of entropies for all classes is the maximum. The problem can be formalized as below. For a set P , we divide P into k subsets without overlap, P = P 1 ? P 2 ? … ? P k . The sum of subset entropies is represented as below. (2) H ( P ) = H ( P 1 ) + H ( P 2 ) + ? + H ( P k ) Next, optimal thresholds are selected to divide histogram of P to achieve the maximum H ( P ) value. The purpose of this step is to partition pixels of ROI into mass and background tissues. It means that we should find an adaptive threshold to classify the pixels into two classes, A and B . The parameter k in equation (2) is “2” and p 0, p 1, … , p n is defined as the probability distribution of the gray levels of background-trend corrected ROI. If s is set to be the threshold, we could get two probability distributions. One is the probability distribution of 1 ~ s gray levels, while the other is the probability distribution of s+ 1 ~ n gray levels. The two probability distributions are: (3) A : p 0 P T , p 1 P T , … p s P T B : p s + 1 1 ? P T , p s + 2 1 ? P T , … p n 1 ? P T where P T = ? i = 0 s p i The respective entropy for A and B is: (4) H ( A ) = ? ? i = 0 s p i P T log p i P T ; and H ( B ) = ? ? i = 1 + s n p i 1 ? P T log p i 1 ? P T (5) s = arg ( max s ( H ( A ) + H ( B ) ) ) The optimal threshold s should satisfy equation (5) . With this threshold, we would get the maximum entropy (or maximum information) that represents the optimal division of the image. Figure 4a–4b show the segmentation results of the background-trend corrected ROIs (as shown in Figure 3 ) based on maximum entropy principle. The images are illustrated in binary form, value of 255 (white) indicates an object (mass) pixel, and zero (black) indicates a background pixel. To obtain initial contour of the mass region, a morphological dilation operation with a 3×3 square mask is applied to the binary image. Figure 4c–4d show results of initial boundary contour after subtraction of original segmented image from the dilated image. Due to the method depicted in ROI extraction, the ROI center is the brightest pixel (with minimum digital value) inside the segmented mass region. Hence, we treated the first connected area boundary on the direction pointing outward from the center as the final segmented outline of this stage as shown in Figure 4e–4f . In addition, Figure 4g–4h shows the segmentation results highlighted on the original ROIs. Step 2 - Segmentation refinement with active contour model We then applied an active contour (or snake) model ( 29 ) to improve mass boundary segmentation. Active contour model is an energy minimization method that has been widely used in applications of computer vision and pattern recognition, including edge detection, shape segmentation and motion tracking. However, active contour depends heavily on local edge-based image features to guide its convergence. This makes the models sensitive to noise and the initial estimation. Hence, a good initialization is often required. Because the preliminary results show that initial mass segmentation result obtained in the first step of the scheme generates reasonable mass shapes for the most of masses, we used it as the initial contour (starting point) in the active contour model. Snake is curve defined within an image domain that can move under the influence of internal forces within the curve itself and external forces derived from the image data. The actions of snake are directed by an energy function. A snake is defined as v ( s )= ( x ( s ), y ( s )), where x ( s ), y ( s ) are x, y coordinates along the contour, and s ? [0,1]. The general description of the energy function is in equation (6) . It consists of internal energy and external energy. (6) E snake = ? 0 1 E int ( v ( s ) ) d s + E ext ( v ( s ) ) d s The internal energy is usually written as E int = ( ? ( s )| v s ( s )|2 + ? ( s )| v ss ( s )|2)/2. It is composed of a first-order term controlled by ? ( s ) and a second-order term controlled by ? ( s ). The first-order term v s( s ) is treated as elastic energy, which causes the snake to shrink like an elastic rubber band. The second-order vss( s ) makes the snake to behave like a thin metal strip and is responsible for smoothness of the contour. The external energy is derived from the image date. It attracts snake to salient image contours such as edges, lines, and subjective contours. For this purpose, external energy can be defined as intensity or gradient of the image. In 1998, Xu et al ( 30 ) proposed gradient vector flow (GVF) to deal with the two key difficulties existing in the traditional active contour model. The gradient vector flow field, the vector V ( x , y )=[ u ( x , y ), v ( x , y )], minimizes the energy function (7) ? = ? ? ( u x 2 + u y 2 + v x 2 + v y 2 ) + ? ? f ? 2 ? V ? ? f ? 2 dxdy where |? f | is the gradient of the original image. The gradient of the original image is identified as an edge map in which each pixel is assigned a value according to the edge strength. Mostly pixels with big values represent object boundaries. The calculated edge magnitudes and capture range of the edge map directly affect the gradient vector flow field. In this study we applied our previously proposed method ( 31 ) to compute the edge map. Figure 5a–5b show the gradient of background-trend corrected ROI obtained with our method, while Figure 5c–5d show the gradient of background-trend corrected ROI obtained with general method ( 30 ). From the figure, we can see that the gradient computed using our method is more obvious than that computed using general method and it results in increasing the capture range of the external force field. In order to apply active contour (snake) algorithm to segment the boundaries of the suspected mass regions, we downloaded and tested an available active contour program (SNAKE DEMO version 1.0 beta designed by Xu et al ( 32 )). We then modified this program with the proposed gradient image and integrated it into our scheme. Figure 6a–6b show the refined results of the original ROI shown on Figure 3a–3b after applying active contour model to the images. Step 3 - Detection of spiculation level In this step a line or edge detection filter is applied to detect linear structures surrounding the mass boundary contour detected in previous steps. Although not all of the linear structures are related to the mass boundary spiculation, we define the spiculated lines that must be approximately located in the directions radiating from the mass region center, while the most of blood vessel or other tissue lines do not have such orientation characteristic. Hence, one useful feature of detecting spiculated lines is their orientation and we designed a special line detector to detect mass boundary spiculation. Detection of spiculations with line detector is complicated by the fact that the search direction for the spiculation changes with the shape of mass and the curvature of its margin. To overcome this problem, we firstly transformed original coordinates ( x, y ) of the background-trend corrected ROI containing mass boundary segmented by active contour model into polar coordinates ( ?, d ). The center of the background-trend corrected ROI defines the origin for the coordinate transform. The x axis in the polar coordinate image represents the angle ? from 0 to 2?, while the y axis represents the radius d from 0 to half of the ROI size (64 pixels). The transformed images are illustrated in Figure 7 . In the polar coordinate representation image, pixel value 0 represents the pixels inside the segmented result obtained with snake. After the transformation, pixels along a radial line from the center to the border of the background-trend corrected ROI are mapped to a column of the polar coordinate image. Pixels at a constant distance radiating from the center of the background-trend corrected ROI are mapped to a row of the polar coordinate image. In this way the border of a mass is expected to appear approximately as a horizontal edge, and spiculations are expected to appear approximately as vertical lines in the polar system. Based on the orientation characteristic of spiculations, we defined a line detector which could detect vertical line structures on the polar coordinate image. The line detector contains a series of edge filter templates which are shown in Figure 8 . They are used to obtain vertical or nearly vertical gradient transformation. Each edge filter template is applied to convolve the polar coordinate image respectively. With these defined templates five values at each pixel are obtained, and the largest one among the absolute of these five values is denoted as the last gray value for the pixel. If the largest value is above 255, the pixel value is denoted as 255. The obtained gradient transformation images are represented in Figure 9 . Next, threshold method with the optimal threshold value 255 is used to convert the filtered image into a binary image. All pixels with digital value smaller than 255 is assigned to 0, while other pixels with digital value of 255 is converted to 1. The binary image is transformed into original coordinates ( x, y ), and all detected lines with the mass boundary that we had already segmented are combined. Then a labeling method is applied to extract the first connected area boundary on the direction pointing outward from the center. The extracted connected area boundary is treated as the final segmented result of this segmentation algorithm. The results are shown in Figure 10 .  Step 1 - Initial segmentation with maximum entropy principle This step segments mass region with the initial detection of a mass shape within a ROI using maximum entropy method. Entropy is a basic concept in information theory proposed by Shannon ( 27 ). For a discrete variable Y with y 1 , y 2 , … , y N a set of values, we define equation (1) as entropy based on the probability distribution of Y . In general, higher entropy means more information containing in the system. (1) H ( Y ) = ? ? 1 N P ( Y = y i ) log P ( Y = y i ) The maximum entropy principle is one of the most important threshold selection methods in image processing. It was firstly proposed by T. Pun ( 28 ) and aims at dividing histogram of image into independent classes, while the sum of entropies for all classes is the maximum. The problem can be formalized as below. For a set P , we divide P into k subsets without overlap, P = P 1 ? P 2 ? … ? P k . The sum of subset entropies is represented as below. (2) H ( P ) = H ( P 1 ) + H ( P 2 ) + ? + H ( P k ) Next, optimal thresholds are selected to divide histogram of P to achieve the maximum H ( P ) value. The purpose of this step is to partition pixels of ROI into mass and background tissues. It means that we should find an adaptive threshold to classify the pixels into two classes, A and B . The parameter k in equation (2) is “2” and p 0, p 1, … , p n is defined as the probability distribution of the gray levels of background-trend corrected ROI. If s is set to be the threshold, we could get two probability distributions. One is the probability distribution of 1 ~ s gray levels, while the other is the probability distribution of s+ 1 ~ n gray levels. The two probability distributions are: (3) A : p 0 P T , p 1 P T , … p s P T B : p s + 1 1 ? P T , p s + 2 1 ? P T , … p n 1 ? P T where P T = ? i = 0 s p i The respective entropy for A and B is: (4) H ( A ) = ? ? i = 0 s p i P T log p i P T ; and H ( B ) = ? ? i = 1 + s n p i 1 ? P T log p i 1 ? P T (5) s = arg ( max s ( H ( A ) + H ( B ) ) ) The optimal threshold s should satisfy equation (5) . With this threshold, we would get the maximum entropy (or maximum information) that represents the optimal division of the image. Figure 4a–4b show the segmentation results of the background-trend corrected ROIs (as shown in Figure 3 ) based on maximum entropy principle. The images are illustrated in binary form, value of 255 (white) indicates an object (mass) pixel, and zero (black) indicates a background pixel. To obtain initial contour of the mass region, a morphological dilation operation with a 3×3 square mask is applied to the binary image. Figure 4c–4d show results of initial boundary contour after subtraction of original segmented image from the dilated image. Due to the method depicted in ROI extraction, the ROI center is the brightest pixel (with minimum digital value) inside the segmented mass region. Hence, we treated the first connected area boundary on the direction pointing outward from the center as the final segmented outline of this stage as shown in Figure 4e–4f . In addition, Figure 4g–4h shows the segmentation results highlighted on the original ROIs.  Step 2 - Segmentation refinement with active contour model We then applied an active contour (or snake) model ( 29 ) to improve mass boundary segmentation. Active contour model is an energy minimization method that has been widely used in applications of computer vision and pattern recognition, including edge detection, shape segmentation and motion tracking. However, active contour depends heavily on local edge-based image features to guide its convergence. This makes the models sensitive to noise and the initial estimation. Hence, a good initialization is often required. Because the preliminary results show that initial mass segmentation result obtained in the first step of the scheme generates reasonable mass shapes for the most of masses, we used it as the initial contour (starting point) in the active contour model. Snake is curve defined within an image domain that can move under the influence of internal forces within the curve itself and external forces derived from the image data. The actions of snake are directed by an energy function. A snake is defined as v ( s )= ( x ( s ), y ( s )), where x ( s ), y ( s ) are x, y coordinates along the contour, and s ? [0,1]. The general description of the energy function is in equation (6) . It consists of internal energy and external energy. (6) E snake = ? 0 1 E int ( v ( s ) ) d s + E ext ( v ( s ) ) d s The internal energy is usually written as E int = ( ? ( s )| v s ( s )|2 + ? ( s )| v ss ( s )|2)/2. It is composed of a first-order term controlled by ? ( s ) and a second-order term controlled by ? ( s ). The first-order term v s( s ) is treated as elastic energy, which causes the snake to shrink like an elastic rubber band. The second-order vss( s ) makes the snake to behave like a thin metal strip and is responsible for smoothness of the contour. The external energy is derived from the image date. It attracts snake to salient image contours such as edges, lines, and subjective contours. For this purpose, external energy can be defined as intensity or gradient of the image. In 1998, Xu et al ( 30 ) proposed gradient vector flow (GVF) to deal with the two key difficulties existing in the traditional active contour model. The gradient vector flow field, the vector V ( x , y )=[ u ( x , y ), v ( x , y )], minimizes the energy function (7) ? = ? ? ( u x 2 + u y 2 + v x 2 + v y 2 ) + ? ? f ? 2 ? V ? ? f ? 2 dxdy where |? f | is the gradient of the original image. The gradient of the original image is identified as an edge map in which each pixel is assigned a value according to the edge strength. Mostly pixels with big values represent object boundaries. The calculated edge magnitudes and capture range of the edge map directly affect the gradient vector flow field. In this study we applied our previously proposed method ( 31 ) to compute the edge map. Figure 5a–5b show the gradient of background-trend corrected ROI obtained with our method, while Figure 5c–5d show the gradient of background-trend corrected ROI obtained with general method ( 30 ). From the figure, we can see that the gradient computed using our method is more obvious than that computed using general method and it results in increasing the capture range of the external force field. In order to apply active contour (snake) algorithm to segment the boundaries of the suspected mass regions, we downloaded and tested an available active contour program (SNAKE DEMO version 1.0 beta designed by Xu et al ( 32 )). We then modified this program with the proposed gradient image and integrated it into our scheme. Figure 6a–6b show the refined results of the original ROI shown on Figure 3a–3b after applying active contour model to the images.  Step 3 - Detection of spiculation level In this step a line or edge detection filter is applied to detect linear structures surrounding the mass boundary contour detected in previous steps. Although not all of the linear structures are related to the mass boundary spiculation, we define the spiculated lines that must be approximately located in the directions radiating from the mass region center, while the most of blood vessel or other tissue lines do not have such orientation characteristic. Hence, one useful feature of detecting spiculated lines is their orientation and we designed a special line detector to detect mass boundary spiculation. Detection of spiculations with line detector is complicated by the fact that the search direction for the spiculation changes with the shape of mass and the curvature of its margin. To overcome this problem, we firstly transformed original coordinates ( x, y ) of the background-trend corrected ROI containing mass boundary segmented by active contour model into polar coordinates ( ?, d ). The center of the background-trend corrected ROI defines the origin for the coordinate transform. The x axis in the polar coordinate image represents the angle ? from 0 to 2?, while the y axis represents the radius d from 0 to half of the ROI size (64 pixels). The transformed images are illustrated in Figure 7 . In the polar coordinate representation image, pixel value 0 represents the pixels inside the segmented result obtained with snake. After the transformation, pixels along a radial line from the center to the border of the background-trend corrected ROI are mapped to a column of the polar coordinate image. Pixels at a constant distance radiating from the center of the background-trend corrected ROI are mapped to a row of the polar coordinate image. In this way the border of a mass is expected to appear approximately as a horizontal edge, and spiculations are expected to appear approximately as vertical lines in the polar system. Based on the orientation characteristic of spiculations, we defined a line detector which could detect vertical line structures on the polar coordinate image. The line detector contains a series of edge filter templates which are shown in Figure 8 . They are used to obtain vertical or nearly vertical gradient transformation. Each edge filter template is applied to convolve the polar coordinate image respectively. With these defined templates five values at each pixel are obtained, and the largest one among the absolute of these five values is denoted as the last gray value for the pixel. If the largest value is above 255, the pixel value is denoted as 255. The obtained gradient transformation images are represented in Figure 9 . Next, threshold method with the optimal threshold value 255 is used to convert the filtered image into a binary image. All pixels with digital value smaller than 255 is assigned to 0, while other pixels with digital value of 255 is converted to 1. The binary image is transformed into original coordinates ( x, y ), and all detected lines with the mass boundary that we had already segmented are combined. Then a labeling method is applied to extract the first connected area boundary on the direction pointing outward from the center. The extracted connected area boundary is treated as the final segmented result of this segmentation algorithm. The results are shown in Figure 10 .  Evaluation of Scheme Performance Although spiculation level is an important feature in detecting and classifying breast masses, previous study indicates a large inter-observer variation in subjectively rating mass boundary spiculation levels ( 33 ). Hence, mass boundary spiculation is a very subjective concept and there is no “ground-truth” to evaluate the severity of spiculation levels and the accuracy of the computer schemes. In order to “quantitatively” evaluate the accuracy of our spiculation detection method, we applied a computed measure index to assess the spiculation levels of different mass regions. This quantitative measure is defined as S I = P 2 A , where SI denotes the spiculation index, P represents A the detected number of perimeter pixels, and is the mass area (the total pixels detected inside the mass region). Higher spiculated mass has more pixels detected in the perimeter, which generates larger SI value. This feature has been widely accepted as an effective evaluation index for spiculation in CAD schemes of mammograms ( 12 , 34 ). After applying our automated computer scheme to the image dataset to detect mass boundary spiculation and compute total 211 SI values (including 106 ones for circumscribed masses and 105 ones for spiculated masses), we applied receiver operating characteristics (ROC) analysis method ( 35 ) to evaluate the abilities of the spiculation measure in classification between these circumscribed and spiculated masses. Specifically, we used a publicly available ROC program (ROCFIT ( 36 )) that uses a maximum likelihood statistical method to fit the experimental data, generate a smoothed ROC curve, and compute the area under the ROC curve ( A z value) that is used as a performance index of our computer scheme.  RESULTS The difference of two histogram distributions of spiculation indices ( SI ) between 106 circumscribed mass regions and 105 spiculated mass regions was compared and plotted ( Figure 11 ). In average, the computed SI values of spiculated mass regions are higher than that of circumscribed mass regions. In this dataset, the average SI value for 106 circumscribed mass regions is 4.4 ± 3.1, while the average SI value for 105 spiculated mass regions is 7.1 ± 4.8, respectively. For example, the computed SI values for the two mass regions as shown in Figure 3a and Figure 3b are 7.0 and 3.0, respectively. If we apply a threshold ( SI = 5.0) to classify between spiculated and circumscribed mass regions, 140 out of 211 (66.4%) of mass regions including 57 spiculated mass regions (54.3%) and 83 circumscribed mass regions (78.3%) are classified into the correct group (category), while the remaining 71 (33.6%) of regions including 48 spiculated mass regions (45.7%) and 23 circumscribed mass regions (21.7%) are misclassified in the dataset used in this study. Thus, the overall accuracy at this threshold level is 66.4% with 54.3% sensitivity and 78.3% specificity, respectively. The corresponding “false-negative” rate is 0.23 (48/211) and “false-negative” rate is 0.11 (23/211). Based on the two histogram distributions as shown in Figure 11 , a computed ROC curve is plotted in Figure 12 . It shows the overall performance of this new computer scheme to detect and classify between spiculated and circumscribed mass regions in the dataset selected for this study. The computed area under ROC curve ( A z value) was 0.701 ± 0.027.  RESULTS The difference of two histogram distributions of spiculation indices ( SI ) between 106 circumscribed mass regions and 105 spiculated mass regions was compared and plotted ( Figure 11 ). In average, the computed SI values of spiculated mass regions are higher than that of circumscribed mass regions. In this dataset, the average SI value for 106 circumscribed mass regions is 4.4 ± 3.1, while the average SI value for 105 spiculated mass regions is 7.1 ± 4.8, respectively. For example, the computed SI values for the two mass regions as shown in Figure 3a and Figure 3b are 7.0 and 3.0, respectively. If we apply a threshold ( SI = 5.0) to classify between spiculated and circumscribed mass regions, 140 out of 211 (66.4%) of mass regions including 57 spiculated mass regions (54.3%) and 83 circumscribed mass regions (78.3%) are classified into the correct group (category), while the remaining 71 (33.6%) of regions including 48 spiculated mass regions (45.7%) and 23 circumscribed mass regions (21.7%) are misclassified in the dataset used in this study. Thus, the overall accuracy at this threshold level is 66.4% with 54.3% sensitivity and 78.3% specificity, respectively. The corresponding “false-negative” rate is 0.23 (48/211) and “false-negative” rate is 0.11 (23/211). Based on the two histogram distributions as shown in Figure 11 , a computed ROC curve is plotted in Figure 12 . It shows the overall performance of this new computer scheme to detect and classify between spiculated and circumscribed mass regions in the dataset selected for this study. The computed area under ROC curve ( A z value) was 0.701 ± 0.027.  DISCUSSION Mass boundary spiculation is a well recognized image feature in both visual and automated detection between true-positive and false-positive masses as well as classification between malignant and benign masses ( 18 ). It is also a very important and sensitive feature for improving visual similarity of similar reference masses selected by interactive CAD schemes ( 23 ). As a result, automated detection of spiculated mass regions has been attracting substantial research interest in CAD development. Although previous studies suggested that using CAD schemes involving automatically detected mass spiculation related features could achieve higher performance (in particular for the classification between malignant and benign masses) ( 19 – 22 ), the performance of these computer schemes in actually detecting mass spiculation levels or classifying between spiculated and non-spiculated (e.g., circumscribed) mass regions has not been quantitatively assessed and detailed reported. Without knowing the actual performance (including accuracy and robustness) of the schemes in detecting mass spiculation levels, it is difficult to assess the exact or the maximum potential contribution of the computed mass spiculated-related features to overall improvement of CAD performance. In this preliminary study, we focused on developing a new automated scheme to detect mass boundary spiculation levels and assessing the scheme performance of detection and classification between spiculated and circumscribed masses using a relatively large image dataset and ROC-type analytic method. In order to automatically detect the spiculated lines (or curves) connected to the mass boundary, accurate segmentation of mass boundary contour is an important procedure that determines the success or failure of the scheme in correctly detecting and classifying between spiculated and circumscribed mass regions. In our scheme we implement a unique algorithm to segment mass boundary. The segmentation algorithm combines the maximum entropy method with an active contour model. The testing results demonstrated that this algorithm could effectively segment mass boundary of most of typical masses in the dataset used in this study. This algorithm tends to smooth the mass region boundary and the segmented mass boundary contour closely matches with the real mass boundary except missing the attached spiculated lines (as shown in Figure 6 ). Then, the scheme applies a specially designed line detector to identify the connected spiculated lines. The detector includes several image processing steps of ( 1 ) coordinate transformation from original ( x, y ) to polar coordinates ( ?, d ), ( 2 ) filtering transformed images with a series of edge filter templates, and ( 3 ) line detection and labeling. The testing results indicated that this algorithm could detect a high fraction of spiculated lines even in the very low resolution images (with approximately 400?m × 400?m pixel size). As a result, this new computer scheme can efficiently detect and correctly classify majority of typical spiculated and circumscribed mass regions. For example, if we apply a threshold ( SI = 5.0) to classify between spiculated and circumscribed mass regions, approximately two thirds (140 out of 211) of mass regions are classified into the correct groups of two types of masses in this study. We recognize that the classification rate or ROC-based performance of the scheme in classification between spiculated and circumscribed mass regions remains relatively lower (with A z value = 0.701 ± 0.027 as shown in Figure 12 ). There are two reasons for this low A z value when applying our computer scheme. ( 1 ) The scheme fails to detect a fraction of spiculated lines for some low conspicuity mass regions surrounded with dense fibro-glandular breast tissue and ( 2 ) the scheme misrecognizes other surrounding linear structure (e.g., blood vessel) as spiculated lines connected to the circumscribed mass regions. Figure 13 demonstrates an example in which the scheme classifies a “spiculated” mass region as a circumscribed mass region (with SI value = 2.0) and Figure 14 shows another example in which a “circumscribed” mass region is classified as a spiculated region ( SI = 14.0). Therefore, achieving highly accurate and robust result of current computer schemes in detecting mass boundary spiculation remains a major technical challenge (in particular for CAD schemes that detect breast masses using low spatial resolution images). Despite the limitation on the scheme performance and the large inter-observer variability in rating mass spiculation levels ( 12 , 33 ), which may affect the reliability of the “truth” file, the overall performance reported in this study ( Figure 12 ) provides a useful reference of scheme performance in automatically detecting mass boundary spiculation levels. This performance reference level is not only useful for our future studies that aim to improve performance and robustness of our computer scheme in detecting and classifying spiculated masses, it can also be easily used by other research groups to compare and demonstrate the performance improvement of their computer schemes because this performance reference is generated using a publicly available image dataset (DDSM). In summary, we developed a new computer scheme with a number of unique characteristics to detect spiculated mass regions and applied a simple spiculation index to quantify mass spiculation levels. We assessed and reported the overall performance level of the computer scheme using a dataset that includes 105 “spiculated” and 106 “circumscribed” mass regions selected from a publicly available image database. The results of this preliminary study demonstrate that the overall performance of the computer scheme in detecting mass spiculation levels is relatively low due to the remaining technical challenge in automated detection of mass spiculation levels. Although the similar performance evaluation has not been performed and reported in previous studies by other research groups, we believe that this performance level is not the limitation that only applies to our current computer scheme. Therefore, further development and evaluation studies are needed in this area to improve the performance and robustness of computer schemes in detecting and quantifying mass boundary spiculation levels.  DISCUSSION Mass boundary spiculation is a well recognized image feature in both visual and automated detection between true-positive and false-positive masses as well as classification between malignant and benign masses ( 18 ). It is also a very important and sensitive feature for improving visual similarity of similar reference masses selected by interactive CAD schemes ( 23 ). As a result, automated detection of spiculated mass regions has been attracting substantial research interest in CAD development. Although previous studies suggested that using CAD schemes involving automatically detected mass spiculation related features could achieve higher performance (in particular for the classification between malignant and benign masses) ( 19 – 22 ), the performance of these computer schemes in actually detecting mass spiculation levels or classifying between spiculated and non-spiculated (e.g., circumscribed) mass regions has not been quantitatively assessed and detailed reported. Without knowing the actual performance (including accuracy and robustness) of the schemes in detecting mass spiculation levels, it is difficult to assess the exact or the maximum potential contribution of the computed mass spiculated-related features to overall improvement of CAD performance. In this preliminary study, we focused on developing a new automated scheme to detect mass boundary spiculation levels and assessing the scheme performance of detection and classification between spiculated and circumscribed masses using a relatively large image dataset and ROC-type analytic method. In order to automatically detect the spiculated lines (or curves) connected to the mass boundary, accurate segmentation of mass boundary contour is an important procedure that determines the success or failure of the scheme in correctly detecting and classifying between spiculated and circumscribed mass regions. In our scheme we implement a unique algorithm to segment mass boundary. The segmentation algorithm combines the maximum entropy method with an active contour model. The testing results demonstrated that this algorithm could effectively segment mass boundary of most of typical masses in the dataset used in this study. This algorithm tends to smooth the mass region boundary and the segmented mass boundary contour closely matches with the real mass boundary except missing the attached spiculated lines (as shown in Figure 6 ). Then, the scheme applies a specially designed line detector to identify the connected spiculated lines. The detector includes several image processing steps of ( 1 ) coordinate transformation from original ( x, y ) to polar coordinates ( ?, d ), ( 2 ) filtering transformed images with a series of edge filter templates, and ( 3 ) line detection and labeling. The testing results indicated that this algorithm could detect a high fraction of spiculated lines even in the very low resolution images (with approximately 400?m × 400?m pixel size). As a result, this new computer scheme can efficiently detect and correctly classify majority of typical spiculated and circumscribed mass regions. For example, if we apply a threshold ( SI = 5.0) to classify between spiculated and circumscribed mass regions, approximately two thirds (140 out of 211) of mass regions are classified into the correct groups of two types of masses in this study. We recognize that the classification rate or ROC-based performance of the scheme in classification between spiculated and circumscribed mass regions remains relatively lower (with A z value = 0.701 ± 0.027 as shown in Figure 12 ). There are two reasons for this low A z value when applying our computer scheme. ( 1 ) The scheme fails to detect a fraction of spiculated lines for some low conspicuity mass regions surrounded with dense fibro-glandular breast tissue and ( 2 ) the scheme misrecognizes other surrounding linear structure (e.g., blood vessel) as spiculated lines connected to the circumscribed mass regions. Figure 13 demonstrates an example in which the scheme classifies a “spiculated” mass region as a circumscribed mass region (with SI value = 2.0) and Figure 14 shows another example in which a “circumscribed” mass region is classified as a spiculated region ( SI = 14.0). Therefore, achieving highly accurate and robust result of current computer schemes in detecting mass boundary spiculation remains a major technical challenge (in particular for CAD schemes that detect breast masses using low spatial resolution images). Despite the limitation on the scheme performance and the large inter-observer variability in rating mass spiculation levels ( 12 , 33 ), which may affect the reliability of the “truth” file, the overall performance reported in this study ( Figure 12 ) provides a useful reference of scheme performance in automatically detecting mass boundary spiculation levels. This performance reference level is not only useful for our future studies that aim to improve performance and robustness of our computer scheme in detecting and classifying spiculated masses, it can also be easily used by other research groups to compare and demonstrate the performance improvement of their computer schemes because this performance reference is generated using a publicly available image dataset (DDSM). In summary, we developed a new computer scheme with a number of unique characteristics to detect spiculated mass regions and applied a simple spiculation index to quantify mass spiculation levels. We assessed and reported the overall performance level of the computer scheme using a dataset that includes 105 “spiculated” and 106 “circumscribed” mass regions selected from a publicly available image database. The results of this preliminary study demonstrate that the overall performance of the computer scheme in detecting mass spiculation levels is relatively low due to the remaining technical challenge in automated detection of mass spiculation levels. Although the similar performance evaluation has not been performed and reported in previous studies by other research groups, we believe that this performance level is not the limitation that only applies to our current computer scheme. Therefore, further development and evaluation studies are needed in this area to improve the performance and robustness of computer schemes in detecting and quantifying mass boundary spiculation levels.  Figures and Table Figure 1 The distribution of the subtle rating of the ROIs in our data set, remarked in DDSM. Figure 2 The distribution of the mass size of the ROIs in our data set. Figure 3 The original ROIs, the fitting planes, the subtracted ROIs, the background-trend corrected ROIs for a spiculated mass [(a)] and a circumscribed mass [(b)], (c) – (d) illustrate the fitting plane image of the original ROIs based on the least square method, (e) – (f) show the subtraction of the plane image from the original ROIs, and (g) – (h) are background-trend corrected ROIs. Figure 4 The segmentation results based on maximum entropy principle [(a), (b)], dilation results of (a) and (b) [(c), (d)], the first connected area boundaries [(e), (f)], the initial segmentation results shown on the original ROI. Figure 5 The gradient of background-trend corrected ROI obtained with our method [(a), (b)], the gradient of background-trend corrected ROI obtained with general method [(c), (d)]. Figure 6 The refined results shown on the original ROI. Figure 7 The polar coordinate representation image of background-trend corrected ROI. Figure 8 A series of edge filter templates. Figure 9 The gradient transformation images. Figure 10 The final segmented results of this segmentation algorithm in binary form [(a), (b)]. The final segmented results shown on the original ROIs [(c), (d)]. Figure 11 The histogram distribution of two types of mass regions using SI . Figure 12 ROC curves for classification between spiculated and circumscribed mass regions. Figure 13 An example of misclassification of a “spiculated” mass region. Figure 14 An example of misclassification of a “circumscribed” mass region. Table I Detailed description of the selected image dataset Digitizer Circumscribed mass Spiculated mass LUMISYS 70 44 HOWTEK 36 61 Total 106 105  Figures and Table Figure 1 The distribution of the subtle rating of the ROIs in our data set, remarked in DDSM. Figure 2 The distribution of the mass size of the ROIs in our data set. Figure 3 The original ROIs, the fitting planes, the subtracted ROIs, the background-trend corrected ROIs for a spiculated mass [(a)] and a circumscribed mass [(b)], (c) – (d) illustrate the fitting plane image of the original ROIs based on the least square method, (e) – (f) show the subtraction of the plane image from the original ROIs, and (g) – (h) are background-trend corrected ROIs. Figure 4 The segmentation results based on maximum entropy principle [(a), (b)], dilation results of (a) and (b) [(c), (d)], the first connected area boundaries [(e), (f)], the initial segmentation results shown on the original ROI. Figure 5 The gradient of background-trend corrected ROI obtained with our method [(a), (b)], the gradient of background-trend corrected ROI obtained with general method [(c), (d)]. Figure 6 The refined results shown on the original ROI. Figure 7 The polar coordinate representation image of background-trend corrected ROI. Figure 8 A series of edge filter templates. Figure 9 The gradient transformation images. Figure 10 The final segmented results of this segmentation algorithm in binary form [(a), (b)]. The final segmented results shown on the original ROIs [(c), (d)]. Figure 11 The histogram distribution of two types of mass regions using SI . Figure 12 ROC curves for classification between spiculated and circumscribed mass regions. Figure 13 An example of misclassification of a “spiculated” mass region. Figure 14 An example of misclassification of a “circumscribed” mass region. Table I Detailed description of the selected image dataset Digitizer Circumscribed mass Spiculated mass LUMISYS 70 44 HOWTEK 36 61 Total 106 105 