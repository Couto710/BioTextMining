A Practical Procedure for Real-Time Functional Mapping of Eloquent Cortex Using Electrocorticographic Signals in Humans Functional mapping of eloquent cortex is often necessary prior to invasive brain surgery, but current techniques that derive this mapping have important limitations. In this paper, we demonstrate the first comprehensive evaluation of a rapid, robust, and practical mapping system that uses passive recordings of electrocorticographic (ECoG) signals. This mapping procedure is based on the BC12000 and SIGFRIED technologies that we have been developing over the past several years. In our study, we evaluated ten epilepsy patients from four different institutions and compared the results of our procedure to the results derived using electrical cortical stimulation (ECS) mapping. The results show that our procedure derives a functional motor cortical map in only a few minutes. They also show a substantial concurrence with the results derived using ECS mapping. Specifically, compared to ECS maps, a next-neighbor evaluation showed no false negatives, and only 0.46% and 1.10% false positives for hand and tongue maps, respectively. In summary, we demonstrate the first comprehensive evaluation of a practical and robust mapping procedure that could become a new tool tor planning or invasive brain surgeries.  1. Introduction Resective brain surgery is often performed in people with intractable epilepsy, congenital structural lesions, vascular anomalies, and neoplasms. Surgical planning of the resection procedure depends substantially on the delineation of abnormal tissue, e.g., epileptic foci or tumor tissue, and on the creation of functional map of eloquent cortex in the area close to that abnormal tissue. Traditionally, different methodologies have been used to produce this functional map: electrical cortical stimulation (ECS) [ 1 , 2 , 3 ], functional magnetic resonance imaging (fMRI) [ 4 ], positron emission tomography (PET) [ 5 , 6 ], magnetoencephalography (MEG) [ 7 ], or evoked potentials (EP) [ 8 ]. Each of these methods has problems that include morbidity, time consumption, expense, or practicality. Since ECS has three quarters of a century of historical and clinical relevance [ 9 ], and perhaps also due to its relative procedural simplicity and low cost, ECS has become the gold standard in mapping eloquent cortex. It has gained broad acceptance despite limited data to support efficacy [ 10 ] and despite of several substantial issues. For example, ECS is time consuming because it requires a comprehensive search, i.e., stimulation of each grid contact, while simultaneously determining the appropriate stimulation amplitude. ECS can also produce after-discharges that may trigger seizures or even status epilepticus. This can result in substantial delays, aborted procedures, and patient morbidity. The results derived using ECS may also not be correct because: 1) stimulation may produce inhibitory responses that cannot readily be observed; 2) propagation of stimulation current is affected by the anatomy and potential after-discharges, and thus variable; 3) there may be substantial procedural variability; and 4) stimulation-based mapping is based on a lesional and not a physiological model. Finally, ECS depends on patient compliance and thus cannot easily be used in some patient populations (such as pediatric patients). The characteristics of ECS are summarized in Table 1 , and are reviewed in [ 11 ] and [ 12 ]. The problems described above increase the risk to the patient and the time and cost associated with surgical planning. Patients undergoing invasive brain surgery would benefit greatly from a mapping methodology that does not have the problems associated with existing techniques, i.e., a method that is safe, can be rapidly applied, is comparatively inexpensive, procedurally simple, and also congruent to existing techniques (in particular to electrical stimulation). Task-related changes detected in electrocorticographic (ECoG) recordings appear to have attractive properties (see Table 1 ) and thus could provide the basis for a technique with those desirable characteristics. This approach seems attractive in particular because existing surgical protocols typically already include the placement of subdural electrodes, and because a number of recent studies showed that ECoG activity recorded from these electrodes reflect task-related changes [ 13 , 14 , 15 , 16 , 17 , 18 , 19 , 20 , 21 , 22 , 23 , 24 ]. These studies showed that ECoG amplitudes in particular frequency bands carry substantial information about movement or language tasks. Specifically, amplitudes typically decrease in the mu (8-12 Hz) and beta (18-25 Hz) bands, whereas amplitudes usually increase in the gamma (>40 Hz) band (see Fig. 1 ). Furthermore, recent studies demonstrated that such ECoG changes, in particular those in the gamma band, were in general agreement with those derived using fMRI [ 25 ] and with results determined using ECS [ 22 , 24 , 23 ]. However, these traditional ECoG-based analyses usually need to be optimized for each individual. Typically they are generated by signal processing experts after comprehensive post-hoc analyses. While a few recent studies have provided encouraging evidence that ECoG-based analyses could become more accessible to clinicians [ 26 , 27 , 28 ], a widely available and robust procedure that can be utilized by non-experts is needed. We demonstrate here a comprehensive evaluation of a robust, practical, and readily available procedure for presurgical functional mapping of eloquent cortex using subdural electrodes. This procedure is based on our BCI2000 and SIGFRIED (STGnal modeling For Real-time Identification and Event Detection) technologies. BCI2000 is a general-purpose software platform for real-time biosignal acquisition, processing, and feedback [ 29 , 30 ] ( http://www.bci2000.org ). In collaboration with other institutions, most notably the University of Tübingen in Germany, we have been developing BCI2000 for close to ten years. BCI2000 is currently in use by more than 300 laboratories world-wide for a variety of studies. It supports more than 15 different signal acquisition devices and can thus be readily integrated in different research or clinical environments. SIGFRIED [ 31 , 32 ] is a signal processing procedure implemented within BCI2000 that can detect and visualize task-related changes in real time without prior parameterization (e.g., of frequency bands, visualization parameters, etc.) by an expert. In this paper, we demonstrate the use of the SIGFRIED/BCI2000 system for delineating cortical areas related to tongue and hand motor function in ten patients from four institutions. The results show that our method can provide a functional map within only a few minutes and that this map is in strong congruence to that derived by ECS mapping. Furthermore, they demonstrate that our technique provides robust and practical mapping capabilities in different clinical environments.  2. Material and Methods 2.1. Human Subjects A total of 10 patients ( Table 2 ) at Albany Medical Center (Albany, NY) [AMC1-5], Barnes-Jewish Hospital (St. Louis, MO) [BJH1], Middleton Memorial Veterans Hospital (Madison, WI) [VAH1-2] and University Medical Center Utrecht (Utrecht, The Netherlands) [UMC1-2] were implanted with subdural platinum electrodes arrays (4 mm diameter, 2.3 mm exposed, 1 cm inter-electrode spacing, Ad-Tech, Racine, WT) for a period of 5-12 days prior to resection of a seizure focus. In each patient, the seizure focus. In each patient, the seizure focus was identified by neurologists using visual inspection, and eloquent cortex was identified over a period of 1.5-7.5 hours using electrical cortical stimulation (ECS). For the majority of patients, this stimulation was not completed, thereby leaving 12% to 74% of the covered cortex without stimulation results. Grid locations were classified as hand or tongue function if stimulation (typically 1 to 4 mA) elicited or inhibited motor activity or sensation. Some of the contacts were not stimulated for different reasons: (1) tney had no relevance to the surgical procedure, i.e., they were sufficiently distant to any planned resection; (2) the minimum stimulation current (e.g., 4 mA) could not be reached without inducing pain; (3) stimulation induced a seizure before any response was detected; (4) time constraints; (5) stimulation induced global after-discharges. The locations of the seizure foci and eloquent cortex were subsequently used for planning of surgical resection. Location and duration of the implantation were solely determined by clinical criteria and only patients with some peri-rolandic coverage were included in the study. All patients gave informed consent through a protocol reviewed and approved by each of the participating institution's review board. 2.2. Data Collection During the monitoring period, we recorded ECoG signals at the bedside from 32-128 contacts of the implanted grids using different biosignal acquisition devices ( Table 3 ). Scalp or grid electrodes were used for reference and ground. Data collection and stimulus presentation was accomplished using BCI2000 [ 29 ] software, a general-purpose system for real-time biosignal acquisition, processing and feedback. Real-time signal processing and visualization was performed using the SIGFRIED method [ 31 , 32 ] implemented within BCI2000. 2.3. Experimental Protocol We first recorded 6 minutes of baseline data during which the subject was asked to remain relaxed and to avoid any movements. Then, each subject performed alternating sequences of repetitive movements of the tongue, i.e., protrusion and retracting of the tongue, movements of the hand, i.e., opening and closing of the hand contralateral to the side of the grid placement, and resting. The subject was visually cued by the words “tongue” or “hand”, which were presented on a computer screen (a blank screen indicated the resting period). Each task was performed for a duration of 3 seconds (15 seconds for subject UMC1) at a self-paced rate of about two repetitions per second, followed by a resting period of the same duration ( Fig. 3 ) before the next task. One run consisted of 15 repetitions of this sequence over the course of 180 seconds. We typically recorded one initial run to familiarize the subject with the task. All analyses in this paper are for one run following the initial training run. The visual display to the investigator during online operation of this run was provided as described below. 2.4. Signal Analysis To provide a basis for real-time feedback, we first used the SIGFRIED procedure [ 31 , 32 ] to establish a statistical model of the recorded baseline data. While the subject executed the task, we then used this procedure to identify in real-time those grid contacts that showed activity changes that were statistically different from the baseline model. In short, we used the following signal preprocessing, feature extraction and feature selection configurations: first, the signal from each grid contact was re-referenced using a common average reference (CAR) filter [ 33 ]. Then, for each grid contact and 500 ms time period, the time series ECoG signal was converted into the frequency domain using an autoregressive model [ 34 , 35 , 36 ] with a model order of l/10th of the sampling rate. Frequencies between 70-100 Hz (ten bins at 4 Hz bandwidth) were submitted to SIGFRIED. During online processing, SIGFRIED then utilized the established baseline model to calculate for each grid contact the likelihood that the signal at that grid contact was statistically different from the modeled baseline signals. This likelihood was calculated every 28.27 to 66.66 ms (see Table 2 ). Fig. 4 illustrates time courses of the negative log-transformed likelihood values for two locations recorded from subject VAH2. The upper trace corresponds to the location marked with a star in Fig. 7 . The bottom trace corresponds to the location marked with a rectangle. The times of cue presentation for hand movements are marked with yellow bars and for tongue movements with red bars. Interleaved rest periods are shown in white. The SIGFRIED trace in the upper figure detects hand movements but not tongue movements, whereas the bottom trace detects tongue but not hand movements. Finally, for each grid contact and task, the distribution of the negative log-transformed likelihood values was further re-referenced to those values calculated during the resting period between the tasks by calculating the value of r2, i.e., the proportion of values that was accounted for by the task. This resulted in a value between 0 (not different) and 1 (very different) for each grid contact and task. 2.5. Interface to the investigator The results from the signal analyses described above were presented to the investigator in real time using a topo-graphic interface ( Fig. 5 ). The interface contained, for each task (i.e., hand or tongue), a display of the r2 values at each location. Each display contained one circle at each electrode's location. The size of each circle and its tint was proportional to the r2 value. Thus, a large red circle represented a large statistical difference between the corresponding task and rest, while a small black circle indicated a small statistical difference. The display corresponding to each task was autoscaled to the minimum and maximum r2 value. Thus, no parameter (e.g., frequency range, display or detection parameters, etc.) needed to be changed by the investigator prior to or during system operation.  2.1. Human Subjects A total of 10 patients ( Table 2 ) at Albany Medical Center (Albany, NY) [AMC1-5], Barnes-Jewish Hospital (St. Louis, MO) [BJH1], Middleton Memorial Veterans Hospital (Madison, WI) [VAH1-2] and University Medical Center Utrecht (Utrecht, The Netherlands) [UMC1-2] were implanted with subdural platinum electrodes arrays (4 mm diameter, 2.3 mm exposed, 1 cm inter-electrode spacing, Ad-Tech, Racine, WT) for a period of 5-12 days prior to resection of a seizure focus. In each patient, the seizure focus. In each patient, the seizure focus was identified by neurologists using visual inspection, and eloquent cortex was identified over a period of 1.5-7.5 hours using electrical cortical stimulation (ECS). For the majority of patients, this stimulation was not completed, thereby leaving 12% to 74% of the covered cortex without stimulation results. Grid locations were classified as hand or tongue function if stimulation (typically 1 to 4 mA) elicited or inhibited motor activity or sensation. Some of the contacts were not stimulated for different reasons: (1) tney had no relevance to the surgical procedure, i.e., they were sufficiently distant to any planned resection; (2) the minimum stimulation current (e.g., 4 mA) could not be reached without inducing pain; (3) stimulation induced a seizure before any response was detected; (4) time constraints; (5) stimulation induced global after-discharges. The locations of the seizure foci and eloquent cortex were subsequently used for planning of surgical resection. Location and duration of the implantation were solely determined by clinical criteria and only patients with some peri-rolandic coverage were included in the study. All patients gave informed consent through a protocol reviewed and approved by each of the participating institution's review board.  2.2. Data Collection During the monitoring period, we recorded ECoG signals at the bedside from 32-128 contacts of the implanted grids using different biosignal acquisition devices ( Table 3 ). Scalp or grid electrodes were used for reference and ground. Data collection and stimulus presentation was accomplished using BCI2000 [ 29 ] software, a general-purpose system for real-time biosignal acquisition, processing and feedback. Real-time signal processing and visualization was performed using the SIGFRIED method [ 31 , 32 ] implemented within BCI2000.  2.3. Experimental Protocol We first recorded 6 minutes of baseline data during which the subject was asked to remain relaxed and to avoid any movements. Then, each subject performed alternating sequences of repetitive movements of the tongue, i.e., protrusion and retracting of the tongue, movements of the hand, i.e., opening and closing of the hand contralateral to the side of the grid placement, and resting. The subject was visually cued by the words “tongue” or “hand”, which were presented on a computer screen (a blank screen indicated the resting period). Each task was performed for a duration of 3 seconds (15 seconds for subject UMC1) at a self-paced rate of about two repetitions per second, followed by a resting period of the same duration ( Fig. 3 ) before the next task. One run consisted of 15 repetitions of this sequence over the course of 180 seconds. We typically recorded one initial run to familiarize the subject with the task. All analyses in this paper are for one run following the initial training run. The visual display to the investigator during online operation of this run was provided as described below.  2.4. Signal Analysis To provide a basis for real-time feedback, we first used the SIGFRIED procedure [ 31 , 32 ] to establish a statistical model of the recorded baseline data. While the subject executed the task, we then used this procedure to identify in real-time those grid contacts that showed activity changes that were statistically different from the baseline model. In short, we used the following signal preprocessing, feature extraction and feature selection configurations: first, the signal from each grid contact was re-referenced using a common average reference (CAR) filter [ 33 ]. Then, for each grid contact and 500 ms time period, the time series ECoG signal was converted into the frequency domain using an autoregressive model [ 34 , 35 , 36 ] with a model order of l/10th of the sampling rate. Frequencies between 70-100 Hz (ten bins at 4 Hz bandwidth) were submitted to SIGFRIED. During online processing, SIGFRIED then utilized the established baseline model to calculate for each grid contact the likelihood that the signal at that grid contact was statistically different from the modeled baseline signals. This likelihood was calculated every 28.27 to 66.66 ms (see Table 2 ). Fig. 4 illustrates time courses of the negative log-transformed likelihood values for two locations recorded from subject VAH2. The upper trace corresponds to the location marked with a star in Fig. 7 . The bottom trace corresponds to the location marked with a rectangle. The times of cue presentation for hand movements are marked with yellow bars and for tongue movements with red bars. Interleaved rest periods are shown in white. The SIGFRIED trace in the upper figure detects hand movements but not tongue movements, whereas the bottom trace detects tongue but not hand movements. Finally, for each grid contact and task, the distribution of the negative log-transformed likelihood values was further re-referenced to those values calculated during the resting period between the tasks by calculating the value of r2, i.e., the proportion of values that was accounted for by the task. This resulted in a value between 0 (not different) and 1 (very different) for each grid contact and task.  2.5. Interface to the investigator The results from the signal analyses described above were presented to the investigator in real time using a topo-graphic interface ( Fig. 5 ). The interface contained, for each task (i.e., hand or tongue), a display of the r2 values at each location. Each display contained one circle at each electrode's location. The size of each circle and its tint was proportional to the r2 value. Thus, a large red circle represented a large statistical difference between the corresponding task and rest, while a small black circle indicated a small statistical difference. The display corresponding to each task was autoscaled to the minimum and maximum r2 value. Thus, no parameter (e.g., frequency range, display or detection parameters, etc.) needed to be changed by the investigator prior to or during system operation.  3. Results 3.1. Qualitative Results The following paragraphs present the results derived using the SIGFRIED mapping procedure, and qualitatively and quantitatively compare the results to those obtained with ECS mapping. The main results of this paper are shown for all subjects in Fig. 6 and 7 , and in Supplementary Videos 1 and 2 . In each figure, the lateral radiographs (all subjects except UMC1 and UMC2) or computer tomography (CT) images (UMC1 and UMC2) on the left show grid contacts marked by colored circles. Contacts that were stimulated and identified as cloquent cortex associated with hand function are shown in yellow, those associated with tongue function are shown in red, and those associated with neither hand nor tongue function are shown in white. Semi-transparent white circles indicate locations that were not stimulated. The four detailed lateral radiographs/CT images on the right show the results of the SIGFRIED mapping procedure derived after 30, 60, 120 and 180 seconds. Similarly to the ECS results shown on the very left, yellow circles indicate the results for the hand task, and red circles indicate tne results for the tongue task. Locations that were excluded (e.g., due to broken connectors) or not recorded (e.g., due to limitation in the number of channels) are left blank. The final maximum r2 (i.e., the value of r2 of the largest circle in each figure) after 180 seconds is noted on the right for hand (range 0.05 to 0.61) and tongue (range 0.10 to 0.51). 3.2. Quantitative Results The results in Fig. 6 and 7 show substantial agreement to those derived using electrical stimulation. In addition, we assessed these results using two quantitative comparisons. For both comparisons of tongue and hand, the r2 values at each location were classified as eloquent or non-eloquent with a threshold that was derived using Minimum Bayesian Error [ 37 ]. The first comparison in Table 4 provides a quantitative analysis for the 18 to 77 contacts that were both stimulated by ECS and mapped with SIGFRIED. This comparison was done independently for hand and tongue and resulted in a correct or incorrect match between ECS and SIGFRIED at each location. The incorrect results were further classified into false positives, i.e., contacts identified by SIGFRIED but not by ECS, and false negatives, i.e., contacts identified by ECS but not by SIGFRIED. Table 4 shows that there were more false positives than false negatives. For three subjects (AMC1, VAH1 and VAH2), no false negatives for hand and tongue were identified. We hypothesized that most of the incorrect results would have been correct if they had been derived for a next neighbor. Table 5 shows the results of the corresponding analysis. While this analysis effectively corresponds to a reduction in the resolution of the mapping, this procedure resulted in no false negatives, and only in 0.46% and 1.10% false positives for hand and tongue maps, respectively.  3. Results 3.1. Qualitative Results The following paragraphs present the results derived using the SIGFRIED mapping procedure, and qualitatively and quantitatively compare the results to those obtained with ECS mapping. The main results of this paper are shown for all subjects in Fig. 6 and 7 , and in Supplementary Videos 1 and 2 . In each figure, the lateral radiographs (all subjects except UMC1 and UMC2) or computer tomography (CT) images (UMC1 and UMC2) on the left show grid contacts marked by colored circles. Contacts that were stimulated and identified as cloquent cortex associated with hand function are shown in yellow, those associated with tongue function are shown in red, and those associated with neither hand nor tongue function are shown in white. Semi-transparent white circles indicate locations that were not stimulated. The four detailed lateral radiographs/CT images on the right show the results of the SIGFRIED mapping procedure derived after 30, 60, 120 and 180 seconds. Similarly to the ECS results shown on the very left, yellow circles indicate the results for the hand task, and red circles indicate tne results for the tongue task. Locations that were excluded (e.g., due to broken connectors) or not recorded (e.g., due to limitation in the number of channels) are left blank. The final maximum r2 (i.e., the value of r2 of the largest circle in each figure) after 180 seconds is noted on the right for hand (range 0.05 to 0.61) and tongue (range 0.10 to 0.51). 3.2. Quantitative Results The results in Fig. 6 and 7 show substantial agreement to those derived using electrical stimulation. In addition, we assessed these results using two quantitative comparisons. For both comparisons of tongue and hand, the r2 values at each location were classified as eloquent or non-eloquent with a threshold that was derived using Minimum Bayesian Error [ 37 ]. The first comparison in Table 4 provides a quantitative analysis for the 18 to 77 contacts that were both stimulated by ECS and mapped with SIGFRIED. This comparison was done independently for hand and tongue and resulted in a correct or incorrect match between ECS and SIGFRIED at each location. The incorrect results were further classified into false positives, i.e., contacts identified by SIGFRIED but not by ECS, and false negatives, i.e., contacts identified by ECS but not by SIGFRIED. Table 4 shows that there were more false positives than false negatives. For three subjects (AMC1, VAH1 and VAH2), no false negatives for hand and tongue were identified. We hypothesized that most of the incorrect results would have been correct if they had been derived for a next neighbor. Table 5 shows the results of the corresponding analysis. While this analysis effectively corresponds to a reduction in the resolution of the mapping, this procedure resulted in no false negatives, and only in 0.46% and 1.10% false positives for hand and tongue maps, respectively.  3.1. Qualitative Results The following paragraphs present the results derived using the SIGFRIED mapping procedure, and qualitatively and quantitatively compare the results to those obtained with ECS mapping. The main results of this paper are shown for all subjects in Fig. 6 and 7 , and in Supplementary Videos 1 and 2 . In each figure, the lateral radiographs (all subjects except UMC1 and UMC2) or computer tomography (CT) images (UMC1 and UMC2) on the left show grid contacts marked by colored circles. Contacts that were stimulated and identified as cloquent cortex associated with hand function are shown in yellow, those associated with tongue function are shown in red, and those associated with neither hand nor tongue function are shown in white. Semi-transparent white circles indicate locations that were not stimulated. The four detailed lateral radiographs/CT images on the right show the results of the SIGFRIED mapping procedure derived after 30, 60, 120 and 180 seconds. Similarly to the ECS results shown on the very left, yellow circles indicate the results for the hand task, and red circles indicate tne results for the tongue task. Locations that were excluded (e.g., due to broken connectors) or not recorded (e.g., due to limitation in the number of channels) are left blank. The final maximum r2 (i.e., the value of r2 of the largest circle in each figure) after 180 seconds is noted on the right for hand (range 0.05 to 0.61) and tongue (range 0.10 to 0.51).  3.1. Qualitative Results The following paragraphs present the results derived using the SIGFRIED mapping procedure, and qualitatively and quantitatively compare the results to those obtained with ECS mapping. The main results of this paper are shown for all subjects in Fig. 6 and 7 , and in Supplementary Videos 1 and 2 . In each figure, the lateral radiographs (all subjects except UMC1 and UMC2) or computer tomography (CT) images (UMC1 and UMC2) on the left show grid contacts marked by colored circles. Contacts that were stimulated and identified as cloquent cortex associated with hand function are shown in yellow, those associated with tongue function are shown in red, and those associated with neither hand nor tongue function are shown in white. Semi-transparent white circles indicate locations that were not stimulated. The four detailed lateral radiographs/CT images on the right show the results of the SIGFRIED mapping procedure derived after 30, 60, 120 and 180 seconds. Similarly to the ECS results shown on the very left, yellow circles indicate the results for the hand task, and red circles indicate tne results for the tongue task. Locations that were excluded (e.g., due to broken connectors) or not recorded (e.g., due to limitation in the number of channels) are left blank. The final maximum r2 (i.e., the value of r2 of the largest circle in each figure) after 180 seconds is noted on the right for hand (range 0.05 to 0.61) and tongue (range 0.10 to 0.51).  3.2. Quantitative Results The results in Fig. 6 and 7 show substantial agreement to those derived using electrical stimulation. In addition, we assessed these results using two quantitative comparisons. For both comparisons of tongue and hand, the r2 values at each location were classified as eloquent or non-eloquent with a threshold that was derived using Minimum Bayesian Error [ 37 ]. The first comparison in Table 4 provides a quantitative analysis for the 18 to 77 contacts that were both stimulated by ECS and mapped with SIGFRIED. This comparison was done independently for hand and tongue and resulted in a correct or incorrect match between ECS and SIGFRIED at each location. The incorrect results were further classified into false positives, i.e., contacts identified by SIGFRIED but not by ECS, and false negatives, i.e., contacts identified by ECS but not by SIGFRIED. Table 4 shows that there were more false positives than false negatives. For three subjects (AMC1, VAH1 and VAH2), no false negatives for hand and tongue were identified. We hypothesized that most of the incorrect results would have been correct if they had been derived for a next neighbor. Table 5 shows the results of the corresponding analysis. While this analysis effectively corresponds to a reduction in the resolution of the mapping, this procedure resulted in no false negatives, and only in 0.46% and 1.10% false positives for hand and tongue maps, respectively.  3.2. Quantitative Results The results in Fig. 6 and 7 show substantial agreement to those derived using electrical stimulation. In addition, we assessed these results using two quantitative comparisons. For both comparisons of tongue and hand, the r2 values at each location were classified as eloquent or non-eloquent with a threshold that was derived using Minimum Bayesian Error [ 37 ]. The first comparison in Table 4 provides a quantitative analysis for the 18 to 77 contacts that were both stimulated by ECS and mapped with SIGFRIED. This comparison was done independently for hand and tongue and resulted in a correct or incorrect match between ECS and SIGFRIED at each location. The incorrect results were further classified into false positives, i.e., contacts identified by SIGFRIED but not by ECS, and false negatives, i.e., contacts identified by ECS but not by SIGFRIED. Table 4 shows that there were more false positives than false negatives. For three subjects (AMC1, VAH1 and VAH2), no false negatives for hand and tongue were identified. We hypothesized that most of the incorrect results would have been correct if they had been derived for a next neighbor. Table 5 shows the results of the corresponding analysis. While this analysis effectively corresponds to a reduction in the resolution of the mapping, this procedure resulted in no false negatives, and only in 0.46% and 1.10% false positives for hand and tongue maps, respectively.  4. Discussion We provide the first comprehensive demonstration of a functional mapping procedure that is rapid, practical, robust, and accurate in localizing primary motor cortex. In our evaluation of ten patients from four institutions, we found that the SIGFRIED procedure identifies at least the same contacts or their immediate neighbors compared to ECS mapping. These results may have important implications for functional localization prior to invasive brain surgery. Our method can be used with little training and can be readily implemented in the typical clinical environment. In fact, our system is currently in evaluation by a number of epilepsy centers in the US and Europe. Thus, we believe that the SIGFRIED/BCI2000 system has the potential for widespread adoption in a large number of centers world-wide. At the same time, this new mapping platform is opening up several important research questions: e.g., which tasks are best suited to elicit appropriate responses for different classes of anatomical areas? What are the situations or populations (e.g., children) for which this method provides the maximum benefit? What is the efficacy of the SIGFRIED method for other brain functions, in particular for mapping expressive and receptive language? (Ongoing work in our laboratory is providing encouraging evidence in this regard.) It is at present also unclear how this method will be integrated in the clinical workflow. Despite the strong congruence of the SIGFRIED-based results to ECS-based results, it is likely premature to replace ECS mapping with SIGFRIED-based mapping. Rather, it seems to be more appropriate to optimize ECS mapping based on the results of prior SIGFRIED mapping. Like the recent study by Miller et al. [ 23 ], our study demonstrates considerable variance in the somatotopy across subjects and coherence with the ECS mapping results. Both location and area identified as eloquent cortex vary among subjects. While for Miller et al. it was not clear whether this was due to subject variability or expert variability in performing the ECS, our study shows that a next-neighbor analysis achieves an almost perfect coherence with the ECS mapping results. This suggests that most of the variance is due to expert variability. Crone et al. [ 14 ] reported that not all subjects displayed changes in the gamma band. This is in contrast to the results of this study that showed adequate task-related changes of gamma amplitudes (which were the basis for the SIGFRIED calculations) in all ten subjects. It is possible that this is due to a difference in hardware, processing, or motor tasks. For example, our own experience, and also results from a previous study [ 15 ], suggest that more complex tasks (such as the Rubic's cube manipulation task in Supplementary Videos 1 and 2 ) increase the amplitude of the gamma changes. The SIGFRIED results were generally in substantial agreement to those derived using electrical stimulation, but there were some differences. These differences could be attributed to several factors that include expert variability in ECS mapping or ECS's variable current spread, low statistical significance, or the characteristics of the subject's task. Cortex at remote locations may be activated due to current spread, and thus result in a site that is registered by ECS and not by SIGFRIED. Conversely, SIGFRIED may falsely register sites with low statistical significance. For example, consider the map for hand function in subject AMC3 (shown in Fig. 6 ). This subject's grid did not have hand coverage, i.e., ECS mapping did not detect hand function in any electrode. The SIGFRIED map highlights several sites, although the maximum r2 value (0.05) was very low. Thus, the magnitude of the maximum r2 value gives an index of confidence in a particular map. Future versions of the software could even calculate such a confidence index (i.e. a p-value) explicitly. The factor that may have the larsest influence on the differences between the ECS and the SIGFRIED maps may be the nature of the subject's task. In one extreme, this task would be very simple, and only require very limited areas of cortex for its execution. In this case, SIGFRIED would only register very few electrodes or none at all. In the other extreme, the subject's task would be difficult and require engagement of different cortical facilities. Thus, the use of this task would result in activation of more widespread areas of cortex, and consequently, SIGFRIED would detect changes in more electrodes. As described above, recent experiments suggest that the use of more complex visuomotor tasks results in even more robust maps. In sum, the optimal tasks for mapping motor and other cortices using the SIGFRIED method are currently unknown. However, the rapidity of our method facilitates the use of several tasks that engage the desired cortical area in different ways. The SIGFRIED mapping overcomes many problems associated with ECS. It is also based on a different principle. While ECS is based on a lesional model [ 38 ], SIGFRIED is based on task-related changes in ECoG signals. The clinical impact of this difference is currently unclear. It is thought that the lesional model utilized with ECS closely resembles the effect of surgical resection, in that it allows the identification of those areas that are critical for a particular function. In contrast, SIGFRIED detects those areas that change their activity with a particular task. It may not detect areas that do not change their activity but are critical for a particular function, or may detect areas that change their activity but are not critical. At the same time, ECS clearly has problems of accuracy itself, e.g., because there is no defined standard for ECS mapping, because there are practical (in particular time) constraints for using ECS, and because the resolution of ECS is limited due to current spread and the need for bipolar stimulation. In summary, at this early stage of clinical validation, replacing ECS with the SIGFRIED/BCI2000 system is not warranted. Nevertheless, despite its potential limitations, there may already be distinct advantages over ECS mapping. The ECS protocol labels each contact with the eloquent function that is elicited or inhibited as the contact is stimulated. Finding eloquent function at a low threshold terminates the protocol for this contact, assuming that each type eloquent function is spatially contiguous as it is suggested by the motor homunculus model [ 39 ]. Recent fMRI [ 40 ] and ECS [ 10 ] studies, however, show a more complex and spatially noncontiguous somatotopy. The SIGFRIED mapping could establish a comparable somatotopy by exploring different tasks, for example a dedicated motor/sensory evaluation for each finger. This could allow more detailed surgical planning and thus benefit the outcome of the resection procedure. However, the lack of a verifiable gold standard makes it difficult to assess the quality of such a more detailed somatotopy. Only surgical outcome can provide a detailed assessment on whether a more detailed somatotopy may be beneficial. Studies have shown task-related changes associated with ipsilateral movements in the low frequency band [ 41 , 42 , 43 , 44 , 45 , 46 , 47 , 48 ]. The implications of resecting cortical areas associated with these ipsilateral movements have not been defined, mainly because ECS is not able to elicit ipsilateral limb movement within the conventional stimulation thresholds [ 49 , 50 ]. The SIGFRIED mapping could facilitate such studies by exploring ipsilateral tasks. An initial application of the SIGFRIED/BCI2000 system is shown here, but there are several ways in which this system can be further improved. As a first example of the potential for improvement, we observed a noticeable delay between stimulus onset and the patient's response even when there was good compliance of the subiect. Crone et al. also reported such delays, and estimated them to be in the 300-400 ms range for simple visually cued hand movements and tongue protrusions [ 14 ]. Our results show similar delays (see Fig. 4 ). Because the total duration of each stimulus was only 3 sec (15 sec for subject UMC1), a significant fraction of the signals were thus effectively assigned to the incorrect task category. In more recent experiments, we have begun to alert the subject to the change in condition by presenting an auditory stimulus, and we suspend data analysis for 1 sec. In the end, it may be possible to partially or even completely eliminate this need for patient compliance, which is currently an issue for all mapping techniques. For example, for motor tasks it would be relatively straightforward to utilize motion sensors, such as a data glove, motion capture device, or EMG electrodes, and to simply correlate SIGFRIED values with the detected motion rather than with the stimulus. For sensory input, it would be possible to use programmable tactile stimulators and earphones. Thus, such approaches may fully remove the requirement for patient compliance and facilitate mapping in pediatric environments where patient compliance is either impossible (e.g., with infants) or hard to obtain (e.g., with young children). As another example for potential further improvements, it may be possible to use the SIGFRIED mapping intraoperatively. This possibility could replace the two surgeries that are currently necessary with one surgery that encompasses grid placement, mapping of eloquent cortex, and resection. In particular in patients that do not require longer monitoring periods (e.g., tumor patients), this would significantly decrease risks to the patient and costs of the hospitalization. In conclusion, in this paper we presented the SIGFRIED/BCI2000 system as a practical functional mapping procedure. This system is readily available at no cost for research and educational purposes at www.bci2000.org , and there is substantial documentation on its theory [ 29 , 30 , 31 , 32 ] and use (doc.bci2000.org). BCI2000 currently supports signal acquisition from 15 different devices, and more are continually added. This should facilitate the integration in existing clinical environments.  4. Discussion We provide the first comprehensive demonstration of a functional mapping procedure that is rapid, practical, robust, and accurate in localizing primary motor cortex. In our evaluation of ten patients from four institutions, we found that the SIGFRIED procedure identifies at least the same contacts or their immediate neighbors compared to ECS mapping. These results may have important implications for functional localization prior to invasive brain surgery. Our method can be used with little training and can be readily implemented in the typical clinical environment. In fact, our system is currently in evaluation by a number of epilepsy centers in the US and Europe. Thus, we believe that the SIGFRIED/BCI2000 system has the potential for widespread adoption in a large number of centers world-wide. At the same time, this new mapping platform is opening up several important research questions: e.g., which tasks are best suited to elicit appropriate responses for different classes of anatomical areas? What are the situations or populations (e.g., children) for which this method provides the maximum benefit? What is the efficacy of the SIGFRIED method for other brain functions, in particular for mapping expressive and receptive language? (Ongoing work in our laboratory is providing encouraging evidence in this regard.) It is at present also unclear how this method will be integrated in the clinical workflow. Despite the strong congruence of the SIGFRIED-based results to ECS-based results, it is likely premature to replace ECS mapping with SIGFRIED-based mapping. Rather, it seems to be more appropriate to optimize ECS mapping based on the results of prior SIGFRIED mapping. Like the recent study by Miller et al. [ 23 ], our study demonstrates considerable variance in the somatotopy across subjects and coherence with the ECS mapping results. Both location and area identified as eloquent cortex vary among subjects. While for Miller et al. it was not clear whether this was due to subject variability or expert variability in performing the ECS, our study shows that a next-neighbor analysis achieves an almost perfect coherence with the ECS mapping results. This suggests that most of the variance is due to expert variability. Crone et al. [ 14 ] reported that not all subjects displayed changes in the gamma band. This is in contrast to the results of this study that showed adequate task-related changes of gamma amplitudes (which were the basis for the SIGFRIED calculations) in all ten subjects. It is possible that this is due to a difference in hardware, processing, or motor tasks. For example, our own experience, and also results from a previous study [ 15 ], suggest that more complex tasks (such as the Rubic's cube manipulation task in Supplementary Videos 1 and 2 ) increase the amplitude of the gamma changes. The SIGFRIED results were generally in substantial agreement to those derived using electrical stimulation, but there were some differences. These differences could be attributed to several factors that include expert variability in ECS mapping or ECS's variable current spread, low statistical significance, or the characteristics of the subject's task. Cortex at remote locations may be activated due to current spread, and thus result in a site that is registered by ECS and not by SIGFRIED. Conversely, SIGFRIED may falsely register sites with low statistical significance. For example, consider the map for hand function in subject AMC3 (shown in Fig. 6 ). This subject's grid did not have hand coverage, i.e., ECS mapping did not detect hand function in any electrode. The SIGFRIED map highlights several sites, although the maximum r2 value (0.05) was very low. Thus, the magnitude of the maximum r2 value gives an index of confidence in a particular map. Future versions of the software could even calculate such a confidence index (i.e. a p-value) explicitly. The factor that may have the larsest influence on the differences between the ECS and the SIGFRIED maps may be the nature of the subject's task. In one extreme, this task would be very simple, and only require very limited areas of cortex for its execution. In this case, SIGFRIED would only register very few electrodes or none at all. In the other extreme, the subject's task would be difficult and require engagement of different cortical facilities. Thus, the use of this task would result in activation of more widespread areas of cortex, and consequently, SIGFRIED would detect changes in more electrodes. As described above, recent experiments suggest that the use of more complex visuomotor tasks results in even more robust maps. In sum, the optimal tasks for mapping motor and other cortices using the SIGFRIED method are currently unknown. However, the rapidity of our method facilitates the use of several tasks that engage the desired cortical area in different ways. The SIGFRIED mapping overcomes many problems associated with ECS. It is also based on a different principle. While ECS is based on a lesional model [ 38 ], SIGFRIED is based on task-related changes in ECoG signals. The clinical impact of this difference is currently unclear. It is thought that the lesional model utilized with ECS closely resembles the effect of surgical resection, in that it allows the identification of those areas that are critical for a particular function. In contrast, SIGFRIED detects those areas that change their activity with a particular task. It may not detect areas that do not change their activity but are critical for a particular function, or may detect areas that change their activity but are not critical. At the same time, ECS clearly has problems of accuracy itself, e.g., because there is no defined standard for ECS mapping, because there are practical (in particular time) constraints for using ECS, and because the resolution of ECS is limited due to current spread and the need for bipolar stimulation. In summary, at this early stage of clinical validation, replacing ECS with the SIGFRIED/BCI2000 system is not warranted. Nevertheless, despite its potential limitations, there may already be distinct advantages over ECS mapping. The ECS protocol labels each contact with the eloquent function that is elicited or inhibited as the contact is stimulated. Finding eloquent function at a low threshold terminates the protocol for this contact, assuming that each type eloquent function is spatially contiguous as it is suggested by the motor homunculus model [ 39 ]. Recent fMRI [ 40 ] and ECS [ 10 ] studies, however, show a more complex and spatially noncontiguous somatotopy. The SIGFRIED mapping could establish a comparable somatotopy by exploring different tasks, for example a dedicated motor/sensory evaluation for each finger. This could allow more detailed surgical planning and thus benefit the outcome of the resection procedure. However, the lack of a verifiable gold standard makes it difficult to assess the quality of such a more detailed somatotopy. Only surgical outcome can provide a detailed assessment on whether a more detailed somatotopy may be beneficial. Studies have shown task-related changes associated with ipsilateral movements in the low frequency band [ 41 , 42 , 43 , 44 , 45 , 46 , 47 , 48 ]. The implications of resecting cortical areas associated with these ipsilateral movements have not been defined, mainly because ECS is not able to elicit ipsilateral limb movement within the conventional stimulation thresholds [ 49 , 50 ]. The SIGFRIED mapping could facilitate such studies by exploring ipsilateral tasks. An initial application of the SIGFRIED/BCI2000 system is shown here, but there are several ways in which this system can be further improved. As a first example of the potential for improvement, we observed a noticeable delay between stimulus onset and the patient's response even when there was good compliance of the subiect. Crone et al. also reported such delays, and estimated them to be in the 300-400 ms range for simple visually cued hand movements and tongue protrusions [ 14 ]. Our results show similar delays (see Fig. 4 ). Because the total duration of each stimulus was only 3 sec (15 sec for subject UMC1), a significant fraction of the signals were thus effectively assigned to the incorrect task category. In more recent experiments, we have begun to alert the subject to the change in condition by presenting an auditory stimulus, and we suspend data analysis for 1 sec. In the end, it may be possible to partially or even completely eliminate this need for patient compliance, which is currently an issue for all mapping techniques. For example, for motor tasks it would be relatively straightforward to utilize motion sensors, such as a data glove, motion capture device, or EMG electrodes, and to simply correlate SIGFRIED values with the detected motion rather than with the stimulus. For sensory input, it would be possible to use programmable tactile stimulators and earphones. Thus, such approaches may fully remove the requirement for patient compliance and facilitate mapping in pediatric environments where patient compliance is either impossible (e.g., with infants) or hard to obtain (e.g., with young children). As another example for potential further improvements, it may be possible to use the SIGFRIED mapping intraoperatively. This possibility could replace the two surgeries that are currently necessary with one surgery that encompasses grid placement, mapping of eloquent cortex, and resection. In particular in patients that do not require longer monitoring periods (e.g., tumor patients), this would significantly decrease risks to the patient and costs of the hospitalization. In conclusion, in this paper we presented the SIGFRIED/BCI2000 system as a practical functional mapping procedure. This system is readily available at no cost for research and educational purposes at www.bci2000.org , and there is substantial documentation on its theory [ 29 , 30 , 31 , 32 ] and use (doc.bci2000.org). BCI2000 currently supports signal acquisition from 15 different devices, and more are continually added. This should facilitate the integration in existing clinical environments.  Supplementary Material Supplementary Video 1 Real-time SIGFRIED/BCI2000 mapping of motor and auditory cortex in two subjects. These videos show the display to the operator during system operation (large portion of the screen), as well as a video of the subject (inset on the bottom right). The small window to the left of the inset shows a copy of the subject display, which contains the visual cues to the subject. Raw ECoG traces are shown on the bottom left. The three displays on the top right show the results of the SIGFRIED mapping for three tasks (solving Rubik's cube (hand motor), sticking out tongue (tongue motor), and listening (auditory cortex)). Each of these three displays contains circles at the electrode locations. These subject have one electrode grid placed over the frontal lobe, and one grid placed over the temporal lobe. The grids were placed on the right hemisphere ( Video 1 ) or left hemisphere ( Video 2 ). As the subject performs the task, SIGFRIED detects task-related ECoG changes without any required parameterization by the operator. The magnitude of these changes is proportional to the diameter of the circle at each location. The system rapidly identifies hand and tongue motor cortex, as well as auditory cortex. This mapping is stable for the several minutes of the experimental run. Supplementary Video 2  Supplementary Material Supplementary Video 1 Real-time SIGFRIED/BCI2000 mapping of motor and auditory cortex in two subjects. These videos show the display to the operator during system operation (large portion of the screen), as well as a video of the subject (inset on the bottom right). The small window to the left of the inset shows a copy of the subject display, which contains the visual cues to the subject. Raw ECoG traces are shown on the bottom left. The three displays on the top right show the results of the SIGFRIED mapping for three tasks (solving Rubik's cube (hand motor), sticking out tongue (tongue motor), and listening (auditory cortex)). Each of these three displays contains circles at the electrode locations. These subject have one electrode grid placed over the frontal lobe, and one grid placed over the temporal lobe. The grids were placed on the right hemisphere ( Video 1 ) or left hemisphere ( Video 2 ). As the subject performs the task, SIGFRIED detects task-related ECoG changes without any required parameterization by the operator. The magnitude of these changes is proportional to the diameter of the circle at each location. The system rapidly identifies hand and tongue motor cortex, as well as auditory cortex. This mapping is stable for the several minutes of the experimental run. Supplementary Video 2  Figures and Tables Figure 1 Example for ECoG signal changes between the tasks of repetitively opening and closing of the hand and resting. (A) Signals in the mu/beta band (5-30 Hz) decrease with the task and are spatially less specific (lower topography), whereas signals in the gamma band (70-116 Hz) increase with the task and are spatially more specific (upper topography). (B) The power spectrum on a logarithmic scale for the electrode market with a star in the topographies illustrates the spectral decrease in the mu/beta band (marked by the green bar) and spectral increase in the gamma band (orange bar). Figure 2 Example of an implanted subdural grid in patient AMC3. (A) Subdural grid placed over fronto-parietal areas. (B) Lateral radiograph indicating the position of the grid. Figure 3 SIGFRIED-based mapping procedure: After an initial 6 min baseline period, an automated routine generates a statistical signal model for that baseline period for each electrode (this automated procedure takes less than one min). The subject then alternated between hand and tongue movement tasks interspersed with rest periods. Figure 4 Output of the SIGFRIED procedure for two locations recorded from subject VAH2. Locations for hand (top) and tongue (bottom) electrode are each marked in Fig. 7 by a star and rectangle, respectively. Figure 5 Equipment setup and interface to the investigator. The subject is presented with visual cues shown on a computer monitor while electrocorticographic signals are recorded. Both the patient screen and the data acquisition device are interfaced with a laptop computer running BCI2000. BCI2000 acquires signals from the device, submits these signals in real time to the SIGFRIED method, and presents the results visually in a topographical display to the investigator. Figure 6 Results of electrical cortical stimulation (left) and the passive functional mapping using SIGFRIED (right) for subjects AMC1 to AMC5. Lateral radiographs (left) show the results of the electrical cortical stimulation for hand (yellow) and tongue (red) and no response to hand or tongue (white). Transparent circles indicate no stimulation. Detailed lateral radiographs (right) show the result of the passive functional mapping using SIGFRIED after 30, 60, 120 and 180 seconds for hand (yellow) and tongue (red). The number indicates the final maximum r2 between the stimulus and the SIGFRIED response (0 to 1). Figure 7 Results of electrical cortical stimulation (left) and the passive functional mapping using SIGFRIED (right) for subjects VAH1, VAH2, UMC1, UMC2 and BJH1. Lateral radiographs or computer tomographic renderings (left) show the results of the electrical cortical stimulation for hand (yellow) and tongue (red) and no response to hand or tongue (white). Transparent circles indicate no stimulation. Detailed lateral radiographs (right) show the result of the passive functional mapping using SIGFRIED after 30, 60, 120 and 180 seconds for hand (yellow) and tongue (red). The number indicates the final maximum r2 between the stimulus and the SIGFRIED response (0 to 1). The real-time SIGFRIED traces in Fig.4 are for the locations marked by a yellow star and red rectangle in subject VAH2, respectively. Table 1 Comparison of the properties of ECS mapping and ECoG-based mapping. Electrical Cortical Stimulation ECoG-Based Passive Mapping time consuming Yes No risk of seizure induction Yes No difficulty in observing inhib. resp. Yes No necessity for anti-epileptic drugs Yes No variable prop. of stim. current Yes No procedural variability Yes No non-physiological model Yes No patient compliance necessary Yes currently yes proven by clinical studies Yes not yet Table 2 Patient characteristics Subject Age Handedness Gender Hemispheric dominance for language (IPA) Full scale IQ Surgery hemisphere Simulation duration Fraction of electrodes stimulated AMC1 19 right male N/A a N/A b left 5 hours 100% (48/48) AMC2 61 right female left 95 left 5 hours 71% (52/77) AMC3 32 right female left 99 right 4 hours 40% (24/48) AMC4 29 right male left 94 right 3 hours 100% (84/84) AMC5 50 right male bilateral 109 right 2 hours 43% (36/83) VAH1 62 right male left N/A c right 1.5 hours 70% (45/64) VAH2 36 right male left N/A d right 2.5 hours 26% (26/128) UMC1 28 right male left 92 left 4.5 hours 93% (112/120) UMC2 27 right female left 69 left 7.5 hours 69% (72/112) BJH1 44 left female bilateral 95 left 1.5 hours 88% (56/64) Note: a IPA was not administered. b IQ was not tested; patient completed 12 years of education. c IQ was not tested; information about education not available. d IQ was not tested; patient completed 13 years of education. Table 3 Signal Recording Properties Subject Channels Sampling Filter Update Rate AMC1 32 256 Hz 0.1 Hz 32 Hz AMC2 32 256 Hz 0.1 Hz 32 Hz AMC3 32 1200 Hz 0.1 Hz 30 Hz AMC4 32 1200 Hz 0.1 Hz 30 Hz AMC5 64 1200 Hz 0.01 Hz 15 Hz VAH1 32 1061 Hz 3-512 Hz 35 Hz VAH2 64 1061 Hz 3-512 Hz 35 Hz UMC1 128 512 Hz 0.15-134.4 Hz 16 Hz UMC1 128 512 Hz 0.15-134.4 Hz 16 Hz BJH1 64 1200 Hz 0.1 Hz 30 Hz Table 4 Highest squared correlation (r2) between the task and the SIGFRIED output and Minimum Bayesian Error between the results of the electrical cortical stimulation and the SIGFRIED mapping. HAND TONGUE subject r2 false positive false negative r2 false positive false negative AMC1 0.40 0.00% 0.00% 0.51 12.50% 0.00% AMC2 0.21 4.17% 4.17% 0.49 12.50% 12.50% AMC3 N/A a N/A a N/A a 0.37 16.67% 11.11% AMC4 0.38 0.00% 0.00% 0.46 4.00% 12.00% AMC5 0.15 0.00% 0.00% 0.10 0.00% 3.70% VAH1 0.07 10.35% 0.00% 0.14 10.35% 0.00% VAH2 0.61 3.57% 0.00% 0.37 3.57% 0.00% UMC1 0.18 3.33% 1.67% 0.11 10.00% 1.67% UMC2 0.25 3.75% 2.50% 0.48 10.00% 1.25% BJH1 0.30 3.57% 1.79% 0.31 10.71% 0.00% average 0.26 3.19% 1.12% 0.33 9.03% 4.22% Note: a The electrical cortical stimulation resulted in no hand hits for subject AMC3. Table 5 Highest squared correlation (r2) between the task and the SIGFRIED output and Minimum Bayesian Error between the results of the electrical cortical stimulation and the SIGFRIED mapping in a next-neighbor comparison. HAND TONGUE subject r2 false positive false negative r2 false positive false negative AMC1 0.40 0.00% 0.00% 0.51 0.00% 0.00% AMC2 0.21 4.17% 0.00% 0.49 4.17% 0.00% AMC3 N/A a N/A a N/A a 0.37 5.56% 0.00% AMC4 0.38 0.00% 0.00% 0.46 0.00% 0.00% AMC5 0.15 0.00% 0.00% 0.10 0.00% 0.00% VAH1 0.07 0.00% 0.00% 0.14 0.00% 0.00% VAH2 0.61 0.00% 0.00% 0.37 0.00% 0.00% UMC1 0.18 0.00% 0.00% 0.11 0.00% 0.00% UMC2 0.25 0.00% 0.00% 0.48 1.25% 0.00% BJH1 0.30 0.00% 0.00% 0.31 0.00% 0.00% average 0.26 0.46% 0.00% 0.33 1.10% 0.00% Note: a The electrical cortical stimulation resulted in no hand hits for subject AMC3.  Figures and Tables Figure 1 Example for ECoG signal changes between the tasks of repetitively opening and closing of the hand and resting. (A) Signals in the mu/beta band (5-30 Hz) decrease with the task and are spatially less specific (lower topography), whereas signals in the gamma band (70-116 Hz) increase with the task and are spatially more specific (upper topography). (B) The power spectrum on a logarithmic scale for the electrode market with a star in the topographies illustrates the spectral decrease in the mu/beta band (marked by the green bar) and spectral increase in the gamma band (orange bar). Figure 2 Example of an implanted subdural grid in patient AMC3. (A) Subdural grid placed over fronto-parietal areas. (B) Lateral radiograph indicating the position of the grid. Figure 3 SIGFRIED-based mapping procedure: After an initial 6 min baseline period, an automated routine generates a statistical signal model for that baseline period for each electrode (this automated procedure takes less than one min). The subject then alternated between hand and tongue movement tasks interspersed with rest periods. Figure 4 Output of the SIGFRIED procedure for two locations recorded from subject VAH2. Locations for hand (top) and tongue (bottom) electrode are each marked in Fig. 7 by a star and rectangle, respectively. Figure 5 Equipment setup and interface to the investigator. The subject is presented with visual cues shown on a computer monitor while electrocorticographic signals are recorded. Both the patient screen and the data acquisition device are interfaced with a laptop computer running BCI2000. BCI2000 acquires signals from the device, submits these signals in real time to the SIGFRIED method, and presents the results visually in a topographical display to the investigator. Figure 6 Results of electrical cortical stimulation (left) and the passive functional mapping using SIGFRIED (right) for subjects AMC1 to AMC5. Lateral radiographs (left) show the results of the electrical cortical stimulation for hand (yellow) and tongue (red) and no response to hand or tongue (white). Transparent circles indicate no stimulation. Detailed lateral radiographs (right) show the result of the passive functional mapping using SIGFRIED after 30, 60, 120 and 180 seconds for hand (yellow) and tongue (red). The number indicates the final maximum r2 between the stimulus and the SIGFRIED response (0 to 1). Figure 7 Results of electrical cortical stimulation (left) and the passive functional mapping using SIGFRIED (right) for subjects VAH1, VAH2, UMC1, UMC2 and BJH1. Lateral radiographs or computer tomographic renderings (left) show the results of the electrical cortical stimulation for hand (yellow) and tongue (red) and no response to hand or tongue (white). Transparent circles indicate no stimulation. Detailed lateral radiographs (right) show the result of the passive functional mapping using SIGFRIED after 30, 60, 120 and 180 seconds for hand (yellow) and tongue (red). The number indicates the final maximum r2 between the stimulus and the SIGFRIED response (0 to 1). The real-time SIGFRIED traces in Fig.4 are for the locations marked by a yellow star and red rectangle in subject VAH2, respectively. Table 1 Comparison of the properties of ECS mapping and ECoG-based mapping. Electrical Cortical Stimulation ECoG-Based Passive Mapping time consuming Yes No risk of seizure induction Yes No difficulty in observing inhib. resp. Yes No necessity for anti-epileptic drugs Yes No variable prop. of stim. current Yes No procedural variability Yes No non-physiological model Yes No patient compliance necessary Yes currently yes proven by clinical studies Yes not yet Table 2 Patient characteristics Subject Age Handedness Gender Hemispheric dominance for language (IPA) Full scale IQ Surgery hemisphere Simulation duration Fraction of electrodes stimulated AMC1 19 right male N/A a N/A b left 5 hours 100% (48/48) AMC2 61 right female left 95 left 5 hours 71% (52/77) AMC3 32 right female left 99 right 4 hours 40% (24/48) AMC4 29 right male left 94 right 3 hours 100% (84/84) AMC5 50 right male bilateral 109 right 2 hours 43% (36/83) VAH1 62 right male left N/A c right 1.5 hours 70% (45/64) VAH2 36 right male left N/A d right 2.5 hours 26% (26/128) UMC1 28 right male left 92 left 4.5 hours 93% (112/120) UMC2 27 right female left 69 left 7.5 hours 69% (72/112) BJH1 44 left female bilateral 95 left 1.5 hours 88% (56/64) Note: a IPA was not administered. b IQ was not tested; patient completed 12 years of education. c IQ was not tested; information about education not available. d IQ was not tested; patient completed 13 years of education. Table 3 Signal Recording Properties Subject Channels Sampling Filter Update Rate AMC1 32 256 Hz 0.1 Hz 32 Hz AMC2 32 256 Hz 0.1 Hz 32 Hz AMC3 32 1200 Hz 0.1 Hz 30 Hz AMC4 32 1200 Hz 0.1 Hz 30 Hz AMC5 64 1200 Hz 0.01 Hz 15 Hz VAH1 32 1061 Hz 3-512 Hz 35 Hz VAH2 64 1061 Hz 3-512 Hz 35 Hz UMC1 128 512 Hz 0.15-134.4 Hz 16 Hz UMC1 128 512 Hz 0.15-134.4 Hz 16 Hz BJH1 64 1200 Hz 0.1 Hz 30 Hz Table 4 Highest squared correlation (r2) between the task and the SIGFRIED output and Minimum Bayesian Error between the results of the electrical cortical stimulation and the SIGFRIED mapping. HAND TONGUE subject r2 false positive false negative r2 false positive false negative AMC1 0.40 0.00% 0.00% 0.51 12.50% 0.00% AMC2 0.21 4.17% 4.17% 0.49 12.50% 12.50% AMC3 N/A a N/A a N/A a 0.37 16.67% 11.11% AMC4 0.38 0.00% 0.00% 0.46 4.00% 12.00% AMC5 0.15 0.00% 0.00% 0.10 0.00% 3.70% VAH1 0.07 10.35% 0.00% 0.14 10.35% 0.00% VAH2 0.61 3.57% 0.00% 0.37 3.57% 0.00% UMC1 0.18 3.33% 1.67% 0.11 10.00% 1.67% UMC2 0.25 3.75% 2.50% 0.48 10.00% 1.25% BJH1 0.30 3.57% 1.79% 0.31 10.71% 0.00% average 0.26 3.19% 1.12% 0.33 9.03% 4.22% Note: a The electrical cortical stimulation resulted in no hand hits for subject AMC3. Table 5 Highest squared correlation (r2) between the task and the SIGFRIED output and Minimum Bayesian Error between the results of the electrical cortical stimulation and the SIGFRIED mapping in a next-neighbor comparison. HAND TONGUE subject r2 false positive false negative r2 false positive false negative AMC1 0.40 0.00% 0.00% 0.51 0.00% 0.00% AMC2 0.21 4.17% 0.00% 0.49 4.17% 0.00% AMC3 N/A a N/A a N/A a 0.37 5.56% 0.00% AMC4 0.38 0.00% 0.00% 0.46 0.00% 0.00% AMC5 0.15 0.00% 0.00% 0.10 0.00% 0.00% VAH1 0.07 0.00% 0.00% 0.14 0.00% 0.00% VAH2 0.61 0.00% 0.00% 0.37 0.00% 0.00% UMC1 0.18 0.00% 0.00% 0.11 0.00% 0.00% UMC2 0.25 0.00% 0.00% 0.48 1.25% 0.00% BJH1 0.30 0.00% 0.00% 0.31 0.00% 0.00% average 0.26 0.46% 0.00% 0.33 1.10% 0.00% Note: a The electrical cortical stimulation resulted in no hand hits for subject AMC3. 