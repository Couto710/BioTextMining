Dynamic Granger-Geweke causality modeling with application to interictal spike propagation A persistent problem in developing plausible neurophysiological models of perception, cognition, and action is the difficulty of characterizing the interactions between different neural systems. Previous studies have approached this problem by estimating causal influences across brain areas activated during cognitive processing using Structural Equation Modeling and, more recently, with Granger-Geweke causality. While SEM is complicated by the need for a priori directional connectivity information, the temporal resolution of dynamic Granger-Geweke estimates is limited because the underlying autoregressive (AR) models assume stationarity over the period of analysis. We have developed a novel optimal method for obtaining data-driven directional causality estimates with high temporal resolution in both time and frequency domains. This is achieved by simultaneously optimizing the length of the analysis window and the chosen AR model order using the SURE criterion. Dynamic Granger-Geweke causality in time and frequency domains is subsequently calculated within a moving analysis window. We tested our algorithm by calculating the Granger-Geweke causality of epileptic spike propagation from the right frontal lobe to the left frontal lobe. The results quantitatively suggested the epileptic activity at the left frontal lobe was propagated from the right frontal lobe, in agreement with the clinical diagnosis. Our novel computational tool can be used to help elucidate complex directional interactions in the human brain.  INTRODUCTION Modeling the synchronization of activity between different brain areas using approaches such as the phase-locking value (PLV) analysis ( Lachaux, et al. 1999 ; Lin, et al. 2004 ) can only identify cortical areas acting in concert, without inferring any causal relationships between them. To reveal the causal influence among “nodes” in a network of brain regions requires a measure of effective connectivity . Previously, structural equation modeling (SEM) has been used to reveal the strength of the directional modulation of neural ensembles using covariance or correlation matrices derived from time series measurements ( McArdle and McDonald 1984 ). A major limitation of SEM is that it requires strong a priori assumptions on the number of directional connections and their respective directionality, which are difficult to justify or validate, particularly in non-invasive human neuroimaging studies. Recently, Granger-Geweke causality has been proposed for effective connectivity analysis ( Astolfi, et al. 2004 ; Brovelli, et al. 2004 ; Eichler 2005 ; Goebel, et al. 2003 ; Granger 1969 ; Kus, et al. 2004 ). Granger-Geweke causality can estimate the directionality of modulation from recorded time series across all nodes of a network without a priori assumptions. Essentially, Granger-Geweke causality is based on the test of improvement of prediction by additional information. Granger-Geweke causality infers directional influence between two cortical areas based on time series analysis ( Granger 1969 ). Qualitatively, we infer the existence of Granger-Geweke causality from “X” to “Y” if the combined information from pasts of both “X” and “Y” can significantly improve the prediction of the future of the time series “Y” rather than using the information from the past of “Y” alone. Granger-Geweke causality has both time-domain and frequency domain formulations ( Brovelli, et al. 2004 ; Geweke 1982 ). Granger-Geweke causality is closely related to Partial Directed Coherence (PDC) ( Sameshima and Baccala 1999 ) and Directed Transfer Function (DTF) ( Kaminski and Blinowska 1991 ) measures, which are frequency domain characterizations of causality and are normalized to different inputs and output ( Kus, et al. 2004 ). The application of Granger-Geweke causality to human neuroimaging data has been reported for fMRI ( Abler, et al. 2006 ; Goebel, et al. 2003 ; Londei, et al. 2006 ; Roebroeck, et al. 2005 ; Sato, et al. 2006 ), EEG ( Blinowska, et al. 2004 ; Chavez, et al. 2003 ; Hesse, et al. 2003 ; Kaminski, et al. 2001 ; Kus, et al. 2004 ; Valdes-Sosa 2004 ), and MEG ( Gow, et al. 2008 ; Kujala, et al. 2007 ) experiments. Causality was usually estimated using multivariate autoregressive modeling of the time series ( Astolfi, et al. 2008 ; Astolfi, et al. 2004 ; Kujala, et al. 2007 ). Dynamic causality was previously studied on scalp EEG ( Hesse, et al. 2003 ). However, time-varying Granger-Geweke causality analysis applied to MEG or EEG source estimates in both time and frequency domains has never been reported. The more general definition of nonlinear causality provided by Granger ( Granger 1980 ) supports the linear time-varying Granger-Geweke causality implicitly used here. In this paper, we will use both time- and frequency-domain Granger-Geweke causality, coupled with a time windowing, to obtain dynamic characterization of causal interaction estimates among cortical areas. As an example, we apply this dynamic causality modeling to study the propagation of epileptic interictal spikes. Based on Granger-Geweke causality, we can quantitatively differentiate synchronous versus propagated spikes. This will be particular significant to the surgical planning in extratemporal epilepsy due to the rapid propagation of epileptic activity ( Niedermeyer and Lopes da Silva 2004 ). Therefore, surgical removal of only primary epileptogenic focus can significantly minimize surgical complications. The results reported here also validated the feasibility to apply dynamic Granger-Geweke causality modeling to MEG and EEG source analysis.  METHODS Granger-Geweke causality Granger-Geweke causality was first proposed in the context of econometrics to investigate causal (or directional) influence from one time series to another ( Granger 1969 ). Qualitatively, we infer the existence of Granger-Geweke causality from “X” to “Y” if combined information from both “X” and “Y” can significantly improve the prediction of the time series “Y” rather than using the information from “Y” alone. In practice, it is common to employ an auto-regressive (AR) model to implement the Granger-Geweke causality modeling. Consider a zero-mean time series at the “destination node”, y ( t ). The p th-order AR model description of y ( t ) is: [1] y ( t ) = ? k = 1 p a k y ( t ? k ) + ? y ( t ) , t = 1 ? n , where a k are AR model coefficients, and ? y ( t ) is the residual time series of AR model fitting at the destination node. n is the total number of samples in the time series. Provided with the time series from a “source node”, x ( t ), we can model the bivariate time series of x ( t ) and y ( t ) as: [2] [ y ( t ) , x ( t ) ] T = ? k = 1 p A k [ y ( t ? k ) , x ( t ? k ) ] T + [ ? y , x ( t ) , ? x , x ( t ) ] T , t = 1 ? n where A k , k = 1 ··· p are the AR model coefficient matrices, and [ ? y, x ( t ), ? x, x ( t )] T is the joint bivariate residual time series of AR model fitting at the destination node and source node. The Granger-Geweke causality metric is ( Neumaier and Schneider 2001 ; Schneider and Neumaier 2001 ): [3] G x ? y = log ( ? t = 1 n ? y 2 ( t ) / ? t = 1 n ? y , x 2 ( t ) ) . Since the bivariate time series [ y ( t ), x ( t )] T contains the information of univariate time series y ( t ), from Cauchy inequality we can conclude that G x ? y is well defined and positive since the quotient inside the logarithm is greater or equal to one. In our approach, we extract time series from regions-of-interest (ROIs) after MEG/EEG source estimation. For each pair of time series from two ROIs (“X” and “Y”), we respectively calculate the Granger-Geweke causality G x ? y and G y ? x . We will use the SURE criterion (see below) to estimate the order of the AR model and stepwise least squares to estimate model parameters ( Brovelli, et al. 2004 ; Geweke 1982 ). Let [4] F x ? y = n ? 2 p p ( exp ( G x ? y ) ? 1 ) . Under the null hypothesis, F x ? y asymptotically follows the F -distribution with ( p ) and ( n ? 2p ) degrees of freedom, where n denotes the length of the time series and p denotes the order of AR Model ( Gourevitch, et al. 2006 ). Granger-Geweke causality also has frequency domain representation ( Brovelli, et al. 2004 ; Geweke 1982 ): [5] G x ? y ( f ) = ? ln ( 1 ? ( ? x x ? ? x y 2 / ? y y ) | H y x ( f ) | 2 S y y ( f ) ) , where x and y subscripts denotes the entries in the matrix. S ( f ) is the spectral matrix: [6] S ( f ) = H ( f ) ? H H ( f ) , and H ( f ) is the transfer function of the system. [7] H ( f ) = ( ? k = 0 p A k exp ( j 2 ? k f ) ) ? 1 A k is the coefficient matrix, and ? is the noise covariance matrix of [ ? y, x ( t ), ? x, x ( t )] T in the AR model. The statistical inference of frequency domain Granger-Geweke causality can be derived with help of the statistic [8] F x ? y ( f ) = n ? 2 p p ( exp ( G x ? y ( f ) ) ) , analogous to Eq. [4] . Under the null hypothesis of no causal relationship from X to Y, F x ? y ( f ) asymptotically follows the F distribution with degrees of freedom ( p , n ? 2p ) ( Brovelli, et al. 2004 ; Gourevitch, et al. 2006 ). Dynamic Granger-Geweke causality We will use a time-window approach to obtain dynamic Granger-Geweke causality estimates in both the time and frequency domains. From the above equations, it is clear that Granger-Geweke causality depends on the estimated optimal order of the AR model. Thus, dynamic Granger-Geweke causality requires estimates of both the AR model order and the window length. which we propose to obtain with help of the SURE criterion ( Long, et al. 2005 ; Solo, et al. 2001 ). The derivation of the SURE criterion starts from formulating the time series as a dynamic AR model. Without loss of generality, we will use a univariate time series as an example: [9] y ( t ) = ? k = 1 p ? k w ( t ) y ( t ? k ) + ? y w ( t ) , t = 1 ? n , where ? k w ( t ) is the estimated time-varying AR model, w is the length of the temporal window, and p denotes the order of the AR model. The residual variance of this dynamic AR model fitting can thus be estimated: [10] ? p , w 2 = 1 n ? ( ? k = 1 p ? k w ( t ) y ( t ? k ) ? y ( t ) ) 2 . For this case the SURE criterion reads ( Long, et al. 2005 ; Solo, et al. 2001 ) [11] SURE ( p , w ) = log ( ? p , w 2 ) + 2 p ? w , where ? is a modification term: [12a] ? = ( ? t = 1 n y t , p T M ? 1 ( t ) y t , p ) / n [12b] M ( t ) = ( ? q = 0 w ? 1 y t ? q , p y t ? q , p T ) / w [12c] y t ? q , p = [ y ( t ? q ? 1 ) , y ( t ? q ? 2 ) , ? , y ( t ? q ? p ) ] T . The window length with corresponding minimal SURE value will be considered to be optimal. Interictal MEG data from an epileptic patient Subject The patient was an eleven-year-old girl with refractory complex partial seizures (CPS) since the age of four. The medical history, clinical manifestations, and MEG/EEG diagnosis of this patient was previously reported showing spike propagation from right frontal lobe to the left frontal lobe ( Hara, et al. 2007 ). Data acquisition and analysis MEG was measured with a 306-channel whole-head system (Elekta Neuromag Oy, Helsinki, Finland) with a passband of 0.01 – 270 Hz and a sampling rate of 600 Hz. Co-registration between MEG and the MRI was performed using anatomical fiduciary and head surface points and a high-resolution 3T MRI (Trio, Siemens Medical Solutions, Erlangen, Germany) with a MPRAGE sequence (TI/TR/TE = 2530/3.45/1100 ms, 1.3 mm thickness). The MRI data were used for 1) the forward model required for the subsequent MEG source analysis based on the Boundary Element Model ( Hamalainen and Sarvas 1989 ), and 2) overlaying MEG source analysis results on inflated cortical surfaces ( Dale 1999 ; Fischl, et al. 1999 ). A total of 24 spikes (seven right frontal spikes and 17 left frontal spikes) were recorded and separated into left and right frontal spikes. 17 of them are left frontal spikes and 7 of them are right frontal spikes. Only 3 out of 7 recorded right frontal spikes showed clear propagation to the left frontal lobe with a 15 to 30 ms peak-to-peak latency ( Hara, et al. 2007 ). Epileptic spikes within each frontal lobe were then temporally aligned and averaged. We chose the peak time of the left averaged spike as 0 ms and the same time origin was applied to the right averaged spike. The source analysis of averaged left spike (from 17 raw spikes) was done separately by calculating the dynamic statistical parametric mapping (dSPM) ( Dale, et al. 2000 ), which is a noise-normalized minimum ?2 -norm source estimate localizing statistically significant neuronal activity. Based on our clinical experience and comparison with the Equivalent Current Dipole (ECD) modeling results, a critical threshold of 10?6 (uncorrected) was chosen on the dSPM to define the region-of-interest (ROIs) and to localize the epileptic activity. Time courses were extracted from all sources within the left and right frontal lobe ROIs respectively. We also calculated the time-frequency representation of the time courses using the continuous wavelet transform (Morlet wavelet) to reveal the the distribution of the energy in the time-frequency plane ( Lin, et al. 2004 ). To simultaneously estimate the optimal temporal window length and the order of the auto-regressive (AR) model, we calculated the SURE values with the AR model orders varying between 1 and 7 using the ARFIT algorithm ( Schneider and Neumaier 2001 ) and the window length varying between 60 ms and 150 ms. The SURE values for the time course averaged across sources locations within the left and the right frontal lobes were calculated separately. We chose the window length and the order of the AR model for dynamic time-domain and frequency domain Granger-Geweke causality by choosing those giving the minimal SURE value in the left and right frontal lobe time series. As discussed above, the SURE value was first calculated using the average time course within each ROI. Subsequently, dynamic time-domain Granger-Geweke causality was calculated between all left frontal lobe/right frontal lobe source pairs using the same the optimal window length ( w ) and AR model order ( p ) suggested by the SURE criterion. Using all pairwise causality data, we estimated the average and standard deviation of the Granger-Geweke causality. Similarly, using all pairwise time series from both ROIs, dynamic frequency-domain Granger-Geweke causality between 5 Hz and 40 Hz was also calculated to give the average and the standard deviation in each spectrotemporal grid. This frequency range was selected based on the time-frequency representation of the time courses as well as previous studies of cortical oscillatory interactions in beta and gamma frequency bands ( Kopell, et al. 2000 ). We only show statistically significant Granger-Geweke causality with p value of 1% or less.  Granger-Geweke causality Granger-Geweke causality was first proposed in the context of econometrics to investigate causal (or directional) influence from one time series to another ( Granger 1969 ). Qualitatively, we infer the existence of Granger-Geweke causality from “X” to “Y” if combined information from both “X” and “Y” can significantly improve the prediction of the time series “Y” rather than using the information from “Y” alone. In practice, it is common to employ an auto-regressive (AR) model to implement the Granger-Geweke causality modeling. Consider a zero-mean time series at the “destination node”, y ( t ). The p th-order AR model description of y ( t ) is: [1] y ( t ) = ? k = 1 p a k y ( t ? k ) + ? y ( t ) , t = 1 ? n , where a k are AR model coefficients, and ? y ( t ) is the residual time series of AR model fitting at the destination node. n is the total number of samples in the time series. Provided with the time series from a “source node”, x ( t ), we can model the bivariate time series of x ( t ) and y ( t ) as: [2] [ y ( t ) , x ( t ) ] T = ? k = 1 p A k [ y ( t ? k ) , x ( t ? k ) ] T + [ ? y , x ( t ) , ? x , x ( t ) ] T , t = 1 ? n where A k , k = 1 ··· p are the AR model coefficient matrices, and [ ? y, x ( t ), ? x, x ( t )] T is the joint bivariate residual time series of AR model fitting at the destination node and source node. The Granger-Geweke causality metric is ( Neumaier and Schneider 2001 ; Schneider and Neumaier 2001 ): [3] G x ? y = log ( ? t = 1 n ? y 2 ( t ) / ? t = 1 n ? y , x 2 ( t ) ) . Since the bivariate time series [ y ( t ), x ( t )] T contains the information of univariate time series y ( t ), from Cauchy inequality we can conclude that G x ? y is well defined and positive since the quotient inside the logarithm is greater or equal to one. In our approach, we extract time series from regions-of-interest (ROIs) after MEG/EEG source estimation. For each pair of time series from two ROIs (“X” and “Y”), we respectively calculate the Granger-Geweke causality G x ? y and G y ? x . We will use the SURE criterion (see below) to estimate the order of the AR model and stepwise least squares to estimate model parameters ( Brovelli, et al. 2004 ; Geweke 1982 ). Let [4] F x ? y = n ? 2 p p ( exp ( G x ? y ) ? 1 ) . Under the null hypothesis, F x ? y asymptotically follows the F -distribution with ( p ) and ( n ? 2p ) degrees of freedom, where n denotes the length of the time series and p denotes the order of AR Model ( Gourevitch, et al. 2006 ). Granger-Geweke causality also has frequency domain representation ( Brovelli, et al. 2004 ; Geweke 1982 ): [5] G x ? y ( f ) = ? ln ( 1 ? ( ? x x ? ? x y 2 / ? y y ) | H y x ( f ) | 2 S y y ( f ) ) , where x and y subscripts denotes the entries in the matrix. S ( f ) is the spectral matrix: [6] S ( f ) = H ( f ) ? H H ( f ) , and H ( f ) is the transfer function of the system. [7] H ( f ) = ( ? k = 0 p A k exp ( j 2 ? k f ) ) ? 1 A k is the coefficient matrix, and ? is the noise covariance matrix of [ ? y, x ( t ), ? x, x ( t )] T in the AR model. The statistical inference of frequency domain Granger-Geweke causality can be derived with help of the statistic [8] F x ? y ( f ) = n ? 2 p p ( exp ( G x ? y ( f ) ) ) , analogous to Eq. [4] . Under the null hypothesis of no causal relationship from X to Y, F x ? y ( f ) asymptotically follows the F distribution with degrees of freedom ( p , n ? 2p ) ( Brovelli, et al. 2004 ; Gourevitch, et al. 2006 ).  Dynamic Granger-Geweke causality We will use a time-window approach to obtain dynamic Granger-Geweke causality estimates in both the time and frequency domains. From the above equations, it is clear that Granger-Geweke causality depends on the estimated optimal order of the AR model. Thus, dynamic Granger-Geweke causality requires estimates of both the AR model order and the window length. which we propose to obtain with help of the SURE criterion ( Long, et al. 2005 ; Solo, et al. 2001 ). The derivation of the SURE criterion starts from formulating the time series as a dynamic AR model. Without loss of generality, we will use a univariate time series as an example: [9] y ( t ) = ? k = 1 p ? k w ( t ) y ( t ? k ) + ? y w ( t ) , t = 1 ? n , where ? k w ( t ) is the estimated time-varying AR model, w is the length of the temporal window, and p denotes the order of the AR model. The residual variance of this dynamic AR model fitting can thus be estimated: [10] ? p , w 2 = 1 n ? ( ? k = 1 p ? k w ( t ) y ( t ? k ) ? y ( t ) ) 2 . For this case the SURE criterion reads ( Long, et al. 2005 ; Solo, et al. 2001 ) [11] SURE ( p , w ) = log ( ? p , w 2 ) + 2 p ? w , where ? is a modification term: [12a] ? = ( ? t = 1 n y t , p T M ? 1 ( t ) y t , p ) / n [12b] M ( t ) = ( ? q = 0 w ? 1 y t ? q , p y t ? q , p T ) / w [12c] y t ? q , p = [ y ( t ? q ? 1 ) , y ( t ? q ? 2 ) , ? , y ( t ? q ? p ) ] T . The window length with corresponding minimal SURE value will be considered to be optimal.  Interictal MEG data from an epileptic patient Subject The patient was an eleven-year-old girl with refractory complex partial seizures (CPS) since the age of four. The medical history, clinical manifestations, and MEG/EEG diagnosis of this patient was previously reported showing spike propagation from right frontal lobe to the left frontal lobe ( Hara, et al. 2007 ). Data acquisition and analysis MEG was measured with a 306-channel whole-head system (Elekta Neuromag Oy, Helsinki, Finland) with a passband of 0.01 – 270 Hz and a sampling rate of 600 Hz. Co-registration between MEG and the MRI was performed using anatomical fiduciary and head surface points and a high-resolution 3T MRI (Trio, Siemens Medical Solutions, Erlangen, Germany) with a MPRAGE sequence (TI/TR/TE = 2530/3.45/1100 ms, 1.3 mm thickness). The MRI data were used for 1) the forward model required for the subsequent MEG source analysis based on the Boundary Element Model ( Hamalainen and Sarvas 1989 ), and 2) overlaying MEG source analysis results on inflated cortical surfaces ( Dale 1999 ; Fischl, et al. 1999 ). A total of 24 spikes (seven right frontal spikes and 17 left frontal spikes) were recorded and separated into left and right frontal spikes. 17 of them are left frontal spikes and 7 of them are right frontal spikes. Only 3 out of 7 recorded right frontal spikes showed clear propagation to the left frontal lobe with a 15 to 30 ms peak-to-peak latency ( Hara, et al. 2007 ). Epileptic spikes within each frontal lobe were then temporally aligned and averaged. We chose the peak time of the left averaged spike as 0 ms and the same time origin was applied to the right averaged spike. The source analysis of averaged left spike (from 17 raw spikes) was done separately by calculating the dynamic statistical parametric mapping (dSPM) ( Dale, et al. 2000 ), which is a noise-normalized minimum ?2 -norm source estimate localizing statistically significant neuronal activity. Based on our clinical experience and comparison with the Equivalent Current Dipole (ECD) modeling results, a critical threshold of 10?6 (uncorrected) was chosen on the dSPM to define the region-of-interest (ROIs) and to localize the epileptic activity. Time courses were extracted from all sources within the left and right frontal lobe ROIs respectively. We also calculated the time-frequency representation of the time courses using the continuous wavelet transform (Morlet wavelet) to reveal the the distribution of the energy in the time-frequency plane ( Lin, et al. 2004 ). To simultaneously estimate the optimal temporal window length and the order of the auto-regressive (AR) model, we calculated the SURE values with the AR model orders varying between 1 and 7 using the ARFIT algorithm ( Schneider and Neumaier 2001 ) and the window length varying between 60 ms and 150 ms. The SURE values for the time course averaged across sources locations within the left and the right frontal lobes were calculated separately. We chose the window length and the order of the AR model for dynamic time-domain and frequency domain Granger-Geweke causality by choosing those giving the minimal SURE value in the left and right frontal lobe time series. As discussed above, the SURE value was first calculated using the average time course within each ROI. Subsequently, dynamic time-domain Granger-Geweke causality was calculated between all left frontal lobe/right frontal lobe source pairs using the same the optimal window length ( w ) and AR model order ( p ) suggested by the SURE criterion. Using all pairwise causality data, we estimated the average and standard deviation of the Granger-Geweke causality. Similarly, using all pairwise time series from both ROIs, dynamic frequency-domain Granger-Geweke causality between 5 Hz and 40 Hz was also calculated to give the average and the standard deviation in each spectrotemporal grid. This frequency range was selected based on the time-frequency representation of the time courses as well as previous studies of cortical oscillatory interactions in beta and gamma frequency bands ( Kopell, et al. 2000 ). We only show statistically significant Granger-Geweke causality with p value of 1% or less.  Subject The patient was an eleven-year-old girl with refractory complex partial seizures (CPS) since the age of four. The medical history, clinical manifestations, and MEG/EEG diagnosis of this patient was previously reported showing spike propagation from right frontal lobe to the left frontal lobe ( Hara, et al. 2007 ).  Data acquisition and analysis MEG was measured with a 306-channel whole-head system (Elekta Neuromag Oy, Helsinki, Finland) with a passband of 0.01 – 270 Hz and a sampling rate of 600 Hz. Co-registration between MEG and the MRI was performed using anatomical fiduciary and head surface points and a high-resolution 3T MRI (Trio, Siemens Medical Solutions, Erlangen, Germany) with a MPRAGE sequence (TI/TR/TE = 2530/3.45/1100 ms, 1.3 mm thickness). The MRI data were used for 1) the forward model required for the subsequent MEG source analysis based on the Boundary Element Model ( Hamalainen and Sarvas 1989 ), and 2) overlaying MEG source analysis results on inflated cortical surfaces ( Dale 1999 ; Fischl, et al. 1999 ). A total of 24 spikes (seven right frontal spikes and 17 left frontal spikes) were recorded and separated into left and right frontal spikes. 17 of them are left frontal spikes and 7 of them are right frontal spikes. Only 3 out of 7 recorded right frontal spikes showed clear propagation to the left frontal lobe with a 15 to 30 ms peak-to-peak latency ( Hara, et al. 2007 ). Epileptic spikes within each frontal lobe were then temporally aligned and averaged. We chose the peak time of the left averaged spike as 0 ms and the same time origin was applied to the right averaged spike. The source analysis of averaged left spike (from 17 raw spikes) was done separately by calculating the dynamic statistical parametric mapping (dSPM) ( Dale, et al. 2000 ), which is a noise-normalized minimum ?2 -norm source estimate localizing statistically significant neuronal activity. Based on our clinical experience and comparison with the Equivalent Current Dipole (ECD) modeling results, a critical threshold of 10?6 (uncorrected) was chosen on the dSPM to define the region-of-interest (ROIs) and to localize the epileptic activity. Time courses were extracted from all sources within the left and right frontal lobe ROIs respectively. We also calculated the time-frequency representation of the time courses using the continuous wavelet transform (Morlet wavelet) to reveal the the distribution of the energy in the time-frequency plane ( Lin, et al. 2004 ). To simultaneously estimate the optimal temporal window length and the order of the auto-regressive (AR) model, we calculated the SURE values with the AR model orders varying between 1 and 7 using the ARFIT algorithm ( Schneider and Neumaier 2001 ) and the window length varying between 60 ms and 150 ms. The SURE values for the time course averaged across sources locations within the left and the right frontal lobes were calculated separately. We chose the window length and the order of the AR model for dynamic time-domain and frequency domain Granger-Geweke causality by choosing those giving the minimal SURE value in the left and right frontal lobe time series. As discussed above, the SURE value was first calculated using the average time course within each ROI. Subsequently, dynamic time-domain Granger-Geweke causality was calculated between all left frontal lobe/right frontal lobe source pairs using the same the optimal window length ( w ) and AR model order ( p ) suggested by the SURE criterion. Using all pairwise causality data, we estimated the average and standard deviation of the Granger-Geweke causality. Similarly, using all pairwise time series from both ROIs, dynamic frequency-domain Granger-Geweke causality between 5 Hz and 40 Hz was also calculated to give the average and the standard deviation in each spectrotemporal grid. This frequency range was selected based on the time-frequency representation of the time courses as well as previous studies of cortical oscillatory interactions in beta and gamma frequency bands ( Kopell, et al. 2000 ). We only show statistically significant Granger-Geweke causality with p value of 1% or less.  RESULTS Spike loci at the left and right frontal lobes localized by the dSPM are shown in Figure 1A . With respect to the peak time of the left frontal lobe spike (designated by 0 ms), right frontal lobe showed statistically significant activity 21 ms before the peak time of the left frontal lobe. The time courses of the left and right frontal lobes within the ROI defined by uncorrected p -value less than 10?6 were shown in Figure 1A . Clear separation of the two peaks between left and right frontal lobes was observed. This localization results and the spike propagation diagnosis was further confirmed by a trained epileptologist ( Hara, et al. 2007 ). Two minor activation loci were found in the inferior frontal lobe. These regions are likely artifacts in the source modeling since they are spatially adjacent to each other in the convoluted anatomical space and therefore their MEG lead field is similar. We only included one major source ROI in the left and right frontal lobes respectively to extract time courses for the subsequent causality modeling since they matched to the equivalent current dipole (ECD) fitting in our previous report ( Hara, et al. 2007 ). The average time-frequency representation of the time courses in the right and left frontal ROIs are shown in Figure 1B . Time courses in both ROIs have energy confined to the time range ?50…50 ms and to frequencies below 20 Hz. The SURE values for averaged left and right frontal lobes is shown in Figure 2 . For the left frontal lobe time series, SURE suggested a temporal window of 70 ms and the AR model order of 4. For the right frontal lobe time series, SURE suggested a temporal window of 110 ms and the AR model of order of 6. It is rare to obtain one AR model to optimally model the joint time series in both ROIs as well as the time series in an individual ROI. We chose the temporal window of 70 ms and the AR model order of 4 for the subsequent Granger-Geweke causality calculation because 1) the cost function value is smaller in the left frontal lobe calculation than the right frontal lobe calculation, and 2) we desired a more dynamic (a shorter time window) and a more simple (a lower AR model order) model. The time-domain Granger-Geweke causality estimates are shown in Figure 3 (top panel). The averaged Granger-Geweke causality between the (left frontal to right frontal lobe) and (right frontal to left frontal lobe) was difficult to discern before 30 ms of the peak time of Granger-Geweke causality. However, a clear dissociation ( p -value < 0.01) between these two directional influences was calculated at the peak time of the left frontal lobe spike (0 ms) and it continued for 50 ms. The effect duration likely reflects the chosen temporal window of 70 ms. We also calculated the time-domain Granger-Geweke cauality using the AR model order = 6 and window length of 110 ms, the optimal values for the right frontal ROI ( Figure 3 , bottom panel). The result of unidirectional causal influence from the right frontal lobe to the left frontal lobe is consistent with the that calculated with AR model order = 4 and window length of 70 ms. The top panel of Figure 4 shows the dynamic frequency domain Granger-Geweke causality with values higher than 1.5 ( p -value < 10?4). Between 4 Hz and 22 Hz, from ?150 ms to 200 ms, there was no statistically significant Granger-Geweke causality found from the left frontal lobe to the right frontal lobe. However, we found statistically significant Granger-Geweke causality spectrally concentrated between 4 Hz and 20 Hz and temporally concentrated between ?10 ms and 0 ms. The frequency domain Granger-Geweke causality matched the time domain Granger-Geweke causality showing the right frontal lobe to the left frontal lobe spike propagation. Using a longer time window (110 ms) and a larger AR model order (6), we found that consistent unidirectional causality was found from the right frontal lobe to the left frontal lobe ( Figure 4 , bottom panel). Compared to the results of 70 ms window length and AR model order of 4, higher values in the causality estimates and wider causal interaction in time were likely attributed to the more complicated model (higher order in AR modelling) and a longer time window. Note that the time-frequency range showing strong causal interaction also overlaps with strong energy in the time-frequency representation of the time courses shown in Figure 1B .  RESULTS Spike loci at the left and right frontal lobes localized by the dSPM are shown in Figure 1A . With respect to the peak time of the left frontal lobe spike (designated by 0 ms), right frontal lobe showed statistically significant activity 21 ms before the peak time of the left frontal lobe. The time courses of the left and right frontal lobes within the ROI defined by uncorrected p -value less than 10?6 were shown in Figure 1A . Clear separation of the two peaks between left and right frontal lobes was observed. This localization results and the spike propagation diagnosis was further confirmed by a trained epileptologist ( Hara, et al. 2007 ). Two minor activation loci were found in the inferior frontal lobe. These regions are likely artifacts in the source modeling since they are spatially adjacent to each other in the convoluted anatomical space and therefore their MEG lead field is similar. We only included one major source ROI in the left and right frontal lobes respectively to extract time courses for the subsequent causality modeling since they matched to the equivalent current dipole (ECD) fitting in our previous report ( Hara, et al. 2007 ). The average time-frequency representation of the time courses in the right and left frontal ROIs are shown in Figure 1B . Time courses in both ROIs have energy confined to the time range ?50…50 ms and to frequencies below 20 Hz. The SURE values for averaged left and right frontal lobes is shown in Figure 2 . For the left frontal lobe time series, SURE suggested a temporal window of 70 ms and the AR model order of 4. For the right frontal lobe time series, SURE suggested a temporal window of 110 ms and the AR model of order of 6. It is rare to obtain one AR model to optimally model the joint time series in both ROIs as well as the time series in an individual ROI. We chose the temporal window of 70 ms and the AR model order of 4 for the subsequent Granger-Geweke causality calculation because 1) the cost function value is smaller in the left frontal lobe calculation than the right frontal lobe calculation, and 2) we desired a more dynamic (a shorter time window) and a more simple (a lower AR model order) model. The time-domain Granger-Geweke causality estimates are shown in Figure 3 (top panel). The averaged Granger-Geweke causality between the (left frontal to right frontal lobe) and (right frontal to left frontal lobe) was difficult to discern before 30 ms of the peak time of Granger-Geweke causality. However, a clear dissociation ( p -value < 0.01) between these two directional influences was calculated at the peak time of the left frontal lobe spike (0 ms) and it continued for 50 ms. The effect duration likely reflects the chosen temporal window of 70 ms. We also calculated the time-domain Granger-Geweke cauality using the AR model order = 6 and window length of 110 ms, the optimal values for the right frontal ROI ( Figure 3 , bottom panel). The result of unidirectional causal influence from the right frontal lobe to the left frontal lobe is consistent with the that calculated with AR model order = 4 and window length of 70 ms. The top panel of Figure 4 shows the dynamic frequency domain Granger-Geweke causality with values higher than 1.5 ( p -value < 10?4). Between 4 Hz and 22 Hz, from ?150 ms to 200 ms, there was no statistically significant Granger-Geweke causality found from the left frontal lobe to the right frontal lobe. However, we found statistically significant Granger-Geweke causality spectrally concentrated between 4 Hz and 20 Hz and temporally concentrated between ?10 ms and 0 ms. The frequency domain Granger-Geweke causality matched the time domain Granger-Geweke causality showing the right frontal lobe to the left frontal lobe spike propagation. Using a longer time window (110 ms) and a larger AR model order (6), we found that consistent unidirectional causality was found from the right frontal lobe to the left frontal lobe ( Figure 4 , bottom panel). Compared to the results of 70 ms window length and AR model order of 4, higher values in the causality estimates and wider causal interaction in time were likely attributed to the more complicated model (higher order in AR modelling) and a longer time window. Note that the time-frequency range showing strong causal interaction also overlaps with strong energy in the time-frequency representation of the time courses shown in Figure 1B .  DISCUSSION This study proposes a novel algorithm to estimate dynamic Granger-Geweke causality in both time and frequency domains. Based on clinical diagnosis, we tested and validated the feasibility of this approach by computing Granger-Geweke causality estimates from MEG data acquired from an epileptic patient. Epilepsy can be considered as a disorder of spontaneous neuronal activity. In general, we expect that the proposed method can be applied not only to spontaneous activity, but also task-related evoked or induced responses, since the algorithm derives the estimates from time series. The impact of Granger-Geweke causality estimates in the clinical diagnosis of spike propagation is that, taken together with other clinical considerations, such quantitative estimates may suggest minimal resection applied to the primary epileptogenic locus only in order to minimize the surgical complications. The causal relationship is already apparent in the source waveforms. In fact, this clinical case can be considered to “validate” the procedure of calculating dynamic Granger-Geweke causality. Since our calculation is consistent with this rather simple clinical case, we are more confident in applying this computational technique in other rather complicated studies, where non-invasive validation may be challenging. This computational tool can be also useful in basic neuroscience studies to elucidate the directional interaction of brain areas during behavior, tasks, and cognition. Oscillations are a cardinal signature of brain activity across a broad range of spatial and temporal scales, ranging from the cellular to the systems level ( Berger 1929 ; Cohen 1968 ; Singer 1999 ). Intuitively, oscillations are most effectively characterized in the frequency domain. Nevertheless, the nonstationary nature of oscillatory neural activity suggests that an effective analysis should span both spectral and temporal domains. In addition, the brain imaging methods used to investigate highly dynamic neural interactions must allow both high spatial and temporal specificity and sensitivity ( Mesulam 1990 ). Coupled with multimodal brain imaging using high temporal resolution MEG and high spatial resolution MRI, a dynamic causality analysis of neural oscillatory activity across spatial, temporal, and spectral domains will provide the opportunity to better understand complex neural information transfer mechanisms. It is possible that the proposed pairwise interaction models of pooled region-of-interest (ROI) time courses may miss some of the finer interactions or even has the potential problem of false causal estimates ( Kus, et al. 2004 ). This is the consequence of providing partial information of the system: causal interactions via regions outside the ROI pair were neglected. In our case, we do not suffer from this issue since the data can be accounted for by activity in only two ROIs (in left and right frontal lobes). To apply the method to a system with multiple ROIs, we can calculate conditional causality ( Chen, et al. 2006 ) by including all other ROI time series outside the chosen ROI pairs in order to avoid the problem of detecting false causal interactions or common driving source. This will change the calculation from pairwise bivariate AR modeling to multivariate AR modeling. The other challenge to our method is the situation of missing driving ROIs in the analysis. For example, it is possible to have one common hidden node driving other ROIs. In this case, our approach will give false causality estimates among ROIs. In this study, we used the minimum-norm estimates (MNE) to extract time courses for the brain space causality modeling. However, due to the cross-talk present in MNE, the time courses within a cortical region may be correlated. Due to the nature of correlated information inside the ROI, we may improve the computational efficiency by reducing the dimension of the data. For example, we may average the time courses within one ROI or use Singular-Value-Decomposition to first decompose the multivariate spatiotemporal data and then to remove the last few insignificant components in order to reduce the amount of computation in pairwise causality calculation. However, the spatiotemporal information may be incomplete if averaging or a dimension reduction method is used. We acknowledge that pairwise calculation based on partially correlated time courses may be biased. However, empirically this method can estimate the fluctuation range of the Granger-Geweke causality. To utilize this tool in planning of clinical treatment, we have to also consider the precision of source localization in order to extract accurate time series for the subsequent causality modeling. The spatial accuracy of the MNE source modeling on the MEG data has been studied extensively. Based on our clinical experience and comparison with the ECD modeling results we chose our ROI by selecting a critical threshold of p -value at 10?6 ( Hara, et al. 2007 ). The selection of the threshold may affect the size of ROI and subsequently the available time courses within a ROI will be different. The calculated SURE values appeared varying within a small range over the parametric space ( Figure 2 ). However, these numbers themselves do not carry any physical unit, and they are only used for comparing different models. In this study, we did not study the variability of the SURE values. We only use them to determine the optimal parameters for causality calculation. In fact, using two different combinations of the parameters gives consistent causality results ( Figures 3 and 4 ). This supports that the stability of the SURE criterion. The SURE values used for determining the optimal temporal window length may show no clear minimum because the biological mechanism generating the time series measurement does not follow an auto-regressive model. It is also possible that some window length is deemed optimal based on prior information. In such cases, it is possible to use a specific window length for dynamic Granger-Geweke causality analyses. It has been reported that the discrete time filter implementing the windowing dominates the frequency resolution of the covariance matrix ( Oppenheim, et al. 1999 ). Additionally, given a fixed amount of temporal observations, the trade-off between the length of a data segment and the number of the segments is essential for the bias and the variance in spectral estimation ( Oppenheim, et al. 1999 ). A Kaiser window ( Kuo and Kaiser 1966 ) may be used to tune the necessary frequency resolution. The selection of temporal segments can be proceeded using the “1/2 overlap” principle, which estimates the instantaneous covariance from data length l by overlapping l /2 samples from previous segments. The decision of the segment length l will depend on the size and the quality of the collected data. SEM has been widely used for effective connectivity analysis to elucidate directional causal interaction among brain areas. One principal difference between SEM and Granger-Geweke causality is that SEM is a more model-driven approach, i.e., a prior directional connectivity model must be provided before parameter estimation, while Granger-Geweke causality is a more data-driven approach where directional modulation is directly estimated from the time series without any prior information. However, AR modeling is still used in the calculation. One limitation of Granger-Geweke causality is the temporal resolution. Even using a temporal windowing approach as reported here, Granger-Geweke causality cannot resolve causal modulation within the chosen temporal window. SEM, on the other hand, is capable of achieving the highest temporal resolution by time-point by time-point calculation. Theoretically it is possible to combine Granger-Geweke causality and SEM in order to avoid the heuristic specification of the directional connectivity while achieving the highest temporal resolution possible. Specifically, Granger-Geweke causality can be utilized to estimate statistically significant directional paths for each possible pair of sources, to construct a directional connectivity matrix in SEM. Together with dynamic covariance matrix estimated from data, we may dynamically estimate path coefficients at the millisecond temporal resolution.  DISCUSSION This study proposes a novel algorithm to estimate dynamic Granger-Geweke causality in both time and frequency domains. Based on clinical diagnosis, we tested and validated the feasibility of this approach by computing Granger-Geweke causality estimates from MEG data acquired from an epileptic patient. Epilepsy can be considered as a disorder of spontaneous neuronal activity. In general, we expect that the proposed method can be applied not only to spontaneous activity, but also task-related evoked or induced responses, since the algorithm derives the estimates from time series. The impact of Granger-Geweke causality estimates in the clinical diagnosis of spike propagation is that, taken together with other clinical considerations, such quantitative estimates may suggest minimal resection applied to the primary epileptogenic locus only in order to minimize the surgical complications. The causal relationship is already apparent in the source waveforms. In fact, this clinical case can be considered to “validate” the procedure of calculating dynamic Granger-Geweke causality. Since our calculation is consistent with this rather simple clinical case, we are more confident in applying this computational technique in other rather complicated studies, where non-invasive validation may be challenging. This computational tool can be also useful in basic neuroscience studies to elucidate the directional interaction of brain areas during behavior, tasks, and cognition. Oscillations are a cardinal signature of brain activity across a broad range of spatial and temporal scales, ranging from the cellular to the systems level ( Berger 1929 ; Cohen 1968 ; Singer 1999 ). Intuitively, oscillations are most effectively characterized in the frequency domain. Nevertheless, the nonstationary nature of oscillatory neural activity suggests that an effective analysis should span both spectral and temporal domains. In addition, the brain imaging methods used to investigate highly dynamic neural interactions must allow both high spatial and temporal specificity and sensitivity ( Mesulam 1990 ). Coupled with multimodal brain imaging using high temporal resolution MEG and high spatial resolution MRI, a dynamic causality analysis of neural oscillatory activity across spatial, temporal, and spectral domains will provide the opportunity to better understand complex neural information transfer mechanisms. It is possible that the proposed pairwise interaction models of pooled region-of-interest (ROI) time courses may miss some of the finer interactions or even has the potential problem of false causal estimates ( Kus, et al. 2004 ). This is the consequence of providing partial information of the system: causal interactions via regions outside the ROI pair were neglected. In our case, we do not suffer from this issue since the data can be accounted for by activity in only two ROIs (in left and right frontal lobes). To apply the method to a system with multiple ROIs, we can calculate conditional causality ( Chen, et al. 2006 ) by including all other ROI time series outside the chosen ROI pairs in order to avoid the problem of detecting false causal interactions or common driving source. This will change the calculation from pairwise bivariate AR modeling to multivariate AR modeling. The other challenge to our method is the situation of missing driving ROIs in the analysis. For example, it is possible to have one common hidden node driving other ROIs. In this case, our approach will give false causality estimates among ROIs. In this study, we used the minimum-norm estimates (MNE) to extract time courses for the brain space causality modeling. However, due to the cross-talk present in MNE, the time courses within a cortical region may be correlated. Due to the nature of correlated information inside the ROI, we may improve the computational efficiency by reducing the dimension of the data. For example, we may average the time courses within one ROI or use Singular-Value-Decomposition to first decompose the multivariate spatiotemporal data and then to remove the last few insignificant components in order to reduce the amount of computation in pairwise causality calculation. However, the spatiotemporal information may be incomplete if averaging or a dimension reduction method is used. We acknowledge that pairwise calculation based on partially correlated time courses may be biased. However, empirically this method can estimate the fluctuation range of the Granger-Geweke causality. To utilize this tool in planning of clinical treatment, we have to also consider the precision of source localization in order to extract accurate time series for the subsequent causality modeling. The spatial accuracy of the MNE source modeling on the MEG data has been studied extensively. Based on our clinical experience and comparison with the ECD modeling results we chose our ROI by selecting a critical threshold of p -value at 10?6 ( Hara, et al. 2007 ). The selection of the threshold may affect the size of ROI and subsequently the available time courses within a ROI will be different. The calculated SURE values appeared varying within a small range over the parametric space ( Figure 2 ). However, these numbers themselves do not carry any physical unit, and they are only used for comparing different models. In this study, we did not study the variability of the SURE values. We only use them to determine the optimal parameters for causality calculation. In fact, using two different combinations of the parameters gives consistent causality results ( Figures 3 and 4 ). This supports that the stability of the SURE criterion. The SURE values used for determining the optimal temporal window length may show no clear minimum because the biological mechanism generating the time series measurement does not follow an auto-regressive model. It is also possible that some window length is deemed optimal based on prior information. In such cases, it is possible to use a specific window length for dynamic Granger-Geweke causality analyses. It has been reported that the discrete time filter implementing the windowing dominates the frequency resolution of the covariance matrix ( Oppenheim, et al. 1999 ). Additionally, given a fixed amount of temporal observations, the trade-off between the length of a data segment and the number of the segments is essential for the bias and the variance in spectral estimation ( Oppenheim, et al. 1999 ). A Kaiser window ( Kuo and Kaiser 1966 ) may be used to tune the necessary frequency resolution. The selection of temporal segments can be proceeded using the “1/2 overlap” principle, which estimates the instantaneous covariance from data length l by overlapping l /2 samples from previous segments. The decision of the segment length l will depend on the size and the quality of the collected data. SEM has been widely used for effective connectivity analysis to elucidate directional causal interaction among brain areas. One principal difference between SEM and Granger-Geweke causality is that SEM is a more model-driven approach, i.e., a prior directional connectivity model must be provided before parameter estimation, while Granger-Geweke causality is a more data-driven approach where directional modulation is directly estimated from the time series without any prior information. However, AR modeling is still used in the calculation. One limitation of Granger-Geweke causality is the temporal resolution. Even using a temporal windowing approach as reported here, Granger-Geweke causality cannot resolve causal modulation within the chosen temporal window. SEM, on the other hand, is capable of achieving the highest temporal resolution by time-point by time-point calculation. Theoretically it is possible to combine Granger-Geweke causality and SEM in order to avoid the heuristic specification of the directional connectivity while achieving the highest temporal resolution possible. Specifically, Granger-Geweke causality can be utilized to estimate statistically significant directional paths for each possible pair of sources, to construct a directional connectivity matrix in SEM. Together with dynamic covariance matrix estimated from data, we may dynamically estimate path coefficients at the millisecond temporal resolution.  CONCLUSIONS We employed dynamic Granger-Geweke causality estimates in both time and frequency domain in order to investigate directional influence among brain areas. This approach was applied to clinical spike propagation case to quantitatively ascertain the epileptic event propagating from the right frontal lobe to the left frontal lobe. We expect that the same algorithm can be applied to MEG, EEG, fMRI, or combined modality data in order to help better understand the complex interactions within the human brain.  Figures Figure 1 A: Inlet: The epileptic activity estimated by dSPM of the average spike at left and right frontal lobe respectively. The results were rendered on the inflated cortical surface where dark gray and light gray colors indicated sulci and gyri respectively. The time origin was chosen such that the peak of the left frontal lobe spike was 0 ms. Panel: The average and standard deviation of the time courses at the left and right frontal lobe ROIs. B: the average absolute values of the time-frequency representation of the time courses in the left and right frontal lobes. The color range was selected to show the range between the 20% and 80% of the maximal value. Figure 2 The SURE numbers calculated by the left and right frontal lobe time series. Note that the color codes for the negative SURE values. Therefore the highest values in each panel of the figure correspond to the minimal values in the cost function, which were indicated by a white star inside a box with light blue boundary. Figure 3 The time-domain dynamic Granger-Geweke causality. The mean value and the standard deviation of the Granger-Geweke causality in both directions estimated from all pairwise calculation within ROIs and between ?150 ms and 200 ms. Top: AR model order = 4 and window length = 70 ms (optimal for the left frontal lobe in SURE criterion); Bottom: AR model morder = 6 and window length = 110 ms (optimal for the right frontal lobe in SURE criterion). Figure 4 The frequency-domain dynamic Granger-Geweke causality with spectral analysis between 4 Hz and 22, and from ?150 ms to 200 ms. Top: AR model order = 4 and window length = 70 ms (optimal for the left frontal lobe in SURE criterion); Bottom: AR model morder = 6 and window length = 110 ms (optimal for the right frontal lobe in SURE criterion). 