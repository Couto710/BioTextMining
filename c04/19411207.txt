Breast Ultrasound Image Improvement By Pixel Compounding of Compression Sequence Pixel compounding is a technique that synthesizes the information of an image sequence involving slow decorrelation of the speckle to form a detail-recovered and speckle reduced image. To avoid extra data acquisition time and patient exposure, reuse of the existing data is desirable. In the procedure of elasticity imaging, a set of B-mode images with slight changes due to deformation is produced, which provides an ideal input for the pixel compounding. The improvement in image quality is evaluated quantitatively using a figure-of-merit (FOM) that indicates the goodness of boundary information recovery and the contrast-to-noise ratio (CNR) over the phantom images. The increase in average CNR is from 0.4 in the original images to 0.8 in the pixel compounded images. The improvement in average FOM is from 0.15 to over 0.5 on a scale of 0 to 1. In vivo results with a breast cyst, a fibroadenoma, and a breast cancer 1 are also presented and the image quality improvement is subjectively evaluated. The results suggest that B-mode breast images from compression procedures are suitable data for pixel compounding, and that a speckle reduced and detail-recovered or detail-maintained image can be produced. The improved imaging may provide alternative or better information for detection and diagnosis. A similar approach could be extended to elasticity imaging with other modalities.  1. INTRODUCTION Ultrasound B-mode imaging suffers from uncertainty or loss of structural detail due to the presence of speckle noise and the limited number of scan-lines and axial pixelization. The usual way to improve quality is speckle reduction [ 1 ] [ 2 ]. However, speckle reduction often results in the further loss of image detail. To better balance detail retention and noise reduction, image sequence processing is often preferred to the techniques of single image processing. Spatial compounding is a well established technique of image sequence processing in ultrasound. Normally, it requires the acquisition of images from different angles to form a speckle and artifact reduced single image by alignment [ 3 ] [ 4 ] and weighted-sum of the acquired images [ 5 ] [ 6 ] [ 7 ] [ 8 ]. In spite of these apparent advantages, this technique provides limited improvement in detail recovery and retention. This is due to the nature of ultrasound image formation, i.e., the underlying structural information in the ultrasound image is the result of coherent reflections. At different beam angles, the reflection interfaces are associated with the beam incident angles. As a result, compounding often averages the reflections from differently oriented interfaces and results in a smoothed image. Other approaches of spatial compounding have been reported, described as strain compounding [ 9 ] [ 10 ] and motion compensation compounding [ 11 ]. In these techniques, images are taken at the same acquisition location and transducer-orientation, but as the object is being compressed. Since the process decorrelates the speckle between the acquisitions [ 9 ], compounding results in a speckle reduced image. Moreover, since the reflection interfaces usually remain as similar structural features during compression, the techniques provide the potential to enhance the macroscopic structural information. However, the reported work is focused mainly on reduction of variations in speckle brightness, instead of enhancement of detail information. Pixel compounding [ 12 ], which will be used here, is an extension of the super-resolution techniques in the ultrasound imaging field. The detailed description and derivation can be found in [ 12 ]. More information about super-resolution can be found in [ 13 ] [ 14 ] [ 15 ] [ 16 ]. Pixel compounding is an image-sequence processing method that combines image registration, fusion, and restoration to produce a detail-improved and speckle reduced image. When pixel compounding is performed, the inter-image spatial changes are first detected, and then the images are aligned based on the changes. Finally, an optimization technique is used to produce an overall improved fused result. Restoration is often included in the optimization process. Compared to the previous work in [ 12 ], there are two new important contributions reported here. First, it is a preliminary trial of achieving speckle-reduced breast ultrasound from the images acquired during breast compression as employed in our 3D imaging and in typical hand-controlled elasticity imaging. Thus the pixel compounding extends neither image acquisition time nor acoustic exposure during such elasticity imaging and could similarly be performed on related image sequence acquisition in which there is some small motion. Secondly, reduced speckle offers the possibility of better interpretation of the tissue characteristics from the results of pixel compounding. If consistently true, the technique may improve breast screening, diagnosis, and selection and monitoring of treatment. The remainder of this report is organized as follows. First, we give a brief description of pixel compounding and experimental setup. Secondly, we report results from a breast phantom and clinical data (cyst, fibroadenoma, and malignant mass). We provide quantitative evaluations of image quality in tissue-equivalent phantoms and visual evaluation on the clinical data. Finally we discuss these results.  2. MATERIALS AND METHODS 2.1 Pixel compounding Using a 1D case as an example, assume we are observing a sinusoidal signal with a sampling rate equal to the frequency of the signal. The resulting sampled signal will be a straight line because samples are obtained at the same phase of the original signal. If we have precise control to set delays for the initial sampling time, we can set the delays to 0, T/4, T/2, and 3T/4 (or a smaller increment) to get four data sequences of the signal. Each sequence will produce a straight line at different amplitude. If we place all the samples from four data sequences at the correct time instants, a sinusoidal signal can be recovered. This is the idea of super-resolution as a technique of detail-recovery. In the 2D case, we can model the imaging process as (1) y ? k = H ^ k x ? + n ? k , for k = 1 , 2 , … , p where y ? k is the acquired image observations, each with M pixels, x ? is the improved image containing N pixels to be estimated and p is the number of the acquired images. H ^ k is the imaging system transfer function that maps x ? to each y ? k , therefore it is a M × N matrix that incorporates the effect of image blurring, inter-image displacement and discretization (sampling). n ? k is the noise term including speckle ( M -element vector). The task of pixel compounding is to find x ? , the detail-improved image, from the observed images y ? k . If N = M , this work becomes similar to the strain compounding described in [ 9 ] and [ 10 ]. We make N > M for a finer resolution grid to make room for a better detail-recovered result. In the above formula, y ? k , x ? , and n ? k are vectors and H ^ k is a matrix. The problem can be solved by minimizing the scalar total-square-error: (2) E 0 = ? k = 1 p ? y ? k ? H ^ k x ? ? 2 This formula can be simplified by concatenating all the y ? k 's (column vectors) in a larger column vector, Y ? , and vertically stacking all the mapping matrix H ^ k 's in a large matrix H ^ : (3) E 0 = ? Y ? ? H ^ x ? ? 2 To promise a stable solution, a regularization term needs to be included when performing minimization: (4) E = ? ? Y ? ? H ^ x ? ? 2 + ? c ? C ? ( ? ? c x ? ? 2 ) Where the first term on the right is a “fidelity” term that forces the estimated x ? to be as close to the observation images y ? as possible. The second term is a discontinuity reduction term that suppresses potential instability of the algorithm. ? is a weighting factor to balance the effects of the first and second terms. ? c is a discrete gradient operator at a 4-pixel neighborhood location ( c is a particular 4-pixel neighborhood and C is the total 4-neighborhood set in x ? [ 17 ]. Following a Euler-Lagrange equation of the form, (5) ? E ? x ? ? c ? E ? ( ? c x ) = 0 minimization of ( 4 ) leads to the following equation: (6) H ^ T ? ( H ^ x ? ? y ? ) ? ? c [ ? ? ( ? ? c x ? ? 2 ) ? c x ? ] = 0 where H ^ T is the transpose of H ^ and ??(?) is the derivative of ?(?) with respect to ?. Let (7) D = ? ? ( ? ? c x ? ? 2 ) With the steepest descent approach, x ? can be estimated through the following iterative process: (8) x ? m + 1 = x ? m ? ? ( H ^ T ? ( H ^ x ? m ? Y ? ) ? ? c [ D m ? c x ? m ] ) where m is the iteration counter and ? is the iteration step size. Equation (8) is known as a non-homogeneous diffusion equation with D being the diffusion coefficient. We select D in the following format: (9) D m = 1 1 + ? ? c x ? m ? 2 ? ( ? m ) 2 where ? is a threshold parameter determined by the noise floor of the image x ? . When an image region is largely noise with little structural variation, the local changes ? c x ? are generally smaller than ?, the diffusion process is encouraged and the image is smoothed. When ? c x ? is larger than ?, encouraging a backward diffusion, the intensity changes are enhanced [ 17 ]. In the present work, we set ? to twice the standard deviation of the current estimate of x ? . The homogeneous version of ( 8 ) has been reported for ultrasound B-mode image speckle reduction [ 2 ]. 2.2 Image acquisition B-mode data were acquired on a mammography-mimicking compressed-breast imaging unit, a prototype of the combined system co-developed by General Electric (Niskayuna, NY) and the University of Michigan [ 18 ] [ 19 ] [ 20 ]. The ultrasound transducer was situated on the top paddle and moved on the paddle plane in two Cartesian axes. The top paddle was up to 2.5mm in thickness. Its acoustic attenuation and beam aberration were minimal [ 21 ]. In our test, a 7.5MHz linear array ultrasound transducer and GE Logiq 9 scanner were used. The breast was placed between the paddles and pre-compressed to a comfortable level for stability and maximum imaging coverage. The ultrasound images for elasticity processing of one plane were acquired continuously over 2 seconds while the compression was increased. Maximum additional applied compression was 5 mm. 2.3 Forming pixel compounding image When the data are used to form pixel compounded images, a non-rigid image registration is performed first. We select the center image of the sequence as the reference image. All other images in the sequence are registered and corrected with respect to the reference. It avoids the computational difficulties due to large changes between two images with widely separated compressions. Registration is performed on the platform of mutual information-based automatic multimodality image fusion (MIAMI Fuse©) [ 22 ] [ 23 ]. Speckle tracking was also one of the initial candidates for image alignment; however, our approaches to it were not as robust as the refined 3D registration of MIAMI Fuse©. Pixel compounding from deformation-corrected images is feasible since the compression displacement allows the information in one image pixel grid to re-distribute to different pixel grids in other images. In ultrasound image formation, we know that the intensity of each pixel is essentially determined by the coherent summation of signal from the scatters that fall into the point spread function (PSF) recorded in a pixel. The magnitude of compression changes the number and position of the scatterers contributing to each pixel. After correcting for deformation, the structural information is recovered but the speckle differs from the repositioning of scatterers. This induces some desired effects: the registration could achieve sub-pixel accuracy that enables the recovery of finer image details while speckle becomes less-correlated [ 9 ] and can be reduced by the compounding process. In actual implementation, we select ? = 1 so that the detail recovery and noise reduction have the same updating strength and set ? = 1/8 for numerical stability of the algorithm [ 12 ] [ 17 ] for equation (8) .  2.1 Pixel compounding Using a 1D case as an example, assume we are observing a sinusoidal signal with a sampling rate equal to the frequency of the signal. The resulting sampled signal will be a straight line because samples are obtained at the same phase of the original signal. If we have precise control to set delays for the initial sampling time, we can set the delays to 0, T/4, T/2, and 3T/4 (or a smaller increment) to get four data sequences of the signal. Each sequence will produce a straight line at different amplitude. If we place all the samples from four data sequences at the correct time instants, a sinusoidal signal can be recovered. This is the idea of super-resolution as a technique of detail-recovery. In the 2D case, we can model the imaging process as (1) y ? k = H ^ k x ? + n ? k , for k = 1 , 2 , … , p where y ? k is the acquired image observations, each with M pixels, x ? is the improved image containing N pixels to be estimated and p is the number of the acquired images. H ^ k is the imaging system transfer function that maps x ? to each y ? k , therefore it is a M × N matrix that incorporates the effect of image blurring, inter-image displacement and discretization (sampling). n ? k is the noise term including speckle ( M -element vector). The task of pixel compounding is to find x ? , the detail-improved image, from the observed images y ? k . If N = M , this work becomes similar to the strain compounding described in [ 9 ] and [ 10 ]. We make N > M for a finer resolution grid to make room for a better detail-recovered result. In the above formula, y ? k , x ? , and n ? k are vectors and H ^ k is a matrix. The problem can be solved by minimizing the scalar total-square-error: (2) E 0 = ? k = 1 p ? y ? k ? H ^ k x ? ? 2 This formula can be simplified by concatenating all the y ? k 's (column vectors) in a larger column vector, Y ? , and vertically stacking all the mapping matrix H ^ k 's in a large matrix H ^ : (3) E 0 = ? Y ? ? H ^ x ? ? 2 To promise a stable solution, a regularization term needs to be included when performing minimization: (4) E = ? ? Y ? ? H ^ x ? ? 2 + ? c ? C ? ( ? ? c x ? ? 2 ) Where the first term on the right is a “fidelity” term that forces the estimated x ? to be as close to the observation images y ? as possible. The second term is a discontinuity reduction term that suppresses potential instability of the algorithm. ? is a weighting factor to balance the effects of the first and second terms. ? c is a discrete gradient operator at a 4-pixel neighborhood location ( c is a particular 4-pixel neighborhood and C is the total 4-neighborhood set in x ? [ 17 ]. Following a Euler-Lagrange equation of the form, (5) ? E ? x ? ? c ? E ? ( ? c x ) = 0 minimization of ( 4 ) leads to the following equation: (6) H ^ T ? ( H ^ x ? ? y ? ) ? ? c [ ? ? ( ? ? c x ? ? 2 ) ? c x ? ] = 0 where H ^ T is the transpose of H ^ and ??(?) is the derivative of ?(?) with respect to ?. Let (7) D = ? ? ( ? ? c x ? ? 2 ) With the steepest descent approach, x ? can be estimated through the following iterative process: (8) x ? m + 1 = x ? m ? ? ( H ^ T ? ( H ^ x ? m ? Y ? ) ? ? c [ D m ? c x ? m ] ) where m is the iteration counter and ? is the iteration step size. Equation (8) is known as a non-homogeneous diffusion equation with D being the diffusion coefficient. We select D in the following format: (9) D m = 1 1 + ? ? c x ? m ? 2 ? ( ? m ) 2 where ? is a threshold parameter determined by the noise floor of the image x ? . When an image region is largely noise with little structural variation, the local changes ? c x ? are generally smaller than ?, the diffusion process is encouraged and the image is smoothed. When ? c x ? is larger than ?, encouraging a backward diffusion, the intensity changes are enhanced [ 17 ]. In the present work, we set ? to twice the standard deviation of the current estimate of x ? . The homogeneous version of ( 8 ) has been reported for ultrasound B-mode image speckle reduction [ 2 ].  2.2 Image acquisition B-mode data were acquired on a mammography-mimicking compressed-breast imaging unit, a prototype of the combined system co-developed by General Electric (Niskayuna, NY) and the University of Michigan [ 18 ] [ 19 ] [ 20 ]. The ultrasound transducer was situated on the top paddle and moved on the paddle plane in two Cartesian axes. The top paddle was up to 2.5mm in thickness. Its acoustic attenuation and beam aberration were minimal [ 21 ]. In our test, a 7.5MHz linear array ultrasound transducer and GE Logiq 9 scanner were used. The breast was placed between the paddles and pre-compressed to a comfortable level for stability and maximum imaging coverage. The ultrasound images for elasticity processing of one plane were acquired continuously over 2 seconds while the compression was increased. Maximum additional applied compression was 5 mm.  2.3 Forming pixel compounding image When the data are used to form pixel compounded images, a non-rigid image registration is performed first. We select the center image of the sequence as the reference image. All other images in the sequence are registered and corrected with respect to the reference. It avoids the computational difficulties due to large changes between two images with widely separated compressions. Registration is performed on the platform of mutual information-based automatic multimodality image fusion (MIAMI Fuse©) [ 22 ] [ 23 ]. Speckle tracking was also one of the initial candidates for image alignment; however, our approaches to it were not as robust as the refined 3D registration of MIAMI Fuse©. Pixel compounding from deformation-corrected images is feasible since the compression displacement allows the information in one image pixel grid to re-distribute to different pixel grids in other images. In ultrasound image formation, we know that the intensity of each pixel is essentially determined by the coherent summation of signal from the scatters that fall into the point spread function (PSF) recorded in a pixel. The magnitude of compression changes the number and position of the scatterers contributing to each pixel. After correcting for deformation, the structural information is recovered but the speckle differs from the repositioning of scatterers. This induces some desired effects: the registration could achieve sub-pixel accuracy that enables the recovery of finer image details while speckle becomes less-correlated [ 9 ] and can be reduced by the compounding process. In actual implementation, we select ? = 1 so that the detail recovery and noise reduction have the same updating strength and set ? = 1/8 for numerical stability of the algorithm [ 12 ] [ 17 ] for equation (8) .  3. RESULTS Validation of the proposed imaging approach has been conducted with a breast phantom, breast with a cyst, a fibroadenoma, and a malignant tumor. These results show that pixel compounded imaging from elasticity imaging data can produce higher quality images with presumed potential use in medical practice. Besides visual evaluation, we also present the results of two objective quality measures, a figure-of-merit (FOM) for evaluation of detail-recovery and contrast-to-noise ratio (CNR) for speckle reduction, on the breast phantom results to predict the effectiveness of the imaging technique. 3.1 Breast phantom Figs. 1 and 2 show two phantom results. Fig. 1(a) is one of 12 original elasticity-sequence B-mode images. All 12 original images have high speckle content and image details are missing in different aspects. The boundary of the solid inclusion looks diffusive. The same situation is observed in Fig. 2(a) . Figs. 1(b) and 2(b) show the corresponding pixel compounding results. Clearly, the missing details of the inclusion boundaries have been well recovered and enhanced while speckle is well suppressed in both pixel compounded images. We applied a level set algorithm [ 24 ] on the images of Figs. 1 and 2 to detect the boundaries in both input images and pixel compounded images. The algorithm is kept in similar conditions (same parameter settings) for both cases. Fig. 3(a) shows that the detection has failed because of missing details and lack of definition on boundaries. Fig. 3(b) shows the boundary can be well detected in pixel compounded image. Similar effects are shown in Fig. 4(a) and (b) . To quantitatively evaluate how well the image detail and structural information (boundaries) have been recovered, we applied Pratt's figure of merit ( FOM ) [ 25 ]: (10) FOM = 1 N ? i = 1 N 1 1 + d i 2 ? where N is the number of detected boundary pixels. d i is the Euclidean distance between the ith detected boundary pixel and the nearest pixel on the ideal boundary. ? is a constant typically set to 1/9. The dynamic range of FOM is within [0, 1]. A higher value indicates better boundary agreement between detected boundary and the ideal boundary. In our test, a carefully manually drawn boundary was used as the ideal boundary. Table I shows the FOM values for two sets of phantom data with different trials (same initial contours are used for both original and pixel compounded images in the same trial). As this table shows, the boundary recovered on pixel compounded images gives significantly higher FOM values, indicating that an automated contour was closer to the visually assessed boundary, where the reader knew the spherical shape of the object in the phantom. This ease of improved automated boundary detection suggests that there is improved structural information, and possibly image detail, in pixel compounded results. Second, we performed a contrast-to-noise ratio (CNR) test on both cases. CNR is given as (11) CNR = S i ? S o ( ? i 2 + ? o 2 ) 1 ? 2 where S i and S o are the mean values inside and outside the inclusion respectively and ?i and ?o are the standard deviations in the corresponding regions. The CNR results are shown in Table II . Pixel compounded results have significantly higher CNR values compared to their counterpart of input images. 3.2 Cyst Fig. 5 shows breast images of a cyst. Fig. 5(a) shows one of 16 original images. Similarly, the image is compromised by speckle noise, some detailed structures are missing, and some subtle structures are obscured. Fig. 5(b) shows the pixel compounding result of these 16 input images. Again the speckle has been greatly suppressed and details are recovered and better represented. The small structures comparable to the size of speckle noise in the original images (therefore they are easy to ignore or treated as noise) have emerged and are even enhanced. For example, in Fig. 5(b) , the two dark areas at the lower left side of the cyst indicated by the thick arrows and the tube-like structures, indicated by the thin arrows, running near the left boundary of the image at the vertical coordinate of 19mm, are clearly shown and enhanced. 3.3 Fibroadenoma Fig. 6 shows breast images of a fibroadenoma. Fig. 6(a) shows one of 18 original images and Fig. 6(b) is the pixel compounding result. An interesting observation from Fig. 6(b) is that the speckle reduction only happens outside the boundary of the fibroadenoma. There is little noise reduction inside the lesion. This indicates the low compressibility of the fibroadenoma compared to its surroundings. We also observed detail recovery in the detail-rich regions, particularly the structures marked by the arrows. 3.4 Malignant Mass Fig. 7 shows breast images with an invasive ductal carcinoma. Fig. 7(a) shows one of 15 original images and Fig. 7(b) again is the resulting image. Comparing Fig. 7(a) and (b) , we can observe that the structures in (b) are better delineated than (a). As reported by radiologist, the cancer is the hypoechoic region in the lower left of the images marked by the arrows. Pixel compounding made the cancer more apparent. There is a more apparent but subtle adjacent echogenic halo, which is a known characteristic of cancers. Retention of speckle patterns within the tumor suggests stiffness as in the case of the fibroadenoma. Superior delineation of subtle detail and boundaries are also observed in other regions of the image.  3. RESULTS Validation of the proposed imaging approach has been conducted with a breast phantom, breast with a cyst, a fibroadenoma, and a malignant tumor. These results show that pixel compounded imaging from elasticity imaging data can produce higher quality images with presumed potential use in medical practice. Besides visual evaluation, we also present the results of two objective quality measures, a figure-of-merit (FOM) for evaluation of detail-recovery and contrast-to-noise ratio (CNR) for speckle reduction, on the breast phantom results to predict the effectiveness of the imaging technique. 3.1 Breast phantom Figs. 1 and 2 show two phantom results. Fig. 1(a) is one of 12 original elasticity-sequence B-mode images. All 12 original images have high speckle content and image details are missing in different aspects. The boundary of the solid inclusion looks diffusive. The same situation is observed in Fig. 2(a) . Figs. 1(b) and 2(b) show the corresponding pixel compounding results. Clearly, the missing details of the inclusion boundaries have been well recovered and enhanced while speckle is well suppressed in both pixel compounded images. We applied a level set algorithm [ 24 ] on the images of Figs. 1 and 2 to detect the boundaries in both input images and pixel compounded images. The algorithm is kept in similar conditions (same parameter settings) for both cases. Fig. 3(a) shows that the detection has failed because of missing details and lack of definition on boundaries. Fig. 3(b) shows the boundary can be well detected in pixel compounded image. Similar effects are shown in Fig. 4(a) and (b) . To quantitatively evaluate how well the image detail and structural information (boundaries) have been recovered, we applied Pratt's figure of merit ( FOM ) [ 25 ]: (10) FOM = 1 N ? i = 1 N 1 1 + d i 2 ? where N is the number of detected boundary pixels. d i is the Euclidean distance between the ith detected boundary pixel and the nearest pixel on the ideal boundary. ? is a constant typically set to 1/9. The dynamic range of FOM is within [0, 1]. A higher value indicates better boundary agreement between detected boundary and the ideal boundary. In our test, a carefully manually drawn boundary was used as the ideal boundary. Table I shows the FOM values for two sets of phantom data with different trials (same initial contours are used for both original and pixel compounded images in the same trial). As this table shows, the boundary recovered on pixel compounded images gives significantly higher FOM values, indicating that an automated contour was closer to the visually assessed boundary, where the reader knew the spherical shape of the object in the phantom. This ease of improved automated boundary detection suggests that there is improved structural information, and possibly image detail, in pixel compounded results. Second, we performed a contrast-to-noise ratio (CNR) test on both cases. CNR is given as (11) CNR = S i ? S o ( ? i 2 + ? o 2 ) 1 ? 2 where S i and S o are the mean values inside and outside the inclusion respectively and ?i and ?o are the standard deviations in the corresponding regions. The CNR results are shown in Table II . Pixel compounded results have significantly higher CNR values compared to their counterpart of input images. 3.2 Cyst Fig. 5 shows breast images of a cyst. Fig. 5(a) shows one of 16 original images. Similarly, the image is compromised by speckle noise, some detailed structures are missing, and some subtle structures are obscured. Fig. 5(b) shows the pixel compounding result of these 16 input images. Again the speckle has been greatly suppressed and details are recovered and better represented. The small structures comparable to the size of speckle noise in the original images (therefore they are easy to ignore or treated as noise) have emerged and are even enhanced. For example, in Fig. 5(b) , the two dark areas at the lower left side of the cyst indicated by the thick arrows and the tube-like structures, indicated by the thin arrows, running near the left boundary of the image at the vertical coordinate of 19mm, are clearly shown and enhanced. 3.3 Fibroadenoma Fig. 6 shows breast images of a fibroadenoma. Fig. 6(a) shows one of 18 original images and Fig. 6(b) is the pixel compounding result. An interesting observation from Fig. 6(b) is that the speckle reduction only happens outside the boundary of the fibroadenoma. There is little noise reduction inside the lesion. This indicates the low compressibility of the fibroadenoma compared to its surroundings. We also observed detail recovery in the detail-rich regions, particularly the structures marked by the arrows. 3.4 Malignant Mass Fig. 7 shows breast images with an invasive ductal carcinoma. Fig. 7(a) shows one of 15 original images and Fig. 7(b) again is the resulting image. Comparing Fig. 7(a) and (b) , we can observe that the structures in (b) are better delineated than (a). As reported by radiologist, the cancer is the hypoechoic region in the lower left of the images marked by the arrows. Pixel compounding made the cancer more apparent. There is a more apparent but subtle adjacent echogenic halo, which is a known characteristic of cancers. Retention of speckle patterns within the tumor suggests stiffness as in the case of the fibroadenoma. Superior delineation of subtle detail and boundaries are also observed in other regions of the image.  3.1 Breast phantom Figs. 1 and 2 show two phantom results. Fig. 1(a) is one of 12 original elasticity-sequence B-mode images. All 12 original images have high speckle content and image details are missing in different aspects. The boundary of the solid inclusion looks diffusive. The same situation is observed in Fig. 2(a) . Figs. 1(b) and 2(b) show the corresponding pixel compounding results. Clearly, the missing details of the inclusion boundaries have been well recovered and enhanced while speckle is well suppressed in both pixel compounded images. We applied a level set algorithm [ 24 ] on the images of Figs. 1 and 2 to detect the boundaries in both input images and pixel compounded images. The algorithm is kept in similar conditions (same parameter settings) for both cases. Fig. 3(a) shows that the detection has failed because of missing details and lack of definition on boundaries. Fig. 3(b) shows the boundary can be well detected in pixel compounded image. Similar effects are shown in Fig. 4(a) and (b) . To quantitatively evaluate how well the image detail and structural information (boundaries) have been recovered, we applied Pratt's figure of merit ( FOM ) [ 25 ]: (10) FOM = 1 N ? i = 1 N 1 1 + d i 2 ? where N is the number of detected boundary pixels. d i is the Euclidean distance between the ith detected boundary pixel and the nearest pixel on the ideal boundary. ? is a constant typically set to 1/9. The dynamic range of FOM is within [0, 1]. A higher value indicates better boundary agreement between detected boundary and the ideal boundary. In our test, a carefully manually drawn boundary was used as the ideal boundary. Table I shows the FOM values for two sets of phantom data with different trials (same initial contours are used for both original and pixel compounded images in the same trial). As this table shows, the boundary recovered on pixel compounded images gives significantly higher FOM values, indicating that an automated contour was closer to the visually assessed boundary, where the reader knew the spherical shape of the object in the phantom. This ease of improved automated boundary detection suggests that there is improved structural information, and possibly image detail, in pixel compounded results. Second, we performed a contrast-to-noise ratio (CNR) test on both cases. CNR is given as (11) CNR = S i ? S o ( ? i 2 + ? o 2 ) 1 ? 2 where S i and S o are the mean values inside and outside the inclusion respectively and ?i and ?o are the standard deviations in the corresponding regions. The CNR results are shown in Table II . Pixel compounded results have significantly higher CNR values compared to their counterpart of input images.  3.1 Breast phantom Figs. 1 and 2 show two phantom results. Fig. 1(a) is one of 12 original elasticity-sequence B-mode images. All 12 original images have high speckle content and image details are missing in different aspects. The boundary of the solid inclusion looks diffusive. The same situation is observed in Fig. 2(a) . Figs. 1(b) and 2(b) show the corresponding pixel compounding results. Clearly, the missing details of the inclusion boundaries have been well recovered and enhanced while speckle is well suppressed in both pixel compounded images. We applied a level set algorithm [ 24 ] on the images of Figs. 1 and 2 to detect the boundaries in both input images and pixel compounded images. The algorithm is kept in similar conditions (same parameter settings) for both cases. Fig. 3(a) shows that the detection has failed because of missing details and lack of definition on boundaries. Fig. 3(b) shows the boundary can be well detected in pixel compounded image. Similar effects are shown in Fig. 4(a) and (b) . To quantitatively evaluate how well the image detail and structural information (boundaries) have been recovered, we applied Pratt's figure of merit ( FOM ) [ 25 ]: (10) FOM = 1 N ? i = 1 N 1 1 + d i 2 ? where N is the number of detected boundary pixels. d i is the Euclidean distance between the ith detected boundary pixel and the nearest pixel on the ideal boundary. ? is a constant typically set to 1/9. The dynamic range of FOM is within [0, 1]. A higher value indicates better boundary agreement between detected boundary and the ideal boundary. In our test, a carefully manually drawn boundary was used as the ideal boundary. Table I shows the FOM values for two sets of phantom data with different trials (same initial contours are used for both original and pixel compounded images in the same trial). As this table shows, the boundary recovered on pixel compounded images gives significantly higher FOM values, indicating that an automated contour was closer to the visually assessed boundary, where the reader knew the spherical shape of the object in the phantom. This ease of improved automated boundary detection suggests that there is improved structural information, and possibly image detail, in pixel compounded results. Second, we performed a contrast-to-noise ratio (CNR) test on both cases. CNR is given as (11) CNR = S i ? S o ( ? i 2 + ? o 2 ) 1 ? 2 where S i and S o are the mean values inside and outside the inclusion respectively and ?i and ?o are the standard deviations in the corresponding regions. The CNR results are shown in Table II . Pixel compounded results have significantly higher CNR values compared to their counterpart of input images.  3.2 Cyst Fig. 5 shows breast images of a cyst. Fig. 5(a) shows one of 16 original images. Similarly, the image is compromised by speckle noise, some detailed structures are missing, and some subtle structures are obscured. Fig. 5(b) shows the pixel compounding result of these 16 input images. Again the speckle has been greatly suppressed and details are recovered and better represented. The small structures comparable to the size of speckle noise in the original images (therefore they are easy to ignore or treated as noise) have emerged and are even enhanced. For example, in Fig. 5(b) , the two dark areas at the lower left side of the cyst indicated by the thick arrows and the tube-like structures, indicated by the thin arrows, running near the left boundary of the image at the vertical coordinate of 19mm, are clearly shown and enhanced.  3.2 Cyst Fig. 5 shows breast images of a cyst. Fig. 5(a) shows one of 16 original images. Similarly, the image is compromised by speckle noise, some detailed structures are missing, and some subtle structures are obscured. Fig. 5(b) shows the pixel compounding result of these 16 input images. Again the speckle has been greatly suppressed and details are recovered and better represented. The small structures comparable to the size of speckle noise in the original images (therefore they are easy to ignore or treated as noise) have emerged and are even enhanced. For example, in Fig. 5(b) , the two dark areas at the lower left side of the cyst indicated by the thick arrows and the tube-like structures, indicated by the thin arrows, running near the left boundary of the image at the vertical coordinate of 19mm, are clearly shown and enhanced.  3.3 Fibroadenoma Fig. 6 shows breast images of a fibroadenoma. Fig. 6(a) shows one of 18 original images and Fig. 6(b) is the pixel compounding result. An interesting observation from Fig. 6(b) is that the speckle reduction only happens outside the boundary of the fibroadenoma. There is little noise reduction inside the lesion. This indicates the low compressibility of the fibroadenoma compared to its surroundings. We also observed detail recovery in the detail-rich regions, particularly the structures marked by the arrows.  3.3 Fibroadenoma Fig. 6 shows breast images of a fibroadenoma. Fig. 6(a) shows one of 18 original images and Fig. 6(b) is the pixel compounding result. An interesting observation from Fig. 6(b) is that the speckle reduction only happens outside the boundary of the fibroadenoma. There is little noise reduction inside the lesion. This indicates the low compressibility of the fibroadenoma compared to its surroundings. We also observed detail recovery in the detail-rich regions, particularly the structures marked by the arrows.  3.4 Malignant Mass Fig. 7 shows breast images with an invasive ductal carcinoma. Fig. 7(a) shows one of 15 original images and Fig. 7(b) again is the resulting image. Comparing Fig. 7(a) and (b) , we can observe that the structures in (b) are better delineated than (a). As reported by radiologist, the cancer is the hypoechoic region in the lower left of the images marked by the arrows. Pixel compounding made the cancer more apparent. There is a more apparent but subtle adjacent echogenic halo, which is a known characteristic of cancers. Retention of speckle patterns within the tumor suggests stiffness as in the case of the fibroadenoma. Superior delineation of subtle detail and boundaries are also observed in other regions of the image.  3.4 Malignant Mass Fig. 7 shows breast images with an invasive ductal carcinoma. Fig. 7(a) shows one of 15 original images and Fig. 7(b) again is the resulting image. Comparing Fig. 7(a) and (b) , we can observe that the structures in (b) are better delineated than (a). As reported by radiologist, the cancer is the hypoechoic region in the lower left of the images marked by the arrows. Pixel compounding made the cancer more apparent. There is a more apparent but subtle adjacent echogenic halo, which is a known characteristic of cancers. Retention of speckle patterns within the tumor suggests stiffness as in the case of the fibroadenoma. Superior delineation of subtle detail and boundaries are also observed in other regions of the image.  4. DISCUSSION AND CONCLUSIONS Our results suggest that pixel compounding can produce substantially higher quality images from the B-mode images obtained during breast compression. In ultrasound imaging, the PSF, which determines the image resolution and most of the low contrast detectability, is determined by the active aperture size and apodization settings. Generally, an operator has little knowledge of, or access to, these low level parameters in a given ultrasound system. During the breast compression, fine structures emerge or fade in image pixels due to tissue movement, the partial volume effect, and the change of the local ultrasound illumination. As a result, individual images often give slightly different views or even incomplete views of the imaged object. Acquisition of an image sequence provides a solution for a better imaging result in terms of noise reduction and displayed detail. As a matter of fact, there are two sources of speckle reduction in our technique. The first is similar to strain compounding proposed in [ 9 ] in which speckle reduction is achieved from combining somewhat speckle-decorrelated images. The second source of speckle reduction is the adaptive diffusion process [ 2 ], which is the second term in the right side of ( 8 ) as the diffusion equation (12) x ? m + 1 = x ? m + ? ? c [ D m ? c x ? m ] has been used for speckle reduction [ 2 ]. Therefore, for a given degree of signal decorrelation between compounded images, the presented technique may yield stronger suppression of speckle compared to conventional angle and frequency compounding and strain compounding. We also observed that the masses in the fibroadenoma and cancer images were less compressible than surrounding tissues and speckle inside the lesion was quite persistent. While using level set boundary detection and the FOM may not be the best way of evaluating resolution improvement, it was considered an objective measure based on the imaging data used. The reason for selecting the level set method is that it is sensitive to the magnitude of the gradient field. If part of the boundary is missing or over-blurred, the level set will march over the weak gradient location and boundary detection fails; if the speckle is not well suppressed, the level set will be trapped at the local strong gradient near speckle. Therefore, using level set and FOM was one measure of how well the missing information is recovered and how well speckle has been suppressed. We also want to point out that the accuracy of the registration algorithm plays an important role in pixel compounding and out-of-plane motion in B-mode image acquisition also affects the quality of the final result. In conclusion, pixel compounding with the breast image-sequence acquired from breast compression, independently or as part of elasticity imaging, is a ready-to-implement technique that achieves improved B-mode imaging, and consequently, the possibility of a more comprehensive and accurate assessment of the target.  4. DISCUSSION AND CONCLUSIONS Our results suggest that pixel compounding can produce substantially higher quality images from the B-mode images obtained during breast compression. In ultrasound imaging, the PSF, which determines the image resolution and most of the low contrast detectability, is determined by the active aperture size and apodization settings. Generally, an operator has little knowledge of, or access to, these low level parameters in a given ultrasound system. During the breast compression, fine structures emerge or fade in image pixels due to tissue movement, the partial volume effect, and the change of the local ultrasound illumination. As a result, individual images often give slightly different views or even incomplete views of the imaged object. Acquisition of an image sequence provides a solution for a better imaging result in terms of noise reduction and displayed detail. As a matter of fact, there are two sources of speckle reduction in our technique. The first is similar to strain compounding proposed in [ 9 ] in which speckle reduction is achieved from combining somewhat speckle-decorrelated images. The second source of speckle reduction is the adaptive diffusion process [ 2 ], which is the second term in the right side of ( 8 ) as the diffusion equation (12) x ? m + 1 = x ? m + ? ? c [ D m ? c x ? m ] has been used for speckle reduction [ 2 ]. Therefore, for a given degree of signal decorrelation between compounded images, the presented technique may yield stronger suppression of speckle compared to conventional angle and frequency compounding and strain compounding. We also observed that the masses in the fibroadenoma and cancer images were less compressible than surrounding tissues and speckle inside the lesion was quite persistent. While using level set boundary detection and the FOM may not be the best way of evaluating resolution improvement, it was considered an objective measure based on the imaging data used. The reason for selecting the level set method is that it is sensitive to the magnitude of the gradient field. If part of the boundary is missing or over-blurred, the level set will march over the weak gradient location and boundary detection fails; if the speckle is not well suppressed, the level set will be trapped at the local strong gradient near speckle. Therefore, using level set and FOM was one measure of how well the missing information is recovered and how well speckle has been suppressed. We also want to point out that the accuracy of the registration algorithm plays an important role in pixel compounding and out-of-plane motion in B-mode image acquisition also affects the quality of the final result. In conclusion, pixel compounding with the breast image-sequence acquired from breast compression, independently or as part of elasticity imaging, is a ready-to-implement technique that achieves improved B-mode imaging, and consequently, the possibility of a more comprehensive and accurate assessment of the target.  Supplementary Material Bios. published with article  Supplementary Material Bios. published with article  Figures and Tables Fig. 1 Phantom test I: (a) An acquired image; (b) Pixel-compounded result. The boundary of the inclusion in (b) is more defined than in (a) and speckle is also significantly reduced, yielding better contrast-to-noise ratio. Fig. 2 Phantom test II: (a) An acquired image; (b) Pixel-compounded result showing improved image detail and contrast-to-noise ratio. Fig. 3 Phantom test I: A level set boundary detection on (a) acquired image and (b) pixel compounded image. Boundary detection fails in (a), as the ambiguous boundary cannot stop the level set expansion. The boundary in (b) is well delineated because the image quality has been improved substantially. Fig. 4 Phantom test II: similar to the observation of Fig. 3 , the level set algorithm failed to detect the ambiguous boundary in the acquired image (a), while the boundary was detected accurately in the pixel compounded image (b). Fig. 5 Cyst data: (a) An acquired image; (b) Pixel-compounded result. The boundaries, other details, and low contrast objects in (b) are more apparent. Note the ductlike patterns at the thin arrows and two dark areas at the thick arrows. Fig. 6 Fibroadenoma data: (a) An acquired image; (b) Pixel-compounded result. The lack of speckle reduction inside the mass is an indicator of its relative stiffness. Better delineation of some other tissue structures is indicated by the arrows. Fig. 7 Cancer data: (a) An acquired image and (b) Pixel-compounded result. Better delineation of details and improvement in contrast-to-noise ratio are observed throughout (b). The margins of the hypoechoic cancer are more apparent, depicted with the arrows, and there is a more apparent but subtle adjacent echogenic halo, which is a known characteristic of cancers. Table I FOM comparison between original and pixel compounded images Phantom data set 1 ( Fig. 3 ) Phantom data set 2 ( Fig. 4 ) Original Pixel compounding Original Pixel compounding Trial I 0.09 0.47 0.17 0.51 Trial II 0.19 0.66 0.15 0.51 Trail III 0.17 0.43 0.14 0.51 Mean / standard deviation 0.15/0.05 0.52/0.12 0.15/0.02 0.51/0 Table II CNR comparison between original and pixel compounded images CNR (Original image) CNR (pixel compounding) Phantom data set 1 ( Fig. 1 ) 0.45 0.81 Phantom data set 2 ( Fig. 2 ) 0.40 0.74  Figures and Tables Fig. 1 Phantom test I: (a) An acquired image; (b) Pixel-compounded result. The boundary of the inclusion in (b) is more defined than in (a) and speckle is also significantly reduced, yielding better contrast-to-noise ratio. Fig. 2 Phantom test II: (a) An acquired image; (b) Pixel-compounded result showing improved image detail and contrast-to-noise ratio. Fig. 3 Phantom test I: A level set boundary detection on (a) acquired image and (b) pixel compounded image. Boundary detection fails in (a), as the ambiguous boundary cannot stop the level set expansion. The boundary in (b) is well delineated because the image quality has been improved substantially. Fig. 4 Phantom test II: similar to the observation of Fig. 3 , the level set algorithm failed to detect the ambiguous boundary in the acquired image (a), while the boundary was detected accurately in the pixel compounded image (b). Fig. 5 Cyst data: (a) An acquired image; (b) Pixel-compounded result. The boundaries, other details, and low contrast objects in (b) are more apparent. Note the ductlike patterns at the thin arrows and two dark areas at the thick arrows. Fig. 6 Fibroadenoma data: (a) An acquired image; (b) Pixel-compounded result. The lack of speckle reduction inside the mass is an indicator of its relative stiffness. Better delineation of some other tissue structures is indicated by the arrows. Fig. 7 Cancer data: (a) An acquired image and (b) Pixel-compounded result. Better delineation of details and improvement in contrast-to-noise ratio are observed throughout (b). The margins of the hypoechoic cancer are more apparent, depicted with the arrows, and there is a more apparent but subtle adjacent echogenic halo, which is a known characteristic of cancers. Table I FOM comparison between original and pixel compounded images Phantom data set 1 ( Fig. 3 ) Phantom data set 2 ( Fig. 4 ) Original Pixel compounding Original Pixel compounding Trial I 0.09 0.47 0.17 0.51 Trial II 0.19 0.66 0.15 0.51 Trail III 0.17 0.43 0.14 0.51 Mean / standard deviation 0.15/0.05 0.52/0.12 0.15/0.02 0.51/0 Table II CNR comparison between original and pixel compounded images CNR (Original image) CNR (pixel compounding) Phantom data set 1 ( Fig. 1 ) 0.45 0.81 Phantom data set 2 ( Fig. 2 ) 0.40 0.74 