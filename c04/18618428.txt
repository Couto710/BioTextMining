Fitting stratified proportional odds models by amalgamating conditional likelihoods SUMMARY Classical methods for fitting a varying intercept logistic regression model to stratified data are based on the conditional likelihood principle to eliminate the stratum-specific nuisance parameters. When the outcome variable has multiple ordered categories, a natural choice for the outcome model is a stratified proportional odds or cumulative logit model. However, classical conditioning techniques do not apply to the general K -category cumulative logit model ( K > 2) with varying stratum-specific intercepts as there is no reduction due to suffciency; the nuisance parameters remain in the conditional likelihood. We propose a methodology to fit stratified proportional odds model by amalgamating conditional likelihoods obtained from all possible binary collapsing of the ordinal scale. The method allows for categorical and continuous covariates in a general regression framework. We provide a robust sandwich estimate of the variance of the proposed estimator. For binary exposures, we show equivalence of our approach to the estimators already proposed in the literature. The proposed recipe can be implemented very easily in standard software. We illustrate the methods via three real data examples related to biomedical research. Simulation results comparing the proposed method with a random effects model on the stratification parameters are also furnished.  1 Introduction Models for ordinal data started receiving attention in the 1960s and 1970s ([ 1 ], [ 2 ]). However, the most popular model for ordinal data was inspired by [ 3 ] by modeling the log odds corresponding to the cumulative probabilities, called the cumulative logits . Stratified ordinal data often arise in sociological and clinical studies, with the level of stratification depending on the study design. An extreme degree of stratification occurs when one collects matched pair data which frequently arise in ‘before and after’ experiments, in the context of Rasch’s item response model [ 4 ] with the object to describe ‘subject-specific’ rather than ‘population averaged’ effects. The individual or the matched set then acts as a stratum. On the other hand, modest degree of stratification is seen to be present in frequency matched data and data from multi-center clinical trials. In many instances, the outcomes are measured in ordered categories: such as degree of seriousness of an injury, stages of progression of a disease, or the extent of relief due to treatments. A proper statistical analysis should account for stratum heterogeneity in the ordinal outcome model used for such studies in order to avoid the risk of biased and inconsistent estimation. In inference with matched pair data with dichotomous responses, conditioning on the complete suffcient statistics for the stratum specific parameters eliminates these nuisance parameters from the likelihood. The maximum likelihood estimates (MLE) obtained from the resultant conditional likelihood are consistent and effcient in the sense of ([ 5 ], [ 6 ]). However in a stratified proportional odds model there is no such reduction due to suffciency ([ 7 ], [ 8 ], [ 9 ]). When the data is sparse, random effects and Bayesian approach has problems with convergence ([ 10 ], [ 11 ]). A naive inference procedure which tries to estimate all parameters from directly maximizing the unconditional likelihood produces biased and inconsistent estimates of the parameters of interest. On the other hand, ignoring the stratification effects when they are present, e.g., using a constant intercept model across strata, is also known to severely underestimate the cumulative odds ratios [ 12 ]. McCullagh ([ 7 ], [ 8 ]) and Agresti and Lang [ 9 ] (referred as AL from now on) propose a novel strategy by simultaneously fitting conditional models to all possible binary collapsings of the ordinal response. McCullagh [ 8 ] considers this approach for a binary covariate whereas AL consider a categorical covariate. The maximum likelihood estimation process in AL involves an improved Newton-Raphson algorithm for a class of generalized log-linear models and is based on the cell counts of the collapsed table. The purpose of this paper is to extend this idea to a general ordinal regression set-up with any set of covariates, categorical or continuous, and provide an alternative simple fitting procedure for obtaining the parameter estimates and their standard errors. For a binary exposure, we illustrate the equivalence of our approach to the one proposed in AL and also to a Mantel-Haenszel type estimator proposed in [ 12 ], though each of them are conceived from different standpoints. We call our method amalgamated conditional logistic regression (ACLR). It is also natural to think about an alternative mixed effects approach with a random distribution on the stratum-specific nuisance parameters while fitting a stratified proportional odds model [ 13 ]. The proposed ACLR method has certain advantages over the random effects approach. With finely stratified data, misspecifying the random effects distribution may cause potential bias in the parameter estimates. For a stratified logistic regression model with matched pair data, necessary and suffcient conditions on the random effects distribution for consistency of the estimates from the marginal likelihood is known [ 14 ]. However, an analogous result is not known for the cumulative logit model for matched pair data. The ACLR method we propose, is more robust in the sense that it does not make any assumptions on the distribution of the nuisance parameters. Computationally, our method is simpler than a random effects model which requires integration of the random stratification parameters with respect to their stochastic nuisance distributions to obtain the marginal likelihood of data. Since the integral involved is not in closed form, the integrated likelihood is approximated by Gauss-Hermite quadrature and then optimized in terms of the unknown model parameters [ 15 ]. However, the mixed effects approach typically has better mean-squared-error properties than ACLR and provides smaller standard errors for the parameter estimates. We compare and contrast these plausible alternative strategies with the proposed ACLR method through several data examples and a simulation study. The first example we consider is a multi-center randomized clinical trial with center-specific heterogeneity. The outcome of interest is doctor’s evaluation of asthma patients, ordered into four categories based on severity of the disease; the goal is to characterize treatment effects after adjusting for covariates. The second is an item response dataset, part of the clinical trial data used in the first example. Here each individual has two responses: a self-evaluation score of asthma severity, and another score from a medical practitioner, both ordered into four categories. The goal is to characterize the differences in self assessment and physician’s assessment. The third example shows the application of these approaches to analyze pair-matched case-control data where the disease states have multiple ordered categories. The rest of the paper is organized as follows. In Section 2 we present the model, notation and the proposed methods under random sampling of individuals. In Section 3 we consider the special case of a single binary covariate and show the equivalence of our approach with alternative approaches. We also discuss two special cases: (a) the generalized item response model as discussed in AL and (b) matched case-control data with multiple disease states. Section 4 presents real data examples whereas Section 5 contains a small scale simulation study under varying distribution of the stratification parameters.  2 The stratified proportional odds model One of the most popular models for ordinal data was proposed by [ 3 ] by modeling the log odds corresponding to the cumulative probabilities, called the cumulative logits described as follows. Let us consider stratified data with an ordinal response. Let Y ij denote the response for the j th observation in the i th stratum, where j = 1, … , N i and i = 1, … , N . Also, let Y ij be a K -category ordinal variable with categories scaled from 0, 1 … , K ? 1. Let X ij denote the observed vector of covariates for observation j in stratum i . The cumulative logit model is given by (1) logit [ P ( Y i j ? r ? X i j ) ] = ? r i + ? T X i j , j = 1 , ? , N i , i = 1 , ? , N , r = 1 , ? , K ? 1 , where ? 1 i > ? 2 i > … > ? K ?1, i for all i = 1, … , N , and P ( Y ij ? 0) = 1. The parameters { ? ri } are usually nuisance parameters of little interest. The total number of these nuisance parameters increases in direct proportion with the sample size for the generalized Rasch model considered in AL. For other types of stratified designs, like the multi-center clinical trial data we consider in Example 1, the number of nuisance parameters (centers) does not increase with sample size. However, the sparsity of the observations in each stratum may cause potential problems in maximum likelihood estimation. The above model applies simultaneously to all K ? 1 cumulative probabilities, and it assumes an identical effect ? of the predictors for each cumulative probability. This particular type of stratified cumulative logit model, with the p -dimensional exposure effect ? the same for all r , is often referred to as a stratified proportional odds model [ 3 ]. When K = 2, the stratified proportional odds model ( 1 ) reduces to a stratified logistic regression model. One can then eliminate the nuisance parameters ? ri using conditional maximum likelihood (ML). However, as mentioned in the introduction, the conditional ML method can not be applied to the proportional odds model ( 1 ) with K > 2, because there are no reduced suffcient statistics for the nuisance parameters ? ri . In many applications, ? ri is modelled as an additive effect of the threshold parameters ? r and the stratum specific parameters ? i , i.e., ? ri = ? r + ? i . Note that this is an alternative parametrization of the generalized Rasch model considered in AL. For each r (= 1, … , K ?1), the proportional odds model is a logistic regression model. If we consider all possible collapsings of the ordinal response Y ij into a binary scale (? r , < r ), each stratum has K ? 1 such collapsed versions which are dependent within strata. The estimator obtained from each separate collapsing for a given r is unbiased for ? , but not effcient. This paper proposes a conditional approach by first naively treating the K ?1 different collapsed versions within a single stratum as independent. That is, the original stratified dataset with N strata can be extended into a larger stratified dataset with N × ( K ?1) strata. The extended stratified dataset has only binary responses. Therefore, the usual conditional ML method can be used and the conditional ML estimators for ? for each collapsing, and for a given r , remain consistent. The naive working independence assumption has been used in many problems including generalized estimating equations [ 16 ], in forming the simple estimate of the ordinal odds ratio for matched pairs [ 9 ], and the ordinal Mantel-Haenszel estimator [ 12 ]. Table 1 presents how a single stratum with ordinal responses from 0-3 and a single continuous covariate can be collapsed into three different strata each with binary response. Let us now describe our notation and model structure. Let M ri be the number of observations in stratum i having Y ij ? r (i.e., M r i = ? j = 1 N i I ( Y i j ? r ) ). The conditional likelihood for the r th collapsing in stratum i is L r i = exp ( ? T S r i ) ? q i ? ? r i exp ( ? T q i ) , where S r i = ? j = 1 N i X i j I ( Y i j ? r ) , is the sum of covariate vectors over M ri observations; and ? ri is a collection of all possible sum vectors of the form X il 1 + … + X ilMri , in which ( l 1, … , l Mri ) is a subset of size M ri from (1, … , N i ) chosen without replacement. Therefore, the cardinality of ? ri is ( N i M r i ) . The conditional likelihood L ri is simply the probability of having the observed data, given that there are exactly M ri observations having Y ij ? r . In a finite population sampling framework, L ri could also be interpreted as the probability that a random sample of size M ri is selected from the finite population of size N i with probability proportional to exp( ? ? q i ) where q i is the sum of the X ij ’s selected in the sample. Under the naive independence assumption for the extended data set, the conditional likelihood over all strata and all collapsings is (2) L = ? i = 1 N ? r = 1 K ? 1 exp ( ? T S r i ) ? q i ? ? r i exp ( ? T q i ) . The pseudo-score function can thus be expressed as (3) U ( ? ) = ( ? log L ( ? ) ? ? ) p × 1 = ? i = 1 N ? r = 1 K ? 1 ( S r i ? ? q i ? ? r i q i exp ( ? T q i ) ? q i ? ? r i exp ( ? T q i ) ) = ? i = 1 N ? r = 1 K ? 1 U r i ( ? ) , where p denotes the length of ? . Therefore, the estimates of ? can be obtained by fitting conditional logistic regression (CLR) to the extended stratified dataset using any standard software implementing CLR. It produces the asymptotic variance-covariance matrix I having the form I = ( ? U ( ? ) ? ? ) p × p ? 1 = ( ? i = 1 N ? r = 1 K ? 1 D r i ) ? 1 . The ( s, t )th element in D ri (a p × p matrix) is (4) ? ? 2 log L r i ( ? ) ? ? s ? ? t = ( ? q i ? ? r i q i s q i t exp ( ? T q i ) ? q i ? ? r i exp ( ? T q i ) ) ? ( ? q i ? ? r i q i s exp ( ? T q i ) ? q i ? ? r i exp ( ? T q i ) ) ( ? q i ? ? r i q i t exp ( ? T q i ) ? q i ? ? r i exp ( ? T q i ) ) where q i = ( q i 1, … , q ip ) T , is a p × 1 vector representing the sum of the observed covariate vectors in stratum i . The estimate of the asymptotic variance-covariance matrix I furnished by any standard CLR fitting program is based on the observed Hessian matrix ( ? i = 1 N ? r = 1 K ? 1 D ^ r i ) ? 1 with ? ^ replacing ? in ( 4 ), where ? ^ is the solution to the pseudo-score equations obtained by setting U ( ? ) = 0. Note that the ACLR estimate of ? is consistent under sparse data situations as due to the proportional odds structure each of the collapsed model is a stratified logistic model for which conditional ML estimates are known to be consistent. For details of a similar argument, see [ 17 ]. The estimator of the asymptotic variance and covariance matrix produced by the above amalgamation of conditional ML method is not consistent, as the extended dataset has strata which are dependent across different collapsings. We propose a sandwich estimator of the variance-covariance matrix based on the following well-known result widely used in the generalized estimating equations literature. Suppose that ? ^ n is a solution to the estimating equation G n ( ? ) = 1 n ? i = 1 n G ( ? , Y i ) = 0 . Then ? ^ n ? p ? , and n ( ? ^ n ? ? ) ? d N p ( 0 , A ? 1 B ( A T ) ? 1 ) , where A = A ( ? ) = E [ ? ? ? G ( ? , Y ) ] and B = B ( ? ) = E [ G ( ? , Y ) G ( ? , Y ) T ] = cov { G ( ? , Y ) } . Using the above result, an empirical estimate for the sandwich variance is obtained as, c o ~ v ( ? ^ ) = ( ? i = 1 N ? r = 1 K ? 1 D ^ r i ) ? 1 [ ? i = 1 N cov ( ? r = 1 K ? 1 U r i ( ? ^ ) ) ] ( ? i = 1 N ? r = 1 K ? 1 D ^ r i ) ? 1 , where U ri ( ? ) is defin ed in ( 3 ). Replacing cov ( ? r = 1 K ? 1 U r i ( ? ^ ) ) by the empirical covariance matrix yields (5) c o ~ v ( ? ^ ) = ( ? i = 1 N ? r = 1 K ? 1 D ^ r i ) ? 1 [ ? i = 1 N ( ? r = 1 K ? 1 U r i ( ? ^ ) ) ( ? r = 1 K ? 1 U r i ( ? ^ ) ) T ] ( ? i = 1 N ? r = 1 K ? 1 D ^ r i ) ? 1 . Remark 1: Note that, instead of ignoring the correlation of the collapsings within a strata, we modify the correction term in the middle of the usual sandwich estimator by considering the contribution to the score function from the sums over the collapsings, the sums being independent across strata. Remark 2: The pseudo-score equation ( 3 ) is evidently not the optimum estimating function for estimating. Following [ 8 ] it is conjectured that the effcient score function should be a weighted combination of the CLR score functions corresponding to each collapsing of the data, namely ? i = 1 N ? r = 1 K ? 1 w r i ( ? ) U r i ( ? ) . Obtaining the semi-parametric effcient score function in this problem is an interesting open question in its own right. We correct for possible small sample bias in the sandwich estimator following [ 18 ]. Note that the score function in ( 3 ) can be expressed in the form U ( ? ) = ? i = 1 N ? r = 1 K ? 1 ( S ( r i ) ? p r i ( ? ) ) , where, p r i ( ? ) ) = ? q i ? ? r i q i exp ( ? T q i ) ? q i ? ? r i exp ( ? T q i ) . Based on a second-order Taylor’s expansion of the score function about ? ^ , with details as given in [ 18 ], we form a set of bias corrected scores for each strata, and for each collapsing as U r i ? ( ? ^ ) = Diag { I p ? D ^ r i ( ? i = 1 N ? r = 1 K ? 1 D ^ r i ) ? 1 } ? 1 ? 2 ( S r i ? p r i ( ? ^ ) ) . The corrected empirical covariance which now replaces the middle term in ( 5 ) is given by (6) ? i = 1 N ( ? r = 1 K ? 1 U r i ? ( ? ^ ) ) ( ? r = 1 K ? 1 U r i ? ( ? ^ ) ) T . A small-scale simulation study in Table 2 presents a comparison of the variance estimator in ( 5 ), the bias corrected version ( 6 ) and the actual observed variance of the estimators across many replications under certain model settings. Since the bias correction seems to make very minor differences in the variance approximation, we continue to use the variance estimator obtained from ( 5 ). However, small sample bias in the sandwich estimator could be an important issue if the simulation designs were “unbalanced” in the sense of [ 19 ]; that is, if different number of clusters contribute to the estimation of the different parameters of interest, then one would prefer to use the bias-corrected estimator. The Wald-type ratios ? ^ k ? { se ( ? ^ k ) } are approximately normally distributed test statistics for testing H 0 : ? k = 0. Figure 1 provides a sampling distribution of this test statistic for four different simulation settings, which will be discussed later in Section 5.  3 Special case: matched pair data with one binary exposure Consider the simple case of matched pair data with a single binary exposure and ordinal outcome. Let Y ij , i = 1, … , N , j = 1, 2, denote the response category of j -th observation in matched set i . For a typical “before” and “after” experiment, the matched set will be the subject itself. Thus Y ij is a K -category ordinal variable with categories scaled from 0, … , K ? 1, where the category 0 denotes the baseline response category. Let X ij denote the binary exposure having values 0 or 1. In Rasch’s item response model considered in AL, Y ij are repeated ordinal responses on the same subject whereas X ij is the indicator variable corresponding to an item. In our conditional likelihood formulation, only matched sets with discordant Y and X observations contribute to the likelihood, thus we restrict attention to those sets only. To this end, without loss of generality, let Y i 1 be the response corresponding to X = 1, i.e. X i 1 ? 1 and Y i 2 be the response corresponding to X = 0, i.e. X i 2 ? 0. For a particular strata, let Y i 1 = s and Y i 2 = t with s, t = 0, … , K ? 1, s ? t . Then for the r -th collapsing with the new binary response as I ( Y ij ? r ), and for s < t , the likelihood contribution of the i -th strata can be expressed as: L r i = 1 for r ? s and r ? t + 1 = 1 1 + exp ( ? ) for s + 1 ? r ? t . If s > t , the likelihood contribution of i -th stratum in r -th collapsing changes to L r i = 1 for r ? t and r ? s + 1 = exp ( ? ) 1 + exp ( ? ) for t + 1 ? r ? s . Thus, the entire likelihood in ( 2 ) can be represented as L = ? s < t [ 1 1 + exp ( ? ) ] ( t ? s ) n s t ? s > t [ 1 1 + exp ( ? ) ] ( s ? t ) n s t , where n st is the number of matched sets with Y i 1 = s and Y i 2 = t . Taking derivatives and solving the score equations, the estimator reduces to (7) ? = log ( ? s > t ( s ? t ) n s t ? s < t ( t ? s ) n s t ) . Agresti and Lang [ 9 ] derive an asymptotic variance of this estimator based on the multinomial distribution of the counts n st which coincides with our sandwich estimator in ( 5 ) upon simplification, and is given by (8) v a ^ r ( ? ^ ) = ? i < j ( j ? i ) 2 n i j [ ? i < j ( j ? i ) n i j ] 2 + ? i < j ( i ? j ) 2 n i j [ ? i < j ( i ? j ) n i j ] 2 . Liu and Agresti [ 12 ] prove that an alternative Mantel-Haenszel approach to matched pair data with ordinal response also provides the same estimator and estimated asymptotic variance. These equivalences in special cases are reassuring. However, compared to the other methods, our method provides the most flexible regression model which can incorporate any number of discrete and continuous covariates. Remark 3: Another application of this method is for matched case-control data with multiple ordinal disease states [ 10 ]. For 1:1 matched dataset, which has a very similar likelihood structure as Rasch’s item response model, let, without loss of generality Y i 1 be the case observation, which could take values in 1, … , K ? 1 and Y i 2 ? 0, denote the control observation. The conditional likelihood ( 2 ) simplifies to L = ? i = 1 N { exp ( ? X i 1 ) ? j = 1 2 exp ( ? X i j ) } Y i 1 . The pseudo-score function is derived as U ( ? ) = ? i = 1 N Y i 1 ( X i 1 ? ? j = 1 2 X i j exp ( ? X i j ) ? j = 1 2 exp ( ? X i j ) ) . The expression within parentheses is identical to the score function for standard CLR with binary response. For ordinal response, these score functions are simply weighted by the ordinal value for Y i 1. The empirical sandwich variance estimate as in ( 5 ) becomes ( ? i = 1 N Y i 1 2 [ X i 1 ? ? j = 1 2 X i j exp ( ? X i j ) ? j = 1 2 exp ( ? X i j ) ] 2 ) × ( ? i = 1 N Y i 1 [ ? j = 1 2 X i j exp ( ? X i j ) ] 2 ? [ ? j = 1 2 exp ( ? X i j ) ] [ ? j = 1 2 X i j 2 exp ( ? X i j ) ] [ ? j = 1 2 exp ( ? X i j ) ] 2 ) ? 2 . Again, for binary X -s, upon simplification of the above two expressions, one retrieves the Agresti-Lang and Liu-Agresti estimators of ? .  4 Examples In this section, we illustrate our methods for three datasets, representing common situations where stratified ordinal data may arise in practice. We consider several possible analysis strategies, along with the ACLR method. We consider a random effects model (REM) with ? i ~ i i d N ( ? ? , ? ? 2 ) akin to the methods proposed by [ 15 ] and implemented by SAS procedure NLMIXED. We furnish the unconditional MLE assuming distinct fixed effects ? i for each stratum. The unconditional MLE is subject to classic Neyman-Scott phenomenon [ 20 ] in presence of fine stratification and often fails to converge. An analysis of the data ignoring the ordinal categories and running a usual CLR analysis with a simple dichotomy of zero vs non-zero responses is also presented (labeled as Binary CLR). Apart from these conditional models, one could alternatively fit a marginal response model to stratified ordinal data using a generalized estimating equations approach. As pointed out in [ 21 ], the GEE approach can account for the correlation between observations within a strata through robust variance estimation, but the point estimate is exactly same as obtained in an unmatched analysis, treating the observations independent. Indeed, using the polr option in R package VGAM, we noticed that fitting simple constant intercept proportional odds logistic regression model to the data, ignoring stratification, produces identical point estimate as the GEE estimates with slightly different standard errors. We include the GEE estimates from the marginal model for our data analysis. However, we keep in mind that the GEE estimates reflect a population-averaged effect of the covariate whereas the random effects and the ACLR method describe the change in the risk of outcome for a stratum when exposure status changes within the stratum. Thus they are not directly comparable. EXAMPLE 1: Multi-center clinical trial on severity of Asthma We use a dataset provided by Merck Research Laboratories for a double-blind, parallel-group, preliminary clinical study conducted at 21 centers. Patients suffering from asthma were randomly assigned to 3 different treatments (2mg active drug, 10mg active drug, and placebo). At the end of the study, the doctors described the patients’ change in condition using an ordinal scale from better to worse ( 1 to 4 ). Table 3 shows the results of the doctors’ evaluations associated with the treatments and is presented as 21 separate 3 × 4 tables. Such a study might use many clinics because of the time it takes each clinic center to recruit patients. Therefore, the three-way table might then have many strata but few observations per stratum, leading to a sparse data set with ordinal outcomes. For this particular dataset, each clinic has from 5 to 14 subjects, leading to a total of 197 subjects in the study. We analyze the dataset by different methods with treatment as the factor of interest but with several other covariates like age, height, weight and sex in the model. The results of this analysis are presented in Table 4 . For this dataset, though there are certain minor numerical differences, all the methods provide very similar inference regarding the treatment effect and suggest that higher drug doses tend to be negatively associated with worse symptoms (higher end of the ordinal scale). Using the ACLR method, the 2mg dose has a log cumulative OR of ?0.72 whereas the 10mg dose has log cumulative OR of ?1.07. This suggests, for each center, the estimated odds that the evaluation score for the 2mg drug falls below any fixed level is exp(0.72)=2.05 times the estimated odds of placebo. Whereas the estimated odds that the evaluation score for the 10mg dose falls below any fixed level is exp(1.07)=2.91 times the estimated odds of placebo. Thus the 10mg dose has higher efficacy in providing relief to asthma patients. The estimates of the unknown parameters corresponding to the random effects distribution are ? ^ ? = 4.8 and ? ^ ? = 0.43 , suggesting a reasonably small center to center variability, which explains why estimates from unmatched GEE analysis is similar to ACLR and REM. Note that a naive dichotomization of data, ignoring the ordinal scale, provides quite imprecise point estimates. This loss of efficiency due to ignoring the full ordinal scale is also noted in [ 22 ]. EXAMPLE 2: Item response data on asthma severity score In the same dataset as described in Example 1, each of the 197 subjects had two measurements on asthma severity scores. In addition to the assessment by a doctor, each patient provided a self-evaluated asthma severity score. Treating each subject as a strata in which two measurements are available, we would like to examine the response differences, that is the differences between self-reported score versus physician’s evaluation. For simplicity, we ignore presence of other covariates in the model and stratification effect due to centers, inclusion of which will lead to a more complex random effects structure with subjects effects nested within center effects. To this end, we can fit the cumulative Rasch model in AL (9) logit [ P ( Y i j ? r ? X i j ) ] = ? r + ? i + ? j , r = 1 , ? , K ? 1 , i = 1 , ? , N , where j = 1, 2, and we use the constraint ? 1 = ? 1 ? 0. There are 197 subject-specific nuisance parameters in this situation. In our analysis, the first response is physician reported score and the second response is individual reported score, thus there is a single parameter of interest, ? 2 = ? , say, to be estimated from data. This cumulative odds ratio ? reflects the odds of having scores on the higher end of the scale for self-reporting when compared to physician’s evaluation. For this situation, in Table 5 , we notice that the estimate of ? is 1.56 by our method, which is close to the estimate provided by REM. This suggests that self reported scores tend to be reported towards the higher (worse) end of the scale. When compared to doctor’s evaluation, self-reported responses have an odds of exp(1.56) = 4.76 of being on the higher end of the scale. However, note that the unmatched GEE analysis with constant stratum effect highly underestimates ? , whereas the unconditional MLE fails to converge. The estimates of the parameters corresponding to the random effects distribution turn out to be ? ^ ? = 3.74 and ? ^ ? = 3.42 , reflecting that there is substantial between subject heterogeneity in this dataset. The analysis with a naive dichotomization of the scale using binary CLR again loses efficiency when compared to the ordinal models. EXAMPLE 3: Matched case-control data with multiple ordered disease states We consider a matched case-control dataset coming from a low birth weight study conducted by the Baystate Medical Center in Springfield, Massachusetts. The dataset is discussed in [ 23 ] and is used as an illustrative example in Chapter 7. Low birth weight, defined as birth weight less than 2500 grams, is a cause of concern for a newborn as infant mortality and birth defect rates are very high for low birth weight babies. The data was matched according to the age of the mother. A woman’s behavior during pregnancy (smoking habits, diet, prenatal care) can greatly alter the chances of having a low birth-weight baby. The goal of the study was to determine whether these variables were “risk factors” in the clinical population served by Baystate Medical Center. Using the actual birth weight observations, we divided the cases, namely, the low birth-weight babies into two categories, very low (weighing less than 2000 gms) and low (weighing between 2000 to 2500 gms) and tried to assess the impact of smoking habits of mother (smoker vs non-smoker) on the chance of falling in the two low birth-weight categories. We consider two datasets based on this low birth-weight study with two different matching ratios: a 1:1 matched dataset with 56 matched sets and a 1:3 matched dataset with 29 matched sets. Analysis of the 1:1 and 1:3 datasets are presented in Table 6 , where the parameter ? represents the smoking effect for the model. In this situation, we notice that for 1:1 dataset, the estimates from our method and REM differ substantially, with REM estimates being identical to the ones obtained by unmatched analysis of data. The parameters of the random effects distribution were estimated as ? ^ ? = ? 0.35 and ? ^ ? = 4.9 × 10 ? 6 . The point estimates obtained by our method and binary CLR are higher than REM estimates. For 1:3 dataset, both methods provide similar inference. This difference between REM and ACLR from 1:1 to 1:3 matching is most likely due to the degree of stratification, as will be noted in our simulation study. The effect of smoking is more pronounced in our method although all methods suggest elevated odds of having low birth-weight baby for a smoker mother. Figure 2 summarizes the 95% Wald CI of the regression parameter ? for all three examples. Note that the width of CI using GEE and REM is often slightly less than ACLR as they use all observations, not only discordant observations in each stratum and thus gain precision. The naive binary CLR produces much wider confidence interval compared to the ordinal methods.  EXAMPLE 1: Multi-center clinical trial on severity of Asthma We use a dataset provided by Merck Research Laboratories for a double-blind, parallel-group, preliminary clinical study conducted at 21 centers. Patients suffering from asthma were randomly assigned to 3 different treatments (2mg active drug, 10mg active drug, and placebo). At the end of the study, the doctors described the patients’ change in condition using an ordinal scale from better to worse ( 1 to 4 ). Table 3 shows the results of the doctors’ evaluations associated with the treatments and is presented as 21 separate 3 × 4 tables. Such a study might use many clinics because of the time it takes each clinic center to recruit patients. Therefore, the three-way table might then have many strata but few observations per stratum, leading to a sparse data set with ordinal outcomes. For this particular dataset, each clinic has from 5 to 14 subjects, leading to a total of 197 subjects in the study. We analyze the dataset by different methods with treatment as the factor of interest but with several other covariates like age, height, weight and sex in the model. The results of this analysis are presented in Table 4 . For this dataset, though there are certain minor numerical differences, all the methods provide very similar inference regarding the treatment effect and suggest that higher drug doses tend to be negatively associated with worse symptoms (higher end of the ordinal scale). Using the ACLR method, the 2mg dose has a log cumulative OR of ?0.72 whereas the 10mg dose has log cumulative OR of ?1.07. This suggests, for each center, the estimated odds that the evaluation score for the 2mg drug falls below any fixed level is exp(0.72)=2.05 times the estimated odds of placebo. Whereas the estimated odds that the evaluation score for the 10mg dose falls below any fixed level is exp(1.07)=2.91 times the estimated odds of placebo. Thus the 10mg dose has higher efficacy in providing relief to asthma patients. The estimates of the unknown parameters corresponding to the random effects distribution are ? ^ ? = 4.8 and ? ^ ? = 0.43 , suggesting a reasonably small center to center variability, which explains why estimates from unmatched GEE analysis is similar to ACLR and REM. Note that a naive dichotomization of data, ignoring the ordinal scale, provides quite imprecise point estimates. This loss of efficiency due to ignoring the full ordinal scale is also noted in [ 22 ].  EXAMPLE 2: Item response data on asthma severity score In the same dataset as described in Example 1, each of the 197 subjects had two measurements on asthma severity scores. In addition to the assessment by a doctor, each patient provided a self-evaluated asthma severity score. Treating each subject as a strata in which two measurements are available, we would like to examine the response differences, that is the differences between self-reported score versus physician’s evaluation. For simplicity, we ignore presence of other covariates in the model and stratification effect due to centers, inclusion of which will lead to a more complex random effects structure with subjects effects nested within center effects. To this end, we can fit the cumulative Rasch model in AL (9) logit [ P ( Y i j ? r ? X i j ) ] = ? r + ? i + ? j , r = 1 , ? , K ? 1 , i = 1 , ? , N , where j = 1, 2, and we use the constraint ? 1 = ? 1 ? 0. There are 197 subject-specific nuisance parameters in this situation. In our analysis, the first response is physician reported score and the second response is individual reported score, thus there is a single parameter of interest, ? 2 = ? , say, to be estimated from data. This cumulative odds ratio ? reflects the odds of having scores on the higher end of the scale for self-reporting when compared to physician’s evaluation. For this situation, in Table 5 , we notice that the estimate of ? is 1.56 by our method, which is close to the estimate provided by REM. This suggests that self reported scores tend to be reported towards the higher (worse) end of the scale. When compared to doctor’s evaluation, self-reported responses have an odds of exp(1.56) = 4.76 of being on the higher end of the scale. However, note that the unmatched GEE analysis with constant stratum effect highly underestimates ? , whereas the unconditional MLE fails to converge. The estimates of the parameters corresponding to the random effects distribution turn out to be ? ^ ? = 3.74 and ? ^ ? = 3.42 , reflecting that there is substantial between subject heterogeneity in this dataset. The analysis with a naive dichotomization of the scale using binary CLR again loses efficiency when compared to the ordinal models.  EXAMPLE 3: Matched case-control data with multiple ordered disease states We consider a matched case-control dataset coming from a low birth weight study conducted by the Baystate Medical Center in Springfield, Massachusetts. The dataset is discussed in [ 23 ] and is used as an illustrative example in Chapter 7. Low birth weight, defined as birth weight less than 2500 grams, is a cause of concern for a newborn as infant mortality and birth defect rates are very high for low birth weight babies. The data was matched according to the age of the mother. A woman’s behavior during pregnancy (smoking habits, diet, prenatal care) can greatly alter the chances of having a low birth-weight baby. The goal of the study was to determine whether these variables were “risk factors” in the clinical population served by Baystate Medical Center. Using the actual birth weight observations, we divided the cases, namely, the low birth-weight babies into two categories, very low (weighing less than 2000 gms) and low (weighing between 2000 to 2500 gms) and tried to assess the impact of smoking habits of mother (smoker vs non-smoker) on the chance of falling in the two low birth-weight categories. We consider two datasets based on this low birth-weight study with two different matching ratios: a 1:1 matched dataset with 56 matched sets and a 1:3 matched dataset with 29 matched sets. Analysis of the 1:1 and 1:3 datasets are presented in Table 6 , where the parameter ? represents the smoking effect for the model. In this situation, we notice that for 1:1 dataset, the estimates from our method and REM differ substantially, with REM estimates being identical to the ones obtained by unmatched analysis of data. The parameters of the random effects distribution were estimated as ? ^ ? = ? 0.35 and ? ^ ? = 4.9 × 10 ? 6 . The point estimates obtained by our method and binary CLR are higher than REM estimates. For 1:3 dataset, both methods provide similar inference. This difference between REM and ACLR from 1:1 to 1:3 matching is most likely due to the degree of stratification, as will be noted in our simulation study. The effect of smoking is more pronounced in our method although all methods suggest elevated odds of having low birth-weight baby for a smoker mother. Figure 2 summarizes the 95% Wald CI of the regression parameter ? for all three examples. Note that the width of CI using GEE and REM is often slightly less than ACLR as they use all observations, not only discordant observations in each stratum and thus gain precision. The naive binary CLR produces much wider confidence interval compared to the ordinal methods.  5 Simulation Study In the above three data analysis examples, we saw similarities and differences among our method and other approaches. Since in a real data situation, one is not certain about the truth regarding parameter values, we designed a simulation study which explores, under different sample sizes, the performance of our method over an array of distributions for the stratum effects. As pointed out by a referee, the bias due to misspecification of theproportional odds structure should also be evaluated since it is a restrictive modeling assumption. In a given real example, the validity of the proportional odds assumption should first be verified by available diagnostic tools and goodness of fit statistics ([ 23 ], [ 24 ]) before using the proposed methods. However, in the present simulation study, we assume that the proportional odds model holds and only evaluate the variation across distributions governing the nuisance parameters. In particular, we consider the following four settings with (i) ? i ? ? 0 ?3, ( ii ) ? i ~ i i d N ( ? 3 , 2 2 ) , ( iii ) ? i ~ i i d 0.4 N ( ? 3.5 , 0.4 2 ) + 0.6 N ( ? 2.5 , 0.4 2 ) and (iv) ? i following a mixture of discrete and continuous distribution, assuming the constant value of ?3.5 with probability 0.4 and following a N (?2.5, 0.42) distribution with probability 0.6. The true values of the category-specific threshold parameters ? 1, ? 2 and ? 3 were chosen as 2.5, 1.4 and 0.5 respectively in each simulation setting. We consider two experimental scenarios, reflecting different study designs. In Table 7 we consider a moderately stratified data situation with 5 observations in each strata, responses having four ordinal values and with two covariates, one binary ( p = 0.4) and the other continuous, from a N(1,2) distribution. The corresponding regression coeffcients are set at ? 1=?0.5 and ? 2 = 1.0 respectively. In Table 8 , we generate highly stratified item response data with two repeated responses per subject (each response having four ordinal categories) with the cumulative log odds ratio on the “diffculty” scale being ? = 0.5. Tables 7 and 8 present the results with bias, MSE and the coverage probability of 95% Wald-type confidence intervals corresponding to the different estimates. Note that in the constant stratum effect situation (i), all ordinal methods perform comparably, with REM and GEE being more precise than ACLR. However, in the varying stratum effect situation, with a normal distribution on the stratum effects as in (ii), our method and REM stand superior to GEE in terms of bias and coverage probability. This is expected as GEE essentially provides an unmatched analysis of the data which attenuates the effect of the covariate towards the null value. REM appears to have a slight edge over ours in terms of MSE for smaller number of strata. In spite of small MSE, the GEE method accrues bias in simulation setting (ii), and has poor coverage probability which is again as expected. With a non-normal distribution as generated in (iii) and (iv), our method has less bias than REM for the highly stratified item response dataset in Table 8 , and the bias in our method goes away with increase in number of strata, whereas the bias due to model misspecification on { ? i } remain in REM estimates even for relatively large number of strata. With more observations per stratum, the REM estimates become less biased under the non-normal distributions in (iii) and (iv) as noted in Table 7 . To summarize, our proposed ACLR method appears to be more robust to variations in stratum-specific distributions in highly sparse data situations. This can be seen for the item response data especially with a large number of strata, leading to many nuisance parameters. The proposed ACLR method also has reasonably good MSE properties for sparse data situations. One can notice the inadequacy of the GEE model or unmatched analysis for estimating ? in the simulation settings with ? i truly varying. The lack of efficiency due to naive dichotomization in binary CLR model is also evident when compared to the ordinal models. The GEE and REM models use all the observations in each stratum, not only the discordant observations as in ACLR. As a result they often have higher precision. But when striking a compromise between robustness and precision, the ACLR approach appears to be a reasonable choice under varying stratification heterogeneity. Remark 4: In simulation studies, the results of which are not included in the current text, we noticed two additional advantages of the ACLR method over the REM approach that is worth mentioning. If the intercept parameters ? ri in equation ( 1 ) do not have the additive structure, ? ri = ? r + ? i , but have a multiplicative (or some other) structure, the REM method incurs bias, the ACLR methods is not sensitive to this structure as the ? ri parameters do not appear in the conditional likelihood ( 2 ). Also, if the stratum effects are generated from a distribution whose parameters depend on the regression covariate X , the REM approach suffers appreciably compared to ACLR in terms of bias.  6 Discussion In this paper, we present a regression method for estimating the parameters in a highly stratified proportional odds model. The direct maximum likelihood estimates for this model are not consistent in sparse-strata situations, that is, when the number of strata increases in direct proportion to sample size. The proposed estimator is consistent for the two standard types of asymptotics, (a) when sample size within each stratum increases and the number of strata is fixed (the large-strata case), and (b) when the number of strata increases proportional to the overall sample size (the sparse-strata case). We derive a sandwich estimate of the variance of the estimator and propose Wald-type tests and confidence intervals based on this approximation. We show the equivalence of our approach with a Mantel-Haenszel estimator proposed by [ 12 ] and an alternative estimator proposed by [ 9 ] for Generalized Rasch’s item response model. The above approaches are limited in their applications as they can accommodate only a modest number of categorical covariates while our method provides the flexibility of a general regression model. Compared to a random effects approach, our method is more robust as it does not assume a specific form of the stochastic distribution for the stratification parameters and is computationally much simpler. The proposed method seems particularly suitable for pair matched data, representing the highest degree of stratification. Our simulation study also indicates the loss of efficiency by simple dichotomization of response instead of using the full ordinal scale. One could possibly consider a different model structure for the ordinal response, such as an adjacent category logit model or a continuation-ratio logit model [ 25 ], that we have not considered. The major difference in those cases is that the optimal solution, the conditional MLE is available in both of those situations. Admittedly, the proposed estimator is not fully effcient. For the large-strata situation as in (a) above, Liu and Agresti show that the loss of efficiency is surprisingly less in using this type of naive estimators when compared to the full ML estimators. For large-strata case, Clayton [ 26 ] derived a weighted estimator of ? based on the separate collapsings. The weights were chosen so as to minimize the variance of the estimator when ? = 0. It is unclear how this method could be adapted to derive valid estimates under sparse data situation as the estimated weights are highly unstable in such a case. Furthermore, the choice of weights is not critically important to the efficiency for these type of estimators [ 17 ]. We also noticed the same phenomena when we tried to use weights suggested from the Bayesian model averaging perspective [ 27 ], where estimates from each collapsing were weighted by the posterior probability of the collapsed model as approximated by the Bayes information criterion. This weighting hardly made difference in terms of mean-squared error performance of the estimator. However, from a theoretical perspective, it is indeed an interesting open question to obtain the optimum weights. Techniques such as the ones developed in [ 28 ] could potentially lead to the semiparametric effcient score function. We have proposed a robust estimation strategy which is relatively easy to implement, works well for sparse data and is not sensitive to the choice of the random distribution which generates the nuisance parameters ? ri and utilizes the full ordinal scale. We reiterate that the proposed method relies on the proportional odds structure, which is a strong modeling assumption in itself, and thus is subject to model misspecification. In a real example, the validity of the proportional odds assumption should be carefully assessed. R code for implementing the above method and SAS code for implementing REM and GEE are available at http://www.sph.umich.edu/bhramar/public_html/research .  6 Discussion In this paper, we present a regression method for estimating the parameters in a highly stratified proportional odds model. The direct maximum likelihood estimates for this model are not consistent in sparse-strata situations, that is, when the number of strata increases in direct proportion to sample size. The proposed estimator is consistent for the two standard types of asymptotics, (a) when sample size within each stratum increases and the number of strata is fixed (the large-strata case), and (b) when the number of strata increases proportional to the overall sample size (the sparse-strata case). We derive a sandwich estimate of the variance of the estimator and propose Wald-type tests and confidence intervals based on this approximation. We show the equivalence of our approach with a Mantel-Haenszel estimator proposed by [ 12 ] and an alternative estimator proposed by [ 9 ] for Generalized Rasch’s item response model. The above approaches are limited in their applications as they can accommodate only a modest number of categorical covariates while our method provides the flexibility of a general regression model. Compared to a random effects approach, our method is more robust as it does not assume a specific form of the stochastic distribution for the stratification parameters and is computationally much simpler. The proposed method seems particularly suitable for pair matched data, representing the highest degree of stratification. Our simulation study also indicates the loss of efficiency by simple dichotomization of response instead of using the full ordinal scale. One could possibly consider a different model structure for the ordinal response, such as an adjacent category logit model or a continuation-ratio logit model [ 25 ], that we have not considered. The major difference in those cases is that the optimal solution, the conditional MLE is available in both of those situations. Admittedly, the proposed estimator is not fully effcient. For the large-strata situation as in (a) above, Liu and Agresti show that the loss of efficiency is surprisingly less in using this type of naive estimators when compared to the full ML estimators. For large-strata case, Clayton [ 26 ] derived a weighted estimator of ? based on the separate collapsings. The weights were chosen so as to minimize the variance of the estimator when ? = 0. It is unclear how this method could be adapted to derive valid estimates under sparse data situation as the estimated weights are highly unstable in such a case. Furthermore, the choice of weights is not critically important to the efficiency for these type of estimators [ 17 ]. We also noticed the same phenomena when we tried to use weights suggested from the Bayesian model averaging perspective [ 27 ], where estimates from each collapsing were weighted by the posterior probability of the collapsed model as approximated by the Bayes information criterion. This weighting hardly made difference in terms of mean-squared error performance of the estimator. However, from a theoretical perspective, it is indeed an interesting open question to obtain the optimum weights. Techniques such as the ones developed in [ 28 ] could potentially lead to the semiparametric effcient score function. We have proposed a robust estimation strategy which is relatively easy to implement, works well for sparse data and is not sensitive to the choice of the random distribution which generates the nuisance parameters ? ri and utilizes the full ordinal scale. We reiterate that the proposed method relies on the proportional odds structure, which is a strong modeling assumption in itself, and thus is subject to model misspecification. In a real example, the validity of the proportional odds assumption should be carefully assessed. R code for implementing the above method and SAS code for implementing REM and GEE are available at http://www.sph.umich.edu/bhramar/public_html/research . 