The Dynamics of a Quantitative Trait in an Age-structured Population Living in a Variable Environment Time series of rapid phenotypic change have recently been documented in age-structured populations living in the wild. Researchers are often interested in identifying the processes responsible for such change. Although there is well developed demographic theory to explain time series of population size, equivalent theory does not exist for the mean values of phenotypic traits in structured populations. We derive an equation to exactly decompose change in the mean value of a phenotypic trait into contributions from fluctuations in the demographic structure, and age-specific viability selection, fertility selection, growth and reversion and differences between offspring and parental trait values. We calculate these contributions to fluctuations in mean birth weight in a well characterized population of red deer. Over the > 30 years of the study mean birth weight has not significantly changed. Stasis has occurred because positive viability selection for an increase in birth weight is countered by transmission bias. Our derivation demonstrates that this is only one of many ways in which equilibria in the mean value of a phenotypic trait can be maintained. The age-structured Price equation we derive and apply has the potential to provide considerable insight into the processes generating now frequently reported cases of rapid phenotypic change.  Introduction The probability that an individual survives a period of time and successfully reproduces can be dependent on aspects of its phenotype including quantitative traits like body size and condition ( Jorgenson et al. 1993 ; Gaillard et al. 1997 ; Larsson et al. 1998 ; Yoccoz and Mesnager 1998 ; Wikelski and Romero 2003 ). One consequence of this is that average survival and recruitment rates can, in part, be dependent upon the distribution of quantitative traits within the population ( Vaupel et al. 1979 ). Associations between trait values and individual survival and reproductive rates can vary with the environment ( Jorgenson et al. 1993 ; Benton and Beckerman 2005 ). This means that the contribution of the distribution of quantitative traits to mean survival and recruitment, and consequently to population growth, can vary over time ( Coulson et al. 2003 ; Pelletier et al. 2007 ). Demographic rates can therefore be considered as phenotype by environment interactions ( Coulson et al. 2006 ). If individuals with specific trait values are more likely to survive or successfully reproduce than individuals with other trait values then the trait is subject to selection ( Arnold and Wade 1984 ). Within populations, viability selection will alter the distribution of trait values over time within a cohort ( Vaupel et al. 1979 ). If the trait has an additive genetic component fertility selection can alter the distribution of trait values across generations ( Falconer 1960 ). The strength of both viability and fertility selection can vary with the environment ( Ellner et al. 1999 ; Hairston and Dillon 1990 ), which means the magnitude of change in trait distributions can vary with time. These observations imply that the dynamics of populations and the dynamics of quantitative traits subject to selection must be intimately linked. Recent research on Soay sheep has demonstrated how to decompose population growth rate into contributions from the distribution of a quantitative trait ( Pelletier et al. 2007 ), and there are a growing number of reports of quantitative trait distributions changing rapidly over time within populations ( Wilson et al. 2007 ; Edeline et al. 2007 ; Grant and Grant 2006 ; Hairston et al. 2005 ; Reale et al. 2003 ; Law 2000 ). Although theory exists to explain changes in phenotypic trait distributions as a result of fertility selection ( Lande and Arnold 1983 ; Falconer 1960 ) and viability selection ( Vaupel et al. 1979 ), the theory does not show how these processes combine to determine the dynamics of phenotypic traits in age-structured populations. In this paper we begin to develop this theory. Among vertebrates, rapid phenotypic change has been reported in fish ( Law 2000 ; Reznick and Endler 1982 ), reptiles ( Sinervo and Lively 1996 ), birds ( Grant and Grant 1995 ) and mammals ( Coulson et al. 2003 ). In a population of bighorn sheep living in Alberta, Canada, mean body weight of four year old rams declined at a rate of 650g year?1, while their horn lengths declined by just under 33% over a period of 30 years. The proximate cause of this decline was trophy hunting of large individuals, while the ultimate cause is believed to be genetic ( Coltman et al. 2003 ). Other than hunting, a range of ecological processes can generate rapid phenotypic change including environmental variation – global climate change has led to births occurring earlier in the year in mammals ( Reale et al. 2003 ), has advanced laying date in birds ( Both et al. 2004 ), and the timing of flowering in vascular plants ( Fitter and Fitter 2002 ). Species interactions are another cause of rapid phenotypic change – the introduction of predatory fish into ecosystems containing daphnia leads to the expression of an armoured helmet and an extended tail spine ( Gilbert 1966 ). In general, such phenotypic change can be caused by (a) viability selection preferentially removing individuals from one part of the phenotype distribution compared to other parts ( Vaupel et al. 1979 ), (b) by fertility selection leading to some genotypes contributing more to reproduction than others ( Lande and Arnold 1983 ), (c) by genetic, maternal and environmental effects influencing offspring size ( Roach and Wulff 1987 ), (d) by growth and reversion ( Niva and Jokela 2000 ), and (e) by fluctuations in the demographic composition of the population ( Charlesworth 1994 ) ( Figure 1 ). A detailed understanding of why phenotypic distributions change with time requires consideration of each of these processes, and identification of the relative contributions of each process. Before we develop and apply new methods, we review the existing approaches used to examine how changes in quantitative traits vary over time.  Descriptions of Quantitative Trait Dynamics Quantitative Genetics and the Breeder’s equation The effects of selection (expressed in terms of variation in a Malthusian parameter, or lifetime fitness) and heredity on changes in the distribution of quantitative traits have been described by the univariate ( Falconer 1960 ) and the multivariate ( Lande and Arnold 1983 ) Breeder’s equation. These equations assume non-overlapping generations. The univariate Breeder’s equation states that the change ? Z? in the mean of a quantitative trait over a generation is the product of a selection differential on the trait, cov( Z , W )/ W? , and the heritability of the trait defined as the ratio of the additive genetic variance to the phenotypic variance: V A/V P . Individual i has a trait value z i ; fitness, w i = w ( z i ), is defined as the Malthusian parameter for an individual with trait value z i ; and the mean fitness W? and the covariance cov( Z , W ) are computed across all individuals within the population. The selection differential is the difference between the mean of the distribution of parents (in which an individual is represented once for each offspring it produces) and the mean of the overall population prior to selection. It is important to note that to describe change in a trait distribution the selection differential must be multiplied a heritability that describes the genetic architecture of the trait. Each individual’s trait value is considered to consist of two components – a breeding value which describes the additive genetic contribution to the individual’s focal trait, and an environmental component ( Falconer 1960 ). The trait’s heritability, is the proportion of phenotypic variation attributable to breeding values. It is assumed that the mean of the breeding value distribution of parents (after selection) is equal to the mean of the phenotypic distribution among offspring ( Lande and Arnold 1983 ). The breeder’s equation consequently describes how the mean of the breeding value distribution changes within a generation as a result of fertility selection and then makes an assumption concerning the similarity between parents and their offspring. Further assumptions include independence between individual breeding values and the individual environmental components, and that breeding values in parents and offspring are normally distributed ( Bulmer 1980 ). The Breeder’s equation would be a useful tool to describe changes from one year to the next only for annual species with non-overlapping generations and satisfying the assumptions above, but does not apply when generations overlap. To address this limitation ( Lande 1982 ) and ( Charlesworth 1993 ) derive age-structured versions of the Breeder’s equation for traits that change with age under the additional assumption of weak selection and a stable age-structure. Their approach incorporates the effects of viability and fertility selection on change in the mean of the trait distribution. We do not consider their derivations here as we are primarily interested in decomposing observed phenotypic change without making their restrictive assumptions. In the next section we consider another approach which has examined how viability selection will alter a trait distribution within a generation. Viability Selection and Frailty In their influential paper ( Vaupel et al. 1979 ) develop life table methods for cases when individual survival probabilities vary with age as a function of a phenotypic trait, Z . The trait they focus on is termed ‘frailty’; its value in an individual is fixed throughout life and simply influences the individual’s chance of survival. They show that estimates of key life table statistics are biased if individual heterogeneity in the trait exists and is ignored. They also demonstrate that viability selection on a trait changes the mean ( Z? ( a )) of the trait distribution within a cohort as individuals within the cohort age. Such viability selection has the potential to alter the distribution of the trait rapidly within generations. The consequences of intra-cohort viability selection due to variation in frailty may be followed using a simple form of the Price equation ( Price 1970 ) (which is discussed further below), which yields the difference between mean frailties at ages a and a + 1 as (1) ? Z ¯ = Z ¯ ( a + 1 ) ? Z ¯ ( a ) = cov ( Z , S ) S ¯ ( a ) where s i ( a ) is a binary variable describing whether individual i of age a survives or not, and S? ( a ) is mean survival across individuals of age a within a cohort. As well as viability selection, growth and reversion among surviving individuals could also theoretically contribute to changes in phenotypic trait distributions with time. Growth, reversion and changes in trait means Frailty, the trait that ( Vaupel et al. 1979 ) consider, remains constant throughout life. However, many quantitative traits that influence survival and recruitment are not fixed throughout life. For example, in vertebrates, body weight varies with age, environment and physiological status. There is little formal theory developed to generalize how the dynamics of trait distributions are influenced with growth and reversion, although factors influencing individual growth and reversion rates have been investigated in a range of species. For example, in numerous mosquito species environmental drivers including temperature, genetic effects, intra- and inter-specific competition for food and the presence of predators influence growth rates of larvae and the time taken for transitions between instars ( Braks et al. 2004 ; Agnew and Koella 1999 ; Wallace and Merritt 1999 ; Strand et al. 1999 ). Any contribution of growth or reversion to a change in the mean of a trait distribution will need to consider the average difference across trait values of survivors before and after selection. Finally, if fertility or viability selection, similarities between parents and offspring, and growth and reversion differ between individuals of different ages, any formulation describing the dynamics of a quantitative trait over a time step may also need to consider the demographic structure of the population at time t . Fluctuations in the demographic structure In structured populations survival and recruitment rates often vary with age. One consequence of this in variable environments is that the demographic structure of the population fluctuates over time ( Coulson et al. 2001 ; Tuljapurkar 1990 ). This means that average survival and recruitment rates often vary with time as a function of the proportion of individuals within each age class. The strength of viability and fertility selection, heritabilities, and growth and reversion rates can also vary with age ( Coulson et al. 2003 ; Charmantier et al. 2006 ; Wilson et al. 2006 ). This means that change in the mean value of a trait may also vary as a function of the demographic structure of the population. Thus, several processes are consequently likely to influence the temporal dynamics of a quantitative trait in an age-structured population living in a variable environment. One equation already describes changes in the mean value of a trait distribution subject to selection – the Price equation ( Price 1970 ). As the final part of our review we consider the properties of this equation, which is typically considered in relation to populations with non-overlapping generations. The Price Equation Price (1970) showed that change in the mean value of a phenotypic trait between one generation and the next can be described exactly as a sum of two quantities. The first quantity describes the difference in the mean trait value of individuals selected to be parents and the mean trait value across all individuals within the population. The second quantity describes the difference in the mean trait value between offspring and their parents. There are various ways in which this equation can be written (see below). The individual trait value may be a scalar or a vector, and individual fitness, W , is a scalar. Fitness is is typically considered to be lifetime offspring production assuming non-overlapping generations, so this form of the equation cannot sensibly be applied to populations with overlapping generations. In the next section, we develop a version of the Price equation where fitness is decomposed into age-specific survival and recruitment. As a prelude, it is useful to discuss the Price equation in detail for an annual organism, in which case the time interval in the equation is a year and W = R , the number of offspring. There are, say, n individuals in a particular year t . Individual i has trait value z i produces r i ? 0 offspring, so the mean trait value in year t is Z? ( t ) = (1/ n ) ? i z i , and the average number of offspring produced by all potential parents is R? = (1/ n ) ? i r i . Write the trait value of the j th offspring of individual i as y ij = z i + d ij . The mean trait value in the next year is the mean trait value of offspring, (2) Z ¯ ( t + 1 ) = ( 1 R ¯ n ) ? i = 1 n ? j = 1 r i [ z i + d ij ] . Here, the first term in square brackets on the right side is just (3) ( ZR ¯ R ¯ ) = Z ¯ ( t ) + Cov  ( Z , R ) R ¯ . The covariance term describes selection via the effect of trait Z on fertility. The second term in square brackets on the right of (2) describes any infidelity in the transmission of mean phenotype from parents to offspring. Let d? i be the difference between the mean trait value of individual i ’s offspring and its own (parental) trait value z i . To average over all potential parents, we follow Price (1970) and set d? i to the observed value for parents (for whom r i > 0), and set d? i = 0 for individuals who produce no offspring (for whom r i = 0). Then the second term in square brackets on the right of of (2) yields (4) ( 1 R ¯ n ) ? i = 1 n r i d ¯ i = D ¯ + Cov  ( D , R ) R ¯ . The first term above describes the average infidelity of phenotypic transmission and the second describes any interaction between fertility and the infidelity of transmission. Combining terms, the Price equation is (5) ? Z ¯ = Cov  ( Z , R ) R ¯ + D ¯ + Cov  ( D , R ) R ¯ . To repeat, averages here are computed over all n potential parents. A different and useful perspective is to consider only parents, i.e., individuals observed to have r i > 0. There are n p ? n parents and we use a + sign to denote averages over these parents. Thus, the average number of offspring is R ¯ + = ( 1 / n p ) ? i : r i > 0 r i = ( 1 / n p ) ? + r i . The mean phenotype in year t + 1, written as average over parents, is (6) Z ¯ ( t + 1 ) = ( 1 R ¯ + n p ) ? i = 1 n p ? j = 1 r i : r i > 0 [ z i + d ij ] . The first term on the right side yields (7) ( 1 R ¯ + n p ) ? i = 1 n p r i z i = Z ¯ + + Cov + ( Z , R ) R ¯ + . However ? i = 1 n p r i z i = ? i = 1 n r i z i , because individuals with r i = 0 don’t contribute to the sum. Also, the total number of offspring is R? + n p = R? n . Hence ( 1 R ¯ + n p ) ? i = 1 n p r i z i = ( 1 R ¯ n ) ? i = 1 n p r i z i , = ( 1 R ¯ n ) ? i = 1 n r i z i , which implies that (8) Z ¯ + + Cov + ( Z , R ) R ¯ + = Z ¯ + Cov  ( Z , R ) R ¯ , The second term in square brackets on the right side of (6) is D ¯ + + Cov + ( D , R ) R ¯ + . Recalling that d? i = 0 for individuals who don’t reproduce, an argument similar to the one above shows that (9) D ¯ + + Cov + ( D , R ) R ¯ + = D ¯ + Cov  ( D , R ) R ¯ . Putting things together, we can rewrite the Price equation equation (5) as (10) ? Z ¯ = [ Z ¯ + ? Z ¯ ] + Cov + ( Z , R ) R ¯ + + [ D ¯ + + Cov + ( D , R ) R ¯ + ] . On the right, the first bracketed term represents the selection of parents from among all individuals, the middle term is the effect of fertility selection among parents with different phenotypes, and the last bracketed term describes infidelity of transmission. In the empirical literature it is often assumed that the Breeder’s equation will accurately describe ? Z? in the same way that the Price equation does. However, the assumptions underlying the Breeder’s equation imply that it will yield the same results as the Price equation only under rather restrictive circumstances ( Heywood 2005 ; Frank 1997 ; Jacquard 1983 ; Feldman and Lewontin 1975 ). This failure of the Breeder’s equation is sometimes interpreted by empiricists as evidence of selection on unmeasured correlated characters ( Merila et al. 2001 ). However, as Heywood (2005) shows, several other factors may prevent the Breeder’s and the Price equation from giving the same value of ? Z? , including a spurious response to selection and various types of transmission bias. Below, we develop a version of the Price equation in which fitness is decomposed into age-specific survival and recruitment and we explicitly deal with demographic weights.  Quantitative Genetics and the Breeder’s equation The effects of selection (expressed in terms of variation in a Malthusian parameter, or lifetime fitness) and heredity on changes in the distribution of quantitative traits have been described by the univariate ( Falconer 1960 ) and the multivariate ( Lande and Arnold 1983 ) Breeder’s equation. These equations assume non-overlapping generations. The univariate Breeder’s equation states that the change ? Z? in the mean of a quantitative trait over a generation is the product of a selection differential on the trait, cov( Z , W )/ W? , and the heritability of the trait defined as the ratio of the additive genetic variance to the phenotypic variance: V A/V P . Individual i has a trait value z i ; fitness, w i = w ( z i ), is defined as the Malthusian parameter for an individual with trait value z i ; and the mean fitness W? and the covariance cov( Z , W ) are computed across all individuals within the population. The selection differential is the difference between the mean of the distribution of parents (in which an individual is represented once for each offspring it produces) and the mean of the overall population prior to selection. It is important to note that to describe change in a trait distribution the selection differential must be multiplied a heritability that describes the genetic architecture of the trait. Each individual’s trait value is considered to consist of two components – a breeding value which describes the additive genetic contribution to the individual’s focal trait, and an environmental component ( Falconer 1960 ). The trait’s heritability, is the proportion of phenotypic variation attributable to breeding values. It is assumed that the mean of the breeding value distribution of parents (after selection) is equal to the mean of the phenotypic distribution among offspring ( Lande and Arnold 1983 ). The breeder’s equation consequently describes how the mean of the breeding value distribution changes within a generation as a result of fertility selection and then makes an assumption concerning the similarity between parents and their offspring. Further assumptions include independence between individual breeding values and the individual environmental components, and that breeding values in parents and offspring are normally distributed ( Bulmer 1980 ). The Breeder’s equation would be a useful tool to describe changes from one year to the next only for annual species with non-overlapping generations and satisfying the assumptions above, but does not apply when generations overlap. To address this limitation ( Lande 1982 ) and ( Charlesworth 1993 ) derive age-structured versions of the Breeder’s equation for traits that change with age under the additional assumption of weak selection and a stable age-structure. Their approach incorporates the effects of viability and fertility selection on change in the mean of the trait distribution. We do not consider their derivations here as we are primarily interested in decomposing observed phenotypic change without making their restrictive assumptions. In the next section we consider another approach which has examined how viability selection will alter a trait distribution within a generation.  Viability Selection and Frailty In their influential paper ( Vaupel et al. 1979 ) develop life table methods for cases when individual survival probabilities vary with age as a function of a phenotypic trait, Z . The trait they focus on is termed ‘frailty’; its value in an individual is fixed throughout life and simply influences the individual’s chance of survival. They show that estimates of key life table statistics are biased if individual heterogeneity in the trait exists and is ignored. They also demonstrate that viability selection on a trait changes the mean ( Z? ( a )) of the trait distribution within a cohort as individuals within the cohort age. Such viability selection has the potential to alter the distribution of the trait rapidly within generations. The consequences of intra-cohort viability selection due to variation in frailty may be followed using a simple form of the Price equation ( Price 1970 ) (which is discussed further below), which yields the difference between mean frailties at ages a and a + 1 as (1) ? Z ¯ = Z ¯ ( a + 1 ) ? Z ¯ ( a ) = cov ( Z , S ) S ¯ ( a ) where s i ( a ) is a binary variable describing whether individual i of age a survives or not, and S? ( a ) is mean survival across individuals of age a within a cohort. As well as viability selection, growth and reversion among surviving individuals could also theoretically contribute to changes in phenotypic trait distributions with time.  Growth, reversion and changes in trait means Frailty, the trait that ( Vaupel et al. 1979 ) consider, remains constant throughout life. However, many quantitative traits that influence survival and recruitment are not fixed throughout life. For example, in vertebrates, body weight varies with age, environment and physiological status. There is little formal theory developed to generalize how the dynamics of trait distributions are influenced with growth and reversion, although factors influencing individual growth and reversion rates have been investigated in a range of species. For example, in numerous mosquito species environmental drivers including temperature, genetic effects, intra- and inter-specific competition for food and the presence of predators influence growth rates of larvae and the time taken for transitions between instars ( Braks et al. 2004 ; Agnew and Koella 1999 ; Wallace and Merritt 1999 ; Strand et al. 1999 ). Any contribution of growth or reversion to a change in the mean of a trait distribution will need to consider the average difference across trait values of survivors before and after selection. Finally, if fertility or viability selection, similarities between parents and offspring, and growth and reversion differ between individuals of different ages, any formulation describing the dynamics of a quantitative trait over a time step may also need to consider the demographic structure of the population at time t .  Fluctuations in the demographic structure In structured populations survival and recruitment rates often vary with age. One consequence of this in variable environments is that the demographic structure of the population fluctuates over time ( Coulson et al. 2001 ; Tuljapurkar 1990 ). This means that average survival and recruitment rates often vary with time as a function of the proportion of individuals within each age class. The strength of viability and fertility selection, heritabilities, and growth and reversion rates can also vary with age ( Coulson et al. 2003 ; Charmantier et al. 2006 ; Wilson et al. 2006 ). This means that change in the mean value of a trait may also vary as a function of the demographic structure of the population. Thus, several processes are consequently likely to influence the temporal dynamics of a quantitative trait in an age-structured population living in a variable environment. One equation already describes changes in the mean value of a trait distribution subject to selection – the Price equation ( Price 1970 ). As the final part of our review we consider the properties of this equation, which is typically considered in relation to populations with non-overlapping generations.  The Price Equation Price (1970) showed that change in the mean value of a phenotypic trait between one generation and the next can be described exactly as a sum of two quantities. The first quantity describes the difference in the mean trait value of individuals selected to be parents and the mean trait value across all individuals within the population. The second quantity describes the difference in the mean trait value between offspring and their parents. There are various ways in which this equation can be written (see below). The individual trait value may be a scalar or a vector, and individual fitness, W , is a scalar. Fitness is is typically considered to be lifetime offspring production assuming non-overlapping generations, so this form of the equation cannot sensibly be applied to populations with overlapping generations. In the next section, we develop a version of the Price equation where fitness is decomposed into age-specific survival and recruitment. As a prelude, it is useful to discuss the Price equation in detail for an annual organism, in which case the time interval in the equation is a year and W = R , the number of offspring. There are, say, n individuals in a particular year t . Individual i has trait value z i produces r i ? 0 offspring, so the mean trait value in year t is Z? ( t ) = (1/ n ) ? i z i , and the average number of offspring produced by all potential parents is R? = (1/ n ) ? i r i . Write the trait value of the j th offspring of individual i as y ij = z i + d ij . The mean trait value in the next year is the mean trait value of offspring, (2) Z ¯ ( t + 1 ) = ( 1 R ¯ n ) ? i = 1 n ? j = 1 r i [ z i + d ij ] . Here, the first term in square brackets on the right side is just (3) ( ZR ¯ R ¯ ) = Z ¯ ( t ) + Cov  ( Z , R ) R ¯ . The covariance term describes selection via the effect of trait Z on fertility. The second term in square brackets on the right of (2) describes any infidelity in the transmission of mean phenotype from parents to offspring. Let d? i be the difference between the mean trait value of individual i ’s offspring and its own (parental) trait value z i . To average over all potential parents, we follow Price (1970) and set d? i to the observed value for parents (for whom r i > 0), and set d? i = 0 for individuals who produce no offspring (for whom r i = 0). Then the second term in square brackets on the right of of (2) yields (4) ( 1 R ¯ n ) ? i = 1 n r i d ¯ i = D ¯ + Cov  ( D , R ) R ¯ . The first term above describes the average infidelity of phenotypic transmission and the second describes any interaction between fertility and the infidelity of transmission. Combining terms, the Price equation is (5) ? Z ¯ = Cov  ( Z , R ) R ¯ + D ¯ + Cov  ( D , R ) R ¯ . To repeat, averages here are computed over all n potential parents. A different and useful perspective is to consider only parents, i.e., individuals observed to have r i > 0. There are n p ? n parents and we use a + sign to denote averages over these parents. Thus, the average number of offspring is R ¯ + = ( 1 / n p ) ? i : r i > 0 r i = ( 1 / n p ) ? + r i . The mean phenotype in year t + 1, written as average over parents, is (6) Z ¯ ( t + 1 ) = ( 1 R ¯ + n p ) ? i = 1 n p ? j = 1 r i : r i > 0 [ z i + d ij ] . The first term on the right side yields (7) ( 1 R ¯ + n p ) ? i = 1 n p r i z i = Z ¯ + + Cov + ( Z , R ) R ¯ + . However ? i = 1 n p r i z i = ? i = 1 n r i z i , because individuals with r i = 0 don’t contribute to the sum. Also, the total number of offspring is R? + n p = R? n . Hence ( 1 R ¯ + n p ) ? i = 1 n p r i z i = ( 1 R ¯ n ) ? i = 1 n p r i z i , = ( 1 R ¯ n ) ? i = 1 n r i z i , which implies that (8) Z ¯ + + Cov + ( Z , R ) R ¯ + = Z ¯ + Cov  ( Z , R ) R ¯ , The second term in square brackets on the right side of (6) is D ¯ + + Cov + ( D , R ) R ¯ + . Recalling that d? i = 0 for individuals who don’t reproduce, an argument similar to the one above shows that (9) D ¯ + + Cov + ( D , R ) R ¯ + = D ¯ + Cov  ( D , R ) R ¯ . Putting things together, we can rewrite the Price equation equation (5) as (10) ? Z ¯ = [ Z ¯ + ? Z ¯ ] + Cov + ( Z , R ) R ¯ + + [ D ¯ + + Cov + ( D , R ) R ¯ + ] . On the right, the first bracketed term represents the selection of parents from among all individuals, the middle term is the effect of fertility selection among parents with different phenotypes, and the last bracketed term describes infidelity of transmission. In the empirical literature it is often assumed that the Breeder’s equation will accurately describe ? Z? in the same way that the Price equation does. However, the assumptions underlying the Breeder’s equation imply that it will yield the same results as the Price equation only under rather restrictive circumstances ( Heywood 2005 ; Frank 1997 ; Jacquard 1983 ; Feldman and Lewontin 1975 ). This failure of the Breeder’s equation is sometimes interpreted by empiricists as evidence of selection on unmeasured correlated characters ( Merila et al. 2001 ). However, as Heywood (2005) shows, several other factors may prevent the Breeder’s and the Price equation from giving the same value of ? Z? , including a spurious response to selection and various types of transmission bias. Below, we develop a version of the Price equation in which fitness is decomposed into age-specific survival and recruitment and we explicitly deal with demographic weights.  Age-Structured Price Equation Dynamics of Mean Trait Value We track trait values, population numbers, survival, fertility, and growth/regression by age (notation is summarized in Table 1 ). Here the terms growth/regression more broadly include developmental changes in a trait such as changes in physiological function or degenerative change in organs. Age classes are labelled by index a , newborns are in age class a = 1. There are n ( a , t ) individuals in age class a at time t with phenotypes z i, i = 1, ?, n ( a , t ); z i may be a scalar or a vector. Total population size is N ( t ); age structure proportions are c ( a , t ) = n ( a , t )/ N ( t ). Individual i in age class a at time t has phenotype z i and produces r i ( a , t ) offspring. The survival rate of individual i in age class a at time t is s i ( a , t ). At time t , the mean phenotype in age class a is Z? ( a , t ). The mean phenotype in the whole population is (11) Z ¯ ( t ) = ? a c ( a , t ) Z ¯ ( a , t ) At time t + 1, phenotypic distributions at ages 2, 3, … are determined by selection through survival on the phenotypes already present at t in ages 1, 2, …. But the newborn phenotypes in age class 1 at t + 1 depend on all parents at t , through their phenotypes and fertility, and on the transmission of phenotypes from parents to offspring. At time t + 1 for a ? 1, the n ( a + 1, t + 1) individuals in age class a + 1 are survivors of the n ( a , t ), (12) n ( a + 1 , t + 1 ) = ? i = 1 n ( a , t ) s i ( a , t ) = n ( a , t ) S ¯ ( a , t ) . Here S? ( a , t ) is an average of s i ( a , t ) over the original a , t individuals. Suppose that an a , t individual with phenotype z i who survives has a phenotype z i + g i where g i is growth or reversion. Set g i = 0 for individuals that do not survive. The mean phenotype of a + 1, t + 1 individuals is (13) Z ¯ ( a + 1 , t + 1 ) = ( S ( Z + G ) ) ( a , t ) ¯ S ¯ ( a , t ) , = Z ¯ ( a , t ) + Cov ( Z , S ) ( a , t ) S ¯ ( a , t ) + SG ¯ ( a , t ) S ¯ ( a , t ) . As in our discussion of the non-age-structured Price equation, the second term above can be calculated only over individuals that actually survive, (14) Z ¯ ( a + 1 , t + 1 ) = Z ¯ ( a , t ) + Cov ( Z , S ) ( a , t ) S ¯ ( a , t ) + G ¯ + ( a , t ) . where G? +( a , t ) is the mean of Z ( a + 1 , t + 1) ? Z ( a , t ) calculated across survivors. For offspring we use an age-specific version of the notation in the preceding discussion of the Price equation. Individual i in age-class a at time t has trait value z i ( a , t ) and produces r i ( a , t ) ? 0 offspring; the average number of offspring produced by a , t individuals is R? ( a , t ). The trait value of the j th offspring of individual i in age-class a at time t is y ij ( a , t ) = z i ( a , t ) + d ij ( a , t ), and d? i ( a , t ) is the difference between the mean trait value of individual i ’s offspring and its own (parental) trait value z i ( a , t ). It is important to note that here d ij ( a , t ) and d? i ( a , t ) include both transmission infidelity and any difference in trait values between parents and offspring that is due purely to growth/regression. To see why, notice that individual i ’s trait value at a , t is related to its own trait value at birth, z i (1, t ? a + 1), by z i ( a , t ) = z i ( 1 , t ? a + 1 ) + g i c ( a , t ) , where g i c ( a , t ) is the cumulative growth/regression of the trait value between ages 1 and a . The average size at birth of the offspring of this individual is y ¯ i ( a , t ) = z i ( a , t ) + d ¯ ( a , t ) = z i ( 1 , t ? a + 1 ) = g i c ( a , t ) + d ¯ i ( a , t ) , and thus (15) d ¯ i ( a , t ) = [ y ¯ i ( a , t ) ? z i ( 1 , t ? a + 1 ) ] ? g i c ( a , t ) . The square-bracketed term on the right measures transmission infidelity, and the other term measures growth/regression. Let Y? (1| a ) be the mean trait value of the offspring produced by a , t individuals, and use equation (5) to see that (16) Y ¯ ( 1 | a ) ? Z ¯ ( a , t ) = Cov  ( Z , R ) ( a , t ) R ¯ ( a , t ) + D ¯ ( a , t ) + Cov  ( D , R ) ( a , t ) R ¯ ( a , t ) . Averages here are computed over all a , t individuals, i.e., all potential parents. Alternatively, we can use equation (10) to write (17) Y ¯ ( 1 | a ) ? Z ¯ ( a , t ) = [ Z ¯ + ( a , t ) ? Z ¯ ( a , t ) ] + Cov + ( Z , R ) ( a , t ) R ¯ + ( a , t ) + [ D ¯ + ( a , t ) + Cov + ( Z , R ) ( a , t ) R ¯ + ( a , t ) ] . On the right, the first bracketed term represents the selection of parents from among all individuals, the middle term is the effect of fertility selection among parents with different phenotypes, and the last bracketed term describes infidelity of transmission and differences due to growth/regression. The total number of newborns at time t is (18) n ( 1 , t + 1 ) = ? a R ¯ ( a , t ) n ( a , t ) . The mean trait value of all offspring is an average of Y? (1| a ) across all parental ages, weighted by reproductive output: (19) Z ¯ ( 1 , t + 1 ) = ? a ( R ¯ ( a , t ) n ( a , t ) n ( 1 , t + 1 ) )     [ Z ¯ ( a , t ) + D ¯ ( a , t ) + Cov ( Z , R ) ( a , t ) R ¯ ( a , t ) + Cov ( D , R ) ( a , t ) R ¯ ( a , t ) ] . The population’s mean phenotype at t + 1 is (20) Z ¯ ( t + 1 ) = ( 1 N ( t + 1 ) ) ? a n ( a , t + 1 ) Z ¯ ( a , t + 1 ) . We follow standard demography in killing off the last age class at time t , call it age class ?, by time t + 1; it is straightforward to modify the results if individuals can stay on in the terminal age class. Define the population growth rate W? ( t ), which is also the mean fitness, by (21) N ( t + 1 ) = W ¯ ( t ) N ( t ) . For a ? 1, (22) c ( a + 1 , t + 1 ) = S ¯ ( a , t ) c ( a , t ) W ¯ ( t ) , and (23) n ( a , t ) n ( 1 , t + 1 ) = c ( a , t ) W ( t ) ¯ c ( 1 , t + 1 ) . When we use these to combine (19) with (13) across all age classes, it is algebraically inevitable that (24a) Z ¯ ( t + 1 ) = ? a = 1 ? ? 1 ( c ( a , t ) S ¯ ( a , t ) W ¯ ( t ) )    [ Z ¯ ( a , t ) + G ¯ ( a , t ) ] + (24b) ? a = 1 ? ( c ( a , t ) R ¯ ( a , t ) W ¯ ( t ) )    [ Z ¯ ( a , t ) + D ¯ ( a , t ) ] + (24c) ? a = 1 ? ? 1 ( c ( a , t ) S ¯ ( a , t ) W ¯ ( t ) )    [ Cov  ( Z , S ) ( a , t ) S ¯ ( a , t ) + Cov ( S , G ) ( a , t ) S ¯ ( a , t ) ] (24d) ? a = 1 ? ( c ( a , t ) R ¯ ( a , t ) W ¯ ( t ) )    [ Cov  ( D , R ) ( a , t ) R ¯ ( a , t ) + Cov  ( Z , R ) ( a , t ) R ¯ ( a , t ) ] . To write the change in the mean trait value for the entire population, define the change in population structure, (25) ? c ( a , t ) = c ( a + 1 , t + 1 ) ? c ( a , t ) . Using this, (26) ? Z ¯ ( t ) = Z ¯ ( t + 1 ) ? Z ¯ ( t ) = ? a = 1 ? ? 1 [ ? c ( a , t ) ] Z ¯ ( a , t ) ? c ( ? , t ) Z ¯ ( ? , t ) (27) + ? a = 1 ? ? 1 ( c ( a , t ) W ¯ ( t ) )    [ Cov ( Z , S ) ( a , t ) (28) + SG ¯ ( a , t ) ] (29) + ? a = 1 ? ( c ( a , t ) W ¯ ( t ) )    [ R ¯ ( a , t ) Z ¯ ( a , t ) (30) + R ¯ ( a , t ) D ¯ ( a , t ) (31) +  cov ( D , R ) ( a , t ) (32) +  cov ( Z , R ) ( a , t ) ] . Because terms in the derivation can be written using our “+” notation (see “The Price equation” above) terms in the above formulation can be written as averages over just parents. This can be done in many ways, including, for example, (33) ? Z ¯ ( t ) = ? a = 1 ? ? 1 [ ? c ( a , t ) ] Z ¯ ( a , t ) ? c ( ? , t ) Z ¯ ( ? , t ) + ? a = 1 ? ? 1 ( c ( a , t ) S ¯ ( a , t ) W ¯ ( t ) )    [ Cov ( Z , S ) ( a , t ) S ¯ ( a , t ) + G ¯ + ( a , t ) S ¯ ( a , t ) ] (34) + ? a = 1 ? ? 1 ( c ( a , t ) R ¯ ( a , t ) W ¯ ( t ) ) [ Z ¯ ( a , t ) + cov ( Z , R ) ( a , t ) R ¯ ( a , t ) + D ¯ + ( a , t ) (35) + cov + ( D , R ) ( a , t ) R ¯ + ( a , t ) ] . Interpretation of these terms can be found in Table 2 .  Dynamics of Mean Trait Value We track trait values, population numbers, survival, fertility, and growth/regression by age (notation is summarized in Table 1 ). Here the terms growth/regression more broadly include developmental changes in a trait such as changes in physiological function or degenerative change in organs. Age classes are labelled by index a , newborns are in age class a = 1. There are n ( a , t ) individuals in age class a at time t with phenotypes z i, i = 1, ?, n ( a , t ); z i may be a scalar or a vector. Total population size is N ( t ); age structure proportions are c ( a , t ) = n ( a , t )/ N ( t ). Individual i in age class a at time t has phenotype z i and produces r i ( a , t ) offspring. The survival rate of individual i in age class a at time t is s i ( a , t ). At time t , the mean phenotype in age class a is Z? ( a , t ). The mean phenotype in the whole population is (11) Z ¯ ( t ) = ? a c ( a , t ) Z ¯ ( a , t ) At time t + 1, phenotypic distributions at ages 2, 3, … are determined by selection through survival on the phenotypes already present at t in ages 1, 2, …. But the newborn phenotypes in age class 1 at t + 1 depend on all parents at t , through their phenotypes and fertility, and on the transmission of phenotypes from parents to offspring. At time t + 1 for a ? 1, the n ( a + 1, t + 1) individuals in age class a + 1 are survivors of the n ( a , t ), (12) n ( a + 1 , t + 1 ) = ? i = 1 n ( a , t ) s i ( a , t ) = n ( a , t ) S ¯ ( a , t ) . Here S? ( a , t ) is an average of s i ( a , t ) over the original a , t individuals. Suppose that an a , t individual with phenotype z i who survives has a phenotype z i + g i where g i is growth or reversion. Set g i = 0 for individuals that do not survive. The mean phenotype of a + 1, t + 1 individuals is (13) Z ¯ ( a + 1 , t + 1 ) = ( S ( Z + G ) ) ( a , t ) ¯ S ¯ ( a , t ) , = Z ¯ ( a , t ) + Cov ( Z , S ) ( a , t ) S ¯ ( a , t ) + SG ¯ ( a , t ) S ¯ ( a , t ) . As in our discussion of the non-age-structured Price equation, the second term above can be calculated only over individuals that actually survive, (14) Z ¯ ( a + 1 , t + 1 ) = Z ¯ ( a , t ) + Cov ( Z , S ) ( a , t ) S ¯ ( a , t ) + G ¯ + ( a , t ) . where G? +( a , t ) is the mean of Z ( a + 1 , t + 1) ? Z ( a , t ) calculated across survivors. For offspring we use an age-specific version of the notation in the preceding discussion of the Price equation. Individual i in age-class a at time t has trait value z i ( a , t ) and produces r i ( a , t ) ? 0 offspring; the average number of offspring produced by a , t individuals is R? ( a , t ). The trait value of the j th offspring of individual i in age-class a at time t is y ij ( a , t ) = z i ( a , t ) + d ij ( a , t ), and d? i ( a , t ) is the difference between the mean trait value of individual i ’s offspring and its own (parental) trait value z i ( a , t ). It is important to note that here d ij ( a , t ) and d? i ( a , t ) include both transmission infidelity and any difference in trait values between parents and offspring that is due purely to growth/regression. To see why, notice that individual i ’s trait value at a , t is related to its own trait value at birth, z i (1, t ? a + 1), by z i ( a , t ) = z i ( 1 , t ? a + 1 ) + g i c ( a , t ) , where g i c ( a , t ) is the cumulative growth/regression of the trait value between ages 1 and a . The average size at birth of the offspring of this individual is y ¯ i ( a , t ) = z i ( a , t ) + d ¯ ( a , t ) = z i ( 1 , t ? a + 1 ) = g i c ( a , t ) + d ¯ i ( a , t ) , and thus (15) d ¯ i ( a , t ) = [ y ¯ i ( a , t ) ? z i ( 1 , t ? a + 1 ) ] ? g i c ( a , t ) . The square-bracketed term on the right measures transmission infidelity, and the other term measures growth/regression. Let Y? (1| a ) be the mean trait value of the offspring produced by a , t individuals, and use equation (5) to see that (16) Y ¯ ( 1 | a ) ? Z ¯ ( a , t ) = Cov  ( Z , R ) ( a , t ) R ¯ ( a , t ) + D ¯ ( a , t ) + Cov  ( D , R ) ( a , t ) R ¯ ( a , t ) . Averages here are computed over all a , t individuals, i.e., all potential parents. Alternatively, we can use equation (10) to write (17) Y ¯ ( 1 | a ) ? Z ¯ ( a , t ) = [ Z ¯ + ( a , t ) ? Z ¯ ( a , t ) ] + Cov + ( Z , R ) ( a , t ) R ¯ + ( a , t ) + [ D ¯ + ( a , t ) + Cov + ( Z , R ) ( a , t ) R ¯ + ( a , t ) ] . On the right, the first bracketed term represents the selection of parents from among all individuals, the middle term is the effect of fertility selection among parents with different phenotypes, and the last bracketed term describes infidelity of transmission and differences due to growth/regression. The total number of newborns at time t is (18) n ( 1 , t + 1 ) = ? a R ¯ ( a , t ) n ( a , t ) . The mean trait value of all offspring is an average of Y? (1| a ) across all parental ages, weighted by reproductive output: (19) Z ¯ ( 1 , t + 1 ) = ? a ( R ¯ ( a , t ) n ( a , t ) n ( 1 , t + 1 ) )     [ Z ¯ ( a , t ) + D ¯ ( a , t ) + Cov ( Z , R ) ( a , t ) R ¯ ( a , t ) + Cov ( D , R ) ( a , t ) R ¯ ( a , t ) ] . The population’s mean phenotype at t + 1 is (20) Z ¯ ( t + 1 ) = ( 1 N ( t + 1 ) ) ? a n ( a , t + 1 ) Z ¯ ( a , t + 1 ) . We follow standard demography in killing off the last age class at time t , call it age class ?, by time t + 1; it is straightforward to modify the results if individuals can stay on in the terminal age class. Define the population growth rate W? ( t ), which is also the mean fitness, by (21) N ( t + 1 ) = W ¯ ( t ) N ( t ) . For a ? 1, (22) c ( a + 1 , t + 1 ) = S ¯ ( a , t ) c ( a , t ) W ¯ ( t ) , and (23) n ( a , t ) n ( 1 , t + 1 ) = c ( a , t ) W ( t ) ¯ c ( 1 , t + 1 ) . When we use these to combine (19) with (13) across all age classes, it is algebraically inevitable that (24a) Z ¯ ( t + 1 ) = ? a = 1 ? ? 1 ( c ( a , t ) S ¯ ( a , t ) W ¯ ( t ) )    [ Z ¯ ( a , t ) + G ¯ ( a , t ) ] + (24b) ? a = 1 ? ( c ( a , t ) R ¯ ( a , t ) W ¯ ( t ) )    [ Z ¯ ( a , t ) + D ¯ ( a , t ) ] + (24c) ? a = 1 ? ? 1 ( c ( a , t ) S ¯ ( a , t ) W ¯ ( t ) )    [ Cov  ( Z , S ) ( a , t ) S ¯ ( a , t ) + Cov ( S , G ) ( a , t ) S ¯ ( a , t ) ] (24d) ? a = 1 ? ( c ( a , t ) R ¯ ( a , t ) W ¯ ( t ) )    [ Cov  ( D , R ) ( a , t ) R ¯ ( a , t ) + Cov  ( Z , R ) ( a , t ) R ¯ ( a , t ) ] . To write the change in the mean trait value for the entire population, define the change in population structure, (25) ? c ( a , t ) = c ( a + 1 , t + 1 ) ? c ( a , t ) . Using this, (26) ? Z ¯ ( t ) = Z ¯ ( t + 1 ) ? Z ¯ ( t ) = ? a = 1 ? ? 1 [ ? c ( a , t ) ] Z ¯ ( a , t ) ? c ( ? , t ) Z ¯ ( ? , t ) (27) + ? a = 1 ? ? 1 ( c ( a , t ) W ¯ ( t ) )    [ Cov ( Z , S ) ( a , t ) (28) + SG ¯ ( a , t ) ] (29) + ? a = 1 ? ( c ( a , t ) W ¯ ( t ) )    [ R ¯ ( a , t ) Z ¯ ( a , t ) (30) + R ¯ ( a , t ) D ¯ ( a , t ) (31) +  cov ( D , R ) ( a , t ) (32) +  cov ( Z , R ) ( a , t ) ] . Because terms in the derivation can be written using our “+” notation (see “The Price equation” above) terms in the above formulation can be written as averages over just parents. This can be done in many ways, including, for example, (33) ? Z ¯ ( t ) = ? a = 1 ? ? 1 [ ? c ( a , t ) ] Z ¯ ( a , t ) ? c ( ? , t ) Z ¯ ( ? , t ) + ? a = 1 ? ? 1 ( c ( a , t ) S ¯ ( a , t ) W ¯ ( t ) )    [ Cov ( Z , S ) ( a , t ) S ¯ ( a , t ) + G ¯ + ( a , t ) S ¯ ( a , t ) ] (34) + ? a = 1 ? ? 1 ( c ( a , t ) R ¯ ( a , t ) W ¯ ( t ) ) [ Z ¯ ( a , t ) + cov ( Z , R ) ( a , t ) R ¯ ( a , t ) + D ¯ + ( a , t ) (35) + cov + ( D , R ) ( a , t ) R ¯ + ( a , t ) ] . Interpretation of these terms can be found in Table 2 .  Conditions for Equilibrium of the Mean Phenotype Equation (24) defines general conditions under which the mean trait value in a population is maintained over time (at an equilibrium value), or changes directionally in one time step. To explore these conditions, we examine several cases starting with the simplest. Equilibrium with no selection Suppose that fertility, survival and rates of growth/reversion are constant in time, the population’s demographic structure is stable, and there is no selection. At time t the mean trait value is (36) Z ¯ ( t ) = c ( 1 ) Z ¯ ( 1 ) + ? 1 ? ? 1 c ( a + 1 ) [ Z ¯ ( a ) + G ¯ ( a ) ] . Demographic stability means that the age structure and the growth rate W? do not change with t , that equation (22) becomes c ( a + 1 ) = c ( a ) S ¯ ( a ) W ¯ ,  for  a ? 1 , and that the fraction of newborns is c ( 1 ) = ? 1 ? c ( a ) R ¯ ( a ) W ¯ . The absence of selection means that the covariance terms in (24) are all zero. Using the two equations above, equation (24) shows that Z ¯ ( t + 1 ) = ? 1 ? ? 1 c ( a + 1 ) [ Z ¯ ( a ) + G ¯ ( a ) ] + ? a = 1 ? ( c ( a ) R ¯ ( a ) W ¯ )    [ Z ¯ ( a ) + D ¯ ( a ) ] . Compare this with (36) to see that the mean trait value stays constant if (37) Z ¯ ( a ) + D ¯ ( a ) = Z ¯ ( 1 ) . In words, this condition means that parents of age a have to produce offspring whose mean trait value is constant over time. Recalling equation (15) this means there can be no transmission bias, and the growth/reversion differential at every age is perfectly offset in the mean traits of offspring. Equilibrium with Directional Selection on Traits Fixed at Birth Now consider a trait like frailty ( Vaupel et al. 1979 ) that is fixed at birth and is positively correlated with survival rates at every age. In this case there is no growth/reversion, so D? ( a ) is just the transmission bias between parents age a and their offspring. To keep things simple, suppose that the demographic structure does not change between times t and t + 1, and that there is no selection via fertility. Then equation (24) shows that Z ¯ ( t + 1 ) = ? 1 ? ? 1 c ( a + 1 ) Z ¯ ( a ) + ? a = 1 ? ( c ( a ) R ¯ ( a ) W ¯ )    [ Z ¯ ( a ) + D ¯ ( a ) ] + ? a = 1 ? ? 1 c ( a + 1 ) Cov  ( Z , S ) ( a ) S ¯ ( a ) . Condition (37) is not sufficient to hold the mean trait value fixed: even if it applies, Z? ( t + 1) > Z? ( t ) because Cov ( Z , S ) ( a ) > 0 as a result of directional selection on the trait via survival. To maintain equilibrium requires a transmission bias that balances the selection gradient, (38) ? a = 1 ? ? 1 ( c ( a ) R ¯ ( a ) W ¯ )    [ Z ¯ ( a ) ? Z ¯ ( 1 ) + D ¯ ( a ) ] = ? ? a = 1 ? ? 1 c ( a + 1 ) Cov ( Z , S ) ( a ) S ¯ ( a ) . Here age structure and fertility at age a weight the transmission bias, and age structure weights the strength of directional selection. Transmission bias is also necessary for equilibrium in the mean of a trait fixed at birth that is positively correlated with fertility and survival. To get the equilibrium condition in that case, just add to the right hand side of (38) the selection on fertility involving Cov ( Z , R ) ( a ) > 0. In a detailed analysis of data on a natural population (next section) we consider a case in which a trait is positively correlated with both survival and fertility, and show that transmission bias is indeed the balancing factor maintaining mean trait value. Equilibrium with Survival-Fertility Trade-offs Traits such as birth weight or provisioning that are set at birth often positively influence early survival, but in many cases we expect a trade-off (genetic or physiological) between early survival and reproduction at those or later ages. In such cases, a trait that is positively selected via its effect on current survival will, because of the trade-off, be selected against when it negatively influences current or future reproduction. If transmission effects are negligible, a mean trait value Z? ( t ) can be maintained if survival selection, acting through a positive Cov( S ( a , t ) Z ( a , t )) at ages a = 1, 2 , …, A , is balanced by fertility selection, acting via a negative value of Cov( R ( a ?, t ) Z ( a ?, t )) at ages a ? ? a . An equilibrium in mean trait value in such cases does not require transmission bias. Assuming that (37) applies, so there is no transmission bias, and that demography is stable, the equilibrium condition with a trade-off becomes ? a = 1 A c ( a + 1 ) Cov  ( Z , S ) ( a ) S ¯ ( a ) = ? ? a = 1 ? ? 1 c ( a + 1 ) Cov  ( Z , R ) ( a ) S ¯ ( a ) . Equilibrium with Growth-mediated trade-offs A different kind of trade-off occurs when a trait fixed at birth is positively correlated with survival alone (or reproduction alone) at one age and negatively correlated with survival (respectively, reproduction) at a later age. such an effect may be mediated by a growth-mortality trade-off. An example of such a trait is otolith size at hatching (a measure of larval size and provisioning) in the marine fish Pomacentrus amboinensis ( Gagliano et al. 2007 ). In these fish, larvae with smaller otoliths have slow growth rates at early ages (a pelagic phase) and high growth rates at later ages (settlement into adult habitat and after). Selection favors slow growth in the early ages and fast growth at later ages. Assuming no transmission bias, demographic stability, and that selection acts only via growth, the condition for maintaining mean otolith size at equilibrium is ? a = 1 ? ? 1 c ( a + 1 ) Cov  ( S , G ) ( a ) S ¯ ( a ) = 0 . Equilibrium with Temporal Variation in Selection The equilibrium conditions above assume that age-specific selection (the covariances) are constant in time. In practice we can expect that both the strength and direction of selection can vary with environmental conditions. For example, a positive covariance between a trait like size and fertility in resource-rich years can be reversed in resource-poor years, when larger and more fertile individuals incur but cannot compensate for a high energetic cost of reproduction. Thus the annual shift in a trait mean, ? Z? ( t ) in (35) , can average to zero over a long period if selection differentials fluctuate over time. We now use the age-structured Price equation to decompose fluctuations in the mean of a phenotypic trait in a population of red deer ( Cervus elaphus )  Equilibrium with no selection Suppose that fertility, survival and rates of growth/reversion are constant in time, the population’s demographic structure is stable, and there is no selection. At time t the mean trait value is (36) Z ¯ ( t ) = c ( 1 ) Z ¯ ( 1 ) + ? 1 ? ? 1 c ( a + 1 ) [ Z ¯ ( a ) + G ¯ ( a ) ] . Demographic stability means that the age structure and the growth rate W? do not change with t , that equation (22) becomes c ( a + 1 ) = c ( a ) S ¯ ( a ) W ¯ ,  for  a ? 1 , and that the fraction of newborns is c ( 1 ) = ? 1 ? c ( a ) R ¯ ( a ) W ¯ . The absence of selection means that the covariance terms in (24) are all zero. Using the two equations above, equation (24) shows that Z ¯ ( t + 1 ) = ? 1 ? ? 1 c ( a + 1 ) [ Z ¯ ( a ) + G ¯ ( a ) ] + ? a = 1 ? ( c ( a ) R ¯ ( a ) W ¯ )    [ Z ¯ ( a ) + D ¯ ( a ) ] . Compare this with (36) to see that the mean trait value stays constant if (37) Z ¯ ( a ) + D ¯ ( a ) = Z ¯ ( 1 ) . In words, this condition means that parents of age a have to produce offspring whose mean trait value is constant over time. Recalling equation (15) this means there can be no transmission bias, and the growth/reversion differential at every age is perfectly offset in the mean traits of offspring.  Equilibrium with Directional Selection on Traits Fixed at Birth Now consider a trait like frailty ( Vaupel et al. 1979 ) that is fixed at birth and is positively correlated with survival rates at every age. In this case there is no growth/reversion, so D? ( a ) is just the transmission bias between parents age a and their offspring. To keep things simple, suppose that the demographic structure does not change between times t and t + 1, and that there is no selection via fertility. Then equation (24) shows that Z ¯ ( t + 1 ) = ? 1 ? ? 1 c ( a + 1 ) Z ¯ ( a ) + ? a = 1 ? ( c ( a ) R ¯ ( a ) W ¯ )    [ Z ¯ ( a ) + D ¯ ( a ) ] + ? a = 1 ? ? 1 c ( a + 1 ) Cov  ( Z , S ) ( a ) S ¯ ( a ) . Condition (37) is not sufficient to hold the mean trait value fixed: even if it applies, Z? ( t + 1) > Z? ( t ) because Cov ( Z , S ) ( a ) > 0 as a result of directional selection on the trait via survival. To maintain equilibrium requires a transmission bias that balances the selection gradient, (38) ? a = 1 ? ? 1 ( c ( a ) R ¯ ( a ) W ¯ )    [ Z ¯ ( a ) ? Z ¯ ( 1 ) + D ¯ ( a ) ] = ? ? a = 1 ? ? 1 c ( a + 1 ) Cov ( Z , S ) ( a ) S ¯ ( a ) . Here age structure and fertility at age a weight the transmission bias, and age structure weights the strength of directional selection. Transmission bias is also necessary for equilibrium in the mean of a trait fixed at birth that is positively correlated with fertility and survival. To get the equilibrium condition in that case, just add to the right hand side of (38) the selection on fertility involving Cov ( Z , R ) ( a ) > 0. In a detailed analysis of data on a natural population (next section) we consider a case in which a trait is positively correlated with both survival and fertility, and show that transmission bias is indeed the balancing factor maintaining mean trait value.  Equilibrium with Survival-Fertility Trade-offs Traits such as birth weight or provisioning that are set at birth often positively influence early survival, but in many cases we expect a trade-off (genetic or physiological) between early survival and reproduction at those or later ages. In such cases, a trait that is positively selected via its effect on current survival will, because of the trade-off, be selected against when it negatively influences current or future reproduction. If transmission effects are negligible, a mean trait value Z? ( t ) can be maintained if survival selection, acting through a positive Cov( S ( a , t ) Z ( a , t )) at ages a = 1, 2 , …, A , is balanced by fertility selection, acting via a negative value of Cov( R ( a ?, t ) Z ( a ?, t )) at ages a ? ? a . An equilibrium in mean trait value in such cases does not require transmission bias. Assuming that (37) applies, so there is no transmission bias, and that demography is stable, the equilibrium condition with a trade-off becomes ? a = 1 A c ( a + 1 ) Cov  ( Z , S ) ( a ) S ¯ ( a ) = ? ? a = 1 ? ? 1 c ( a + 1 ) Cov  ( Z , R ) ( a ) S ¯ ( a ) .  Equilibrium with Growth-mediated trade-offs A different kind of trade-off occurs when a trait fixed at birth is positively correlated with survival alone (or reproduction alone) at one age and negatively correlated with survival (respectively, reproduction) at a later age. such an effect may be mediated by a growth-mortality trade-off. An example of such a trait is otolith size at hatching (a measure of larval size and provisioning) in the marine fish Pomacentrus amboinensis ( Gagliano et al. 2007 ). In these fish, larvae with smaller otoliths have slow growth rates at early ages (a pelagic phase) and high growth rates at later ages (settlement into adult habitat and after). Selection favors slow growth in the early ages and fast growth at later ages. Assuming no transmission bias, demographic stability, and that selection acts only via growth, the condition for maintaining mean otolith size at equilibrium is ? a = 1 ? ? 1 c ( a + 1 ) Cov  ( S , G ) ( a ) S ¯ ( a ) = 0 .  Equilibrium with Temporal Variation in Selection The equilibrium conditions above assume that age-specific selection (the covariances) are constant in time. In practice we can expect that both the strength and direction of selection can vary with environmental conditions. For example, a positive covariance between a trait like size and fertility in resource-rich years can be reversed in resource-poor years, when larger and more fertile individuals incur but cannot compensate for a high energetic cost of reproduction. Thus the annual shift in a trait mean, ? Z? ( t ) in (35) , can average to zero over a long period if selection differentials fluctuate over time. We now use the age-structured Price equation to decompose fluctuations in the mean of a phenotypic trait in a population of red deer ( Cervus elaphus )  Application We use data collected from marked red deer living in the North Block of the island of Rum, Scotland ( Clutton-Brock et al. 1982 ). Over 95% of individuals seen in North Block censuses are marked ( Coulson et al. 1997 ). The rut takes place in September and October and births occur between May 15th and the end of June. Natural mortality predominantly occurs in late winter (February to April). We consider a post-breeding census date of July 1st. Individuals are caught within hours of birth and capture weight is recorded. Residual birth weight is defined as an individual’s residual from a regression line between capture weight (in kg) and capture date (in hours). At first capture individuals are uniquely marked with ear tags and/or collars. They are then followed throughout life and complete life histories are constructed. Age is known for all marked females; population estimates of the study area at the census date are close to error free; date of death is known to the day for most females, and to the month for those who were not found dead within days of death. Full methodological details have been published elsewhere and are not repeated here ( Clutton-Brock et al. 1982 ; Coulson et al. 2004 ). We use birth weight and life history data collected between July 1st 1974 and June 30th 2006.  Results The average number of females in our data set with known birth weights alive in the population at each census point is 145.3 (range 38 to 224). On average residual birth weight was estimated for 28 female calves each year (range 16 to 44), giving a total of 886 individual females with known birth weights. Over the course of the study there was no significant temporal trend in residual birth weights among female calves, although there were year to year fluctuations (variance across years in mean residual birth weight of female calves = 0.173; Figure 2a ). Mean residual birth weight of all living individuals fluctuated less than fluctuations in calf residual birth weight (temporal variance = 0.0087; Figure 2a ). Despite the lower variance, changes in mean residual birth weight from one year to next fluctuated between a decrease of 0.25kg and an increase of 0.19kg ( figure 2b ). Most of the change in ? Z? was attributable to fluctuations in calf birth weights ( figure 2c ), with an r 2 between ? Z? and residual calf birth weight of 0.74. Some of the terms in our derivation of the age-structured Price equation are zero in the case of residual birth weight in the red deer. Because birth weight is fixed throughout life all age-specific growth and reversion terms, SG ¯ ( a , t ) , are zero. Similarly, because maximum litter size is one the covariance terms cov( D , R )( a , t )) are also zero. All other terms are calculable. In Figure 3 we show the viability selection differentials cov( Z , S )( a , t ), the fertility selection differentials cov( Z , R )( a , t ), the difference between mother’s trait value and offspring value D? ( a , t ) and change due to demographic fluctuations ? c ( a , t ) Z? ( a , t ) ? c (?, t ) Z? (?, t ) summed across all age classes for each year. Viability selection differentials tend to be positive, with a mean of 42g per year. Fertility selection differentials are lower, with a mean of 10g. Combined with the term Z? ( t ) recruitment contributes on average +26 g to ? Z? . This means that on average approximately 70% of selection occurs through survival. As should be expected, fluctuations in the demographic structure on average explain only an increase of 2g, although there is considerable temporal variation in their contribution. Between them these terms predict an annual average increase of 70g a year; constituting over 1% of mean female calf birth weights. This might not sound much, but over the course of the study this would equate to over a 25% increase in birth weights. This increase is not achieved because female calf weights are, on average, less than the birth weights of their mothers: on average the term D? ( a , t ) constitutes an annual decrease in Z? of 71g. These results describe the sum of each term over age classes. We next examined how the selection differentials and mother-offspring difference terms varied with age. We do not report age-specific contributions from demographic change as this term is only easily interpreted at the level of the entire population. Much of the viability selection we observed occurs in the first two years of life ( Figure 4a ). A consequence of this is that the mean birth weight of individuals surviving to age a increased with a . Heavier born individuals tended to live longer, which meant that the mean residual birth weight of survivors within a cohort increased with age throughout life. Viability selection results in mothers’ residual birth weights being approximately 330g greater than the mean birth weight of their cohort at birth ( figure 4a ). Because we have not seen a change in mean birth weight over the course of the study, mothers must produce offspring that are lighter than they were – mothers must produce offspring with residual birth weights closer to the population mean birth weight of calves ( Z? (1)) rather than the mean birth weight of the selected group of mothers. The difference between offspring and maternal residual birth weight was greatest in young and old individuals ( Figure 4b ). Only those individuals in the prime of life were able to produce offspring that, on average, had the same birth weight that they did. There was little age-related variation in fertility selection (results not shown).  Results The average number of females in our data set with known birth weights alive in the population at each census point is 145.3 (range 38 to 224). On average residual birth weight was estimated for 28 female calves each year (range 16 to 44), giving a total of 886 individual females with known birth weights. Over the course of the study there was no significant temporal trend in residual birth weights among female calves, although there were year to year fluctuations (variance across years in mean residual birth weight of female calves = 0.173; Figure 2a ). Mean residual birth weight of all living individuals fluctuated less than fluctuations in calf residual birth weight (temporal variance = 0.0087; Figure 2a ). Despite the lower variance, changes in mean residual birth weight from one year to next fluctuated between a decrease of 0.25kg and an increase of 0.19kg ( figure 2b ). Most of the change in ? Z? was attributable to fluctuations in calf birth weights ( figure 2c ), with an r 2 between ? Z? and residual calf birth weight of 0.74. Some of the terms in our derivation of the age-structured Price equation are zero in the case of residual birth weight in the red deer. Because birth weight is fixed throughout life all age-specific growth and reversion terms, SG ¯ ( a , t ) , are zero. Similarly, because maximum litter size is one the covariance terms cov( D , R )( a , t )) are also zero. All other terms are calculable. In Figure 3 we show the viability selection differentials cov( Z , S )( a , t ), the fertility selection differentials cov( Z , R )( a , t ), the difference between mother’s trait value and offspring value D? ( a , t ) and change due to demographic fluctuations ? c ( a , t ) Z? ( a , t ) ? c (?, t ) Z? (?, t ) summed across all age classes for each year. Viability selection differentials tend to be positive, with a mean of 42g per year. Fertility selection differentials are lower, with a mean of 10g. Combined with the term Z? ( t ) recruitment contributes on average +26 g to ? Z? . This means that on average approximately 70% of selection occurs through survival. As should be expected, fluctuations in the demographic structure on average explain only an increase of 2g, although there is considerable temporal variation in their contribution. Between them these terms predict an annual average increase of 70g a year; constituting over 1% of mean female calf birth weights. This might not sound much, but over the course of the study this would equate to over a 25% increase in birth weights. This increase is not achieved because female calf weights are, on average, less than the birth weights of their mothers: on average the term D? ( a , t ) constitutes an annual decrease in Z? of 71g. These results describe the sum of each term over age classes. We next examined how the selection differentials and mother-offspring difference terms varied with age. We do not report age-specific contributions from demographic change as this term is only easily interpreted at the level of the entire population. Much of the viability selection we observed occurs in the first two years of life ( Figure 4a ). A consequence of this is that the mean birth weight of individuals surviving to age a increased with a . Heavier born individuals tended to live longer, which meant that the mean residual birth weight of survivors within a cohort increased with age throughout life. Viability selection results in mothers’ residual birth weights being approximately 330g greater than the mean birth weight of their cohort at birth ( figure 4a ). Because we have not seen a change in mean birth weight over the course of the study, mothers must produce offspring that are lighter than they were – mothers must produce offspring with residual birth weights closer to the population mean birth weight of calves ( Z? (1)) rather than the mean birth weight of the selected group of mothers. The difference between offspring and maternal residual birth weight was greatest in young and old individuals ( Figure 4b ). Only those individuals in the prime of life were able to produce offspring that, on average, had the same birth weight that they did. There was little age-related variation in fertility selection (results not shown).  Discussion There are a growing number of examples where population biologists report rapid change in the mean value of phenotypic traits in age-structured populations living in variable environments ( Wilson et al. 2007 ; Edeline et al. 2007 ; Grant and Grant 2006 ; Hairston et al. 2005 ; Reale et al. 2003 ; Law 2000 ; Coltman et al. 2003 ). Such time series are qualitatively similar to the time series of population counts or growth rates that population biologists frequently analyze ( Tuljapurkar 1990 ; Royama 1992 ; Turchin 2003 ). There is a large body of theory to decompose such time series into contributions from the fundamental biological processes of birth and death which may vary with age, stage and sex, as well as with environment ( Caswell 2001 ; Tuljapurkar 1990 ; Tuljapurkar et al. 2003 ; Lande et al. 2003 ). In contrast, until now, there has been no formal theory developed to decompose temporal fluctuations in the mean of a phenotypic trait in an age-structured population into the fundamental biological processes that generate them. The age-structured Price equation we derive contains four terms for each age: a viability selection differential on the trait, a fertility selection differential on the trait, a term describing the average rate of growth or reversion and a term describing the mean difference between offspring and their parents. Each of these terms is weighted by the contribution of age-specific survival and recruitment to population growth. These weighted terms are then summed before being combined with a term describing change in the mean of the trait caused solely by ageing. This biologically intuitive equation has, to our knowledge, not previously been derived, which is surprising as it provides a demography for phenotypic change. The equation extends the work of Price (1970) who developed an equation describing the change in the mean of a phenotypic trait over a time step as a function of individual fitness defined as a scalar. The Price equation is typically considered for species with non-overlapping generations where fitness is defined as reproductive success ( Frank 1997 ). However, if fitness is defined as an individual’s numerical contribution to the population over a time step then the derivation still holds. For example, consider a case where an individual reproduces but also survives. In this case an individual’s numerical contribution will be its reproductive success plus one (itself) ( Coulson et al. 2006 ). The same logic can easily be extended to cases where genetic contributions are considered. In our derivation of an age-structured Price equation we have decomposed individual fitness into its survival and recruitment components. This decomposition is illuminating as it provides novel insight into interpretation of the second term of the Price equation. Both Price’s original equation ( Price 1970 ) and our age-structured form describe differences in the means of trait distribution across populations. The viability selection differentials describe the differences in the trait means between survivors and all individuals within an age class ( Falconer 1960 ). Clearly, assuming some mortality, not all individuals survive; this means that the population of survivors within an age class is smaller than the population size of the age-class prior to selection. The second term involving survival is the growth and reversion term. This term describes how the mean of the trait changes among survivors between time t and t+1. This term can be calculated across all individuals within an age-class at age t regardless of whether they survive or not. Alternatively, as we demonstrate with our “+” notation, it can also be calculated across survivors only. The choice of notation will depend on how one views the change in trait distribution as occurring. If one considers a two step process, where individuals are selected to survive or die and then survivors change their trait value, then the “+” notation will be most appealing. Similar considerations apply to the recruitment terms. In the population of red deer we analyzed we found that viability selection changed the mean of the trait distribution as individual’s aged. Fertility selection was weaker. This result suggests that previously reported selection on birth weight using lifetime measures of fitness ( Clutton-Brock and Coulson 2002 ; Clutton-Brock et al. 1997 , 1987 ; Clutton-Brock and Albon 1982 ; Clutton-Brock et al. 1982 ; Kruuk et al. 1999 ) is generated primarily by viability selection and not fertility selection. In itself this result is not unexpected as Clutton-Brock (1988) reported a decomposition of variation in lifetime reproductive success across a range of vertebrates showing that longevity was typically the dominant component. However, our results demonstrate that a richer picture of selection and phenotypic change can be achieved by decomposing fitness into its constituent components. The viability selection we reported is countered by a substantial difference in the mean value of parental and offspring traits; this difference varies with age, being greatest at young and old ages. Parents tend to produce offspring that are more similar to the population mean than they are to themselves. The reasons for this are not clear, but could be a result of developmental, energetic or genetic constraints ( Wagner and Altenberg 1996 ; Moran 1992 ; Smith et al. 1985 ) which may, or may not, have additive genetic components. In the Breeder’s equation if selected parents produce offspring with trait values that are more similar to the population mean than they are to their own trait values then the heritability of the trait will be close to zero ( Falconer 1960 ). Our decomposition is consistent with previous research in this population, which reports heritabilities of birth weight that are much closer to zero than unity ( Kruuk et al. 2000 ; Coulson et al. 2003 ; Wilson et al. 2006 ). In the red deer study equilibrium of the trait mean is primarily maintained because the viability selection differential is countered by differences between offspring and parental trait values. In Price’s (1970) original equation this form of equilibrium can arise when the first term is positive and the second term is negative. In the age-structured Price equation we have derived explicit conditions describing other routes to equilibrium. These include selection operating in different directions, possibly mediated by a trade-off, via survival and fertility; selection operating via a covariance between survival and growth rates but in opposite directions at different ages; and the direction, and route, via which selection acts varying with the environment ( Lande 1982 ; van Tienderen 2000 ; Coulson et al. 2003 ). Coulson et al. (2003) demonstrated that for birth weight in this population all of these processes operate to prevent evolution of the trait mean. The framework we develop will enable researchers to examine the processes which lead to stasis in the mean of a trait value despite apparent positive selection, as well as changes in trait value in the apparent absence of selection. Our derivation of an age-structured Price equation provides a useful step in characterizing the dynamics of the mean of a phenotypic trait in an age-structured population living in a variable environment. However, there are clearly obvious areas for future research. First, because evolutionary ecologists are often interested in changes in the variance in a trait distribution ( Turelli and Barton 1994 ), as well as the mean, extending our derivations for higher moments of trait distributions is desirable. This work is already underway (extending the work of ( Rice 2004 ) in the non-age-structured case). Second, in order to generate dynamic equations, each term could be replaced by functions describing how the term is influenced by environmental variables. Such an approach has proved illuminating in understanding the temporal dynamics of population size and population growth and should prove insightful in identifying processes associated with phenotypic change ( Coulson et al. 2001 ). Finally, in order to use our equations to describe genetic change, our derivation would need to be linked to models describing the genotype-phenotype map. An obvious starting point would be the additive genetic model. Such work should allow unprecedented insights into evolutionary change of fitness-related phenotypic traits in age-structured population living in stochastic environments. In this paper we have developed a general equation to exactly describe changes in the mean of a phenotypic trait in a population over a time step, and have applied it to detailed data from a population of red deer. This work makes several important advances. First, we do not consider fitness as a scalar, but instead work with fitness components. Second, and a direct consequence of the first advance, is we can consider the contribution of specific demographic classes to observed phenotypic change. Third, by focusing on short time steps we are able to examine how the relative contributions of different demographic processes that generate change vary with time. Finally, we provide the first comprehensive description of the processes generating fluctuations in the mean of a fitness-related phenotypic trait in an age- structured population living in a stochastic environment.  Discussion There are a growing number of examples where population biologists report rapid change in the mean value of phenotypic traits in age-structured populations living in variable environments ( Wilson et al. 2007 ; Edeline et al. 2007 ; Grant and Grant 2006 ; Hairston et al. 2005 ; Reale et al. 2003 ; Law 2000 ; Coltman et al. 2003 ). Such time series are qualitatively similar to the time series of population counts or growth rates that population biologists frequently analyze ( Tuljapurkar 1990 ; Royama 1992 ; Turchin 2003 ). There is a large body of theory to decompose such time series into contributions from the fundamental biological processes of birth and death which may vary with age, stage and sex, as well as with environment ( Caswell 2001 ; Tuljapurkar 1990 ; Tuljapurkar et al. 2003 ; Lande et al. 2003 ). In contrast, until now, there has been no formal theory developed to decompose temporal fluctuations in the mean of a phenotypic trait in an age-structured population into the fundamental biological processes that generate them. The age-structured Price equation we derive contains four terms for each age: a viability selection differential on the trait, a fertility selection differential on the trait, a term describing the average rate of growth or reversion and a term describing the mean difference between offspring and their parents. Each of these terms is weighted by the contribution of age-specific survival and recruitment to population growth. These weighted terms are then summed before being combined with a term describing change in the mean of the trait caused solely by ageing. This biologically intuitive equation has, to our knowledge, not previously been derived, which is surprising as it provides a demography for phenotypic change. The equation extends the work of Price (1970) who developed an equation describing the change in the mean of a phenotypic trait over a time step as a function of individual fitness defined as a scalar. The Price equation is typically considered for species with non-overlapping generations where fitness is defined as reproductive success ( Frank 1997 ). However, if fitness is defined as an individual’s numerical contribution to the population over a time step then the derivation still holds. For example, consider a case where an individual reproduces but also survives. In this case an individual’s numerical contribution will be its reproductive success plus one (itself) ( Coulson et al. 2006 ). The same logic can easily be extended to cases where genetic contributions are considered. In our derivation of an age-structured Price equation we have decomposed individual fitness into its survival and recruitment components. This decomposition is illuminating as it provides novel insight into interpretation of the second term of the Price equation. Both Price’s original equation ( Price 1970 ) and our age-structured form describe differences in the means of trait distribution across populations. The viability selection differentials describe the differences in the trait means between survivors and all individuals within an age class ( Falconer 1960 ). Clearly, assuming some mortality, not all individuals survive; this means that the population of survivors within an age class is smaller than the population size of the age-class prior to selection. The second term involving survival is the growth and reversion term. This term describes how the mean of the trait changes among survivors between time t and t+1. This term can be calculated across all individuals within an age-class at age t regardless of whether they survive or not. Alternatively, as we demonstrate with our “+” notation, it can also be calculated across survivors only. The choice of notation will depend on how one views the change in trait distribution as occurring. If one considers a two step process, where individuals are selected to survive or die and then survivors change their trait value, then the “+” notation will be most appealing. Similar considerations apply to the recruitment terms. In the population of red deer we analyzed we found that viability selection changed the mean of the trait distribution as individual’s aged. Fertility selection was weaker. This result suggests that previously reported selection on birth weight using lifetime measures of fitness ( Clutton-Brock and Coulson 2002 ; Clutton-Brock et al. 1997 , 1987 ; Clutton-Brock and Albon 1982 ; Clutton-Brock et al. 1982 ; Kruuk et al. 1999 ) is generated primarily by viability selection and not fertility selection. In itself this result is not unexpected as Clutton-Brock (1988) reported a decomposition of variation in lifetime reproductive success across a range of vertebrates showing that longevity was typically the dominant component. However, our results demonstrate that a richer picture of selection and phenotypic change can be achieved by decomposing fitness into its constituent components. The viability selection we reported is countered by a substantial difference in the mean value of parental and offspring traits; this difference varies with age, being greatest at young and old ages. Parents tend to produce offspring that are more similar to the population mean than they are to themselves. The reasons for this are not clear, but could be a result of developmental, energetic or genetic constraints ( Wagner and Altenberg 1996 ; Moran 1992 ; Smith et al. 1985 ) which may, or may not, have additive genetic components. In the Breeder’s equation if selected parents produce offspring with trait values that are more similar to the population mean than they are to their own trait values then the heritability of the trait will be close to zero ( Falconer 1960 ). Our decomposition is consistent with previous research in this population, which reports heritabilities of birth weight that are much closer to zero than unity ( Kruuk et al. 2000 ; Coulson et al. 2003 ; Wilson et al. 2006 ). In the red deer study equilibrium of the trait mean is primarily maintained because the viability selection differential is countered by differences between offspring and parental trait values. In Price’s (1970) original equation this form of equilibrium can arise when the first term is positive and the second term is negative. In the age-structured Price equation we have derived explicit conditions describing other routes to equilibrium. These include selection operating in different directions, possibly mediated by a trade-off, via survival and fertility; selection operating via a covariance between survival and growth rates but in opposite directions at different ages; and the direction, and route, via which selection acts varying with the environment ( Lande 1982 ; van Tienderen 2000 ; Coulson et al. 2003 ). Coulson et al. (2003) demonstrated that for birth weight in this population all of these processes operate to prevent evolution of the trait mean. The framework we develop will enable researchers to examine the processes which lead to stasis in the mean of a trait value despite apparent positive selection, as well as changes in trait value in the apparent absence of selection. Our derivation of an age-structured Price equation provides a useful step in characterizing the dynamics of the mean of a phenotypic trait in an age-structured population living in a variable environment. However, there are clearly obvious areas for future research. First, because evolutionary ecologists are often interested in changes in the variance in a trait distribution ( Turelli and Barton 1994 ), as well as the mean, extending our derivations for higher moments of trait distributions is desirable. This work is already underway (extending the work of ( Rice 2004 ) in the non-age-structured case). Second, in order to generate dynamic equations, each term could be replaced by functions describing how the term is influenced by environmental variables. Such an approach has proved illuminating in understanding the temporal dynamics of population size and population growth and should prove insightful in identifying processes associated with phenotypic change ( Coulson et al. 2001 ). Finally, in order to use our equations to describe genetic change, our derivation would need to be linked to models describing the genotype-phenotype map. An obvious starting point would be the additive genetic model. Such work should allow unprecedented insights into evolutionary change of fitness-related phenotypic traits in age-structured population living in stochastic environments. In this paper we have developed a general equation to exactly describe changes in the mean of a phenotypic trait in a population over a time step, and have applied it to detailed data from a population of red deer. This work makes several important advances. First, we do not consider fitness as a scalar, but instead work with fitness components. Second, and a direct consequence of the first advance, is we can consider the contribution of specific demographic classes to observed phenotypic change. Third, by focusing on short time steps we are able to examine how the relative contributions of different demographic processes that generate change vary with time. Finally, we provide the first comprehensive description of the processes generating fluctuations in the mean of a fitness-related phenotypic trait in an age- structured population living in a stochastic environment. 